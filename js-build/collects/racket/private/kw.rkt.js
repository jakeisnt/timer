import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result479 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result479.getAt(0);var keyword_impersonator_p = let_result479.getAt(1);var keyword_impersonator_ref = let_result479.getAt(2);var keyword_procedure_impersonator_of = function(v975) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v975)!==false) {var if_res480 = keyword_impersonator_ref(v975)(v975);} else {var if_res480 = false;}return if_res480;};var let_result481 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result481.getAt(0);var mk_kw_proc = let_result481.getAt(1);var keyword_procedure_p = let_result481.getAt(2);var keyword_procedure_ref = let_result481.getAt(3);var keyword_procedure_set_bang_ = let_result481.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result482 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result482.getAt(0);var make_km = let_result482.getAt(1);var keyword_method_p = let_result482.getAt(2);var km_ref = let_result482.getAt(3);var km_set_bang_ = let_result482.getAt(4);var generate_arity_string = function(proc976) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result483 = procedure_keywords(proc976);var req977 = let_result483.getAt(0);var allowed978 = let_result483.getAt(1);var a979 = M0.procedure_arity(proc976);var keywords_desc980 = function(opt982, req983) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp489 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req983))!==false) {var if_res488 = M0.format($rjs_core.UString.make("an ~aargument"),opt982);} else {var if_res488 = M0.format($rjs_core.UString.make("~aarguments"),opt982);}if (M0.null_p(M0.cdr(req983))!==false) {var if_res487 = $rjs_core.UString.make("");} else {var if_res487 = $rjs_core.UString.make("s");}var tmp984 = M0.length(req983);if (M0.equal_p(tmp984,1)!==false) {var if_res486 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req983));} else {if (M0.equal_p(tmp984,2)!==false) {var if_res485 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req983),M0.cadr(req983));} else {var loop985 = function(req986) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req986))!==false) {var if_res484 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req986));} else {var if_res484 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req986),loop985(M0.cdr(req986)));}return if_res484;};var if_res485 = loop985(req983);}var if_res486 = if_res485;}return M0.format(temp489,if_res488,if_res487,if_res486);};var method_adjust981 = function(a987) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part988 = okm_p(proc976);if (or_part988!==false) {var if_res490 = or_part988;} else {var if_res490 = keyword_method_p(proc976);}if (if_res490!==false) {if (M0.zero_p(a987)!==false) {var if_res491 = 0;} else {var if_res491 = M0.sub1(a987);}var if_res492 = if_res491;} else {var if_res492 = a987;}return if_res492;};if (M0.number_p(a979)!==false) {var a989 = method_adjust981(a979);var if_res499 = M0.format($rjs_core.UString.make("~a"),a989);} else {if (M0.arity_at_least_p(a979)!==false) {var a990 = method_adjust981(M0.arity_at_least_value(a979));var if_res498 = M0.format($rjs_core.UString.make("at least ~a"),a990);} else {var if_res498 = $rjs_core.UString.make("a different number");}var if_res499 = if_res498;}if (M0.null_p(req977)!==false) {var if_res497 = $rjs_core.UString.make("");} else {var if_res497 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc980($rjs_core.UString.make(""),req977));}if (allowed978!==false) {var loop992 = function(req993, allowed994) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req993)!==false) {var if_res494 = allowed994;} else {if (M0.eq_p(M0.car(req993),M0.car(allowed994))!==false) {var if_res493 = loop992(M0.cdr(req993),M0.cdr(allowed994));} else {var if_res493 = M0.cons(M0.car(allowed994),loop992(req993,M0.cdr(allowed994)));}var if_res494 = if_res493;}return if_res494;};var others991 = loop992(req977,allowed978);if (M0.null_p(others991)!==false) {var if_res495 = $rjs_core.UString.make("");} else {var if_res495 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc980($rjs_core.UString.make("optional "),others991));}var if_res496 = if_res495;} else {var if_res496 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res499,if_res497,if_res496);};var let_result500 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result500.getAt(0);var make_optional_keyword_procedure = let_result500.getAt(1);var okp_p = let_result500.getAt(2);var okp_ref = let_result500.getAt(3);var okp_set_bang_ = let_result500.getAt(4);var let_result501 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result501.getAt(0);var make_optional_keyword_method = let_result501.getAt(1);var okm_p = let_result501.getAt(2);var okm_ref = let_result501.getAt(3);var okm_set_bang_ = let_result501.getAt(4);var let_result502 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result502.getAt(0);var named_keyword_procedure_p = let_result502.getAt(1);var keyword_procedure_name_plus_fail = let_result502.getAt(2);var let_result504 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v995, info_l996) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v995)!==false) {var if_res503 = M0.make_struct_field_accessor(M0.list_ref(info_l996,3),v995);} else {var if_res503 = false;}return if_res503;});var prop_procedure_accessor = let_result504.getAt(0);var procedure_accessor_p = let_result504.getAt(1);var procedure_accessor_ref = let_result504.getAt(2);var let_result505 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result505.getAt(0);var new_procedure_p = let_result505.getAt(1);var new_procedure_ref = let_result505.getAt(2);var let_result506 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v997) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v997,0);})));var struct_keyword_procedure_impersonator = let_result506.getAt(0);var make_kpp = let_result506.getAt(1);var keyword_procedure_impersonator_p = let_result506.getAt(2);var kpp_ref = let_result506.getAt(3);var kpp_set_bang_ = let_result506.getAt(4);var let_result507 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v998) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v998,0);})));var struct_keyword_method_impersonator = let_result507.getAt(0);var make_kmp = let_result507.getAt(1);var keyword_method_impersonator_p = let_result507.getAt(2);var kmp_ref = let_result507.getAt(3);var kmp_set_bang_ = let_result507.getAt(4);var let_result508 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v999) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v999,0);})));var struct_okpp = let_result508.getAt(0);var make_optional_keyword_procedure_impersonator = let_result508.getAt(1);var okpp_p = let_result508.getAt(2);var okpp_ref = let_result508.getAt(3);var okpp_set_bang_ = let_result508.getAt(4);var let_result509 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1000) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v1000,0);})));var struct_okmp = let_result509.getAt(0);var make_optional_keyword_method_impersonator = let_result509.getAt(1);var okmp_p = let_result509.getAt(2);var okmp_ref = let_result509.getAt(3);var okmp_set_bang_ = let_result509.getAt(4);var let_result510 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result510.getAt(0);var make_kp_by_ae = let_result510.getAt(1);var kp_by_ae_p = let_result510.getAt(2);var kp_by_ae_ref = let_result510.getAt(3);var kp_by_ae_set_bang_ = let_result510.getAt(4);var let_result511 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result511.getAt(0);var make_km_by_ae = let_result511.getAt(1);var km_by_ae_p = let_result511.getAt(2);var km_by_ae_ref = let_result511.getAt(3);var km_by_ae_set_bang_ = let_result511.getAt(4);var let_result512 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result512.getAt(0);var make_kpi_by_ae = let_result512.getAt(1);var kpi_by_ae_p = let_result512.getAt(2);var kpi_by_ae_ref = let_result512.getAt(3);var kpi_by_ae_set_bang_ = let_result512.getAt(4);var let_result513 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result513.getAt(0);var make_kmi_by_ae = let_result513.getAt(1);var kmi_by_ae_p = let_result513.getAt(2);var kmi_by_ae_ref = let_result513.getAt(3);var kmi_by_ae_set_bang_ = let_result513.getAt(4);var make_required = function(name1001, fail_proc1002, method_p1003, impersonator_p1004) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1010 = name1001;if (or_part1010!==false) {var if_res517 = or_part1010;} else {var if_res517 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p1004!==false) {if (method_p1003!==false) {var if_res514 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res514 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res516 = if_res514;} else {if (method_p1003!==false) {var if_res515 = struct_keyword_method_by_arity_error;} else {var if_res515 = struct_keyword_procedure_by_arity_error;}var if_res516 = if_res515;}var let_result518 = M0.make_struct_type(if_res517,if_res516,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name1001,fail_proc1002))),M0.current_inspector(),fail_proc1002);var s_1005 = let_result518.getAt(0);var mk1006 = let_result518.getAt(1);var __p1007 = let_result518.getAt(2);var __ref1008 = let_result518.getAt(3);var __set_bang_1009 = let_result518.getAt(4);return mk1006;};var cl519 = function(proc1011) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name1012 = M0.object_name(proc1011);var plain_proc1013 = $rjs_core.attachProcedureArity(function(...args1014522) {var args1014 = $rjs_core.Pair.listFromArray(args1014522);return M0.apply(proc1011,M0.rnull,M0.rnull,args1014);});if (M0.symbol_p(proc_name1012)!==false) {var if_res523 = M0.__rjs_quoted__.procedure_rename(plain_proc1013,proc_name1012);} else {var if_res523 = plain_proc1013;}return make_keyword_procedure(proc1011,if_res523);};var cl520 = function(proc1015, plain_proc1016) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1015)!==false) {var if_res524 = M0.procedure_arity_mask(proc1015);} else {var if_res524 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res524),proc1015,M0.rnull,false,plain_proc1016);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam521 = {'1':cl519,'2':cl520}[arguments.length];if (fixed_lam521!==undefined) {return fixed_lam521.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1017, kws1018, kw_vals1019, normal_args1020, ...normal_argss1021525) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1021 = $rjs_core.Pair.listFromArray(normal_argss1021525);var type_error1022 = function(what1023, which1024) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1023,which1024,proc1017,kws1018,kw_vals1019,normal_args1020,normal_argss1021);};if (M0.procedure_p(proc1017)!==false) {var if_res526 = M0.rvoid();} else {var if_res526 = type_error1022($rjs_core.UString.make("procedure?"),0);}if_res526;var loop1025 = function(ks1026) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1026)!==false) {var if_res533 = M0.rvoid();} else {var or_part1027 = M0.not(M0.pair_p(ks1026));if (or_part1027!==false) {var if_res527 = or_part1027;} else {var if_res527 = M0.not(M0.keyword_p(M0.car(ks1026)));}if (if_res527!==false) {var if_res532 = type_error1022($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1026))!==false) {var if_res531 = M0.rvoid();} else {var or_part1028 = M0.not(M0.pair_p(M0.cdr(ks1026)));if (or_part1028!==false) {var if_res528 = or_part1028;} else {var if_res528 = M0.not(M0.keyword_p(M0.cadr(ks1026)));}if (if_res528!==false) {var if_res530 = loop1025(M0.cdr(ks1026));} else {if (M0.keyword_lt__p(M0.car(ks1026),M0.cadr(ks1026))!==false) {var if_res529 = loop1025(M0.cdr(ks1026));} else {var if_res529 = type_error1022($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res530 = if_res529;}var if_res531 = if_res530;}var if_res532 = if_res531;}var if_res533 = if_res532;}return if_res533;};loop1025(kws1018);if (M0.list_p(kw_vals1019)!==false) {var if_res534 = M0.rvoid();} else {var if_res534 = type_error1022($rjs_core.UString.make("list?"),2);}if_res534;if (M0.__eq_(M0.length(kws1018),M0.length(kw_vals1019))!==false) {var if_res535 = M0.rvoid();} else {var if_res535 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1018),$rjs_core.UString.make("value list length"),M0.length(kw_vals1019),$rjs_core.UString.make("keyword list"),kws1018,$rjs_core.UString.make("value list"),kw_vals1019);}if_res535;var loop1030 = function(normal_argss1031, pos1032) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1031))!==false) {var l1033 = M0.car(normal_argss1031);if (M0.list_p(l1033)!==false) {var if_res536 = l1033;} else {var if_res536 = type_error1022($rjs_core.UString.make("list?"),pos1032);}var if_res537 = if_res536;} else {var if_res537 = M0.cons(M0.car(normal_argss1031),loop1030(M0.cdr(normal_argss1031),M0.add1(pos1032)));}return if_res537;};var normal_args1029 = loop1030(M0.cons(normal_args1020,normal_argss1021),3);if (M0.null_p(kws1018)!==false) {var if_res538 = M0.apply(proc1017,normal_args1029);} else {var if_res538 = M0.apply(keyword_procedure_extract_by_method(kws1018,2+M0.length(normal_args1029),proc1017,0),kws1018,kw_vals1019,normal_args1029);}return if_res538;});var procedure_keywords = function(p1034) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1034)!==false) {var if_res543 = M0.values(keyword_procedure_required(p1034),keyword_procedure_allowed(p1034));} else {if (M0.procedure_p(p1034)!==false) {if (new_procedure_p(p1034)!==false) {var v1035 = new_procedure_ref(p1034);if (M0.procedure_p(v1035)!==false) {var if_res540 = procedure_keywords(v1035);} else {var a1036 = procedure_accessor_ref(p1034);if (a1036!==false) {var if_res539 = procedure_keywords(a1036(p1034));} else {var if_res539 = M0.values(M0.rnull,M0.rnull);}var if_res540 = if_res539;}var if_res541 = if_res540;} else {var if_res541 = M0.values(M0.rnull,M0.rnull);}var if_res542 = if_res541;} else {var if_res542 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1034);}var if_res543 = if_res542;}return if_res543;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1037, ...args1038544) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1038 = $rjs_core.Pair.listFromArray(args1038544);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1037,0),M0.rnull,M0.rnull,args1038);});var check_kw_args = function(p1039, kws1040) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1041 = function(kws1042, required1043, allowed1044) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1042)!==false) {if (M0.null_p(required1043)!==false) {var if_res545 = M0.values(false,false);} else {var if_res545 = M0.values(M0.car(required1043),false);}var if_res554 = if_res545;} else {if (M0.pair_p(required1043)!==false) {var if_res546 = M0.eq_p(M0.car(required1043),M0.car(kws1042));} else {var if_res546 = false;}if (if_res546!==false) {var temp549 = M0.cdr(kws1042);var temp548 = M0.cdr(required1043);if (allowed1044!==false) {var if_res547 = M0.cdr(allowed1044);} else {var if_res547 = false;}var if_res553 = loop1041(temp549,temp548,if_res547);} else {if (M0.not(allowed1044)!==false) {var if_res552 = loop1041(M0.cdr(kws1042),required1043,false);} else {if (M0.pair_p(allowed1044)!==false) {if (M0.eq_p(M0.car(allowed1044),M0.car(kws1042))!==false) {var if_res550 = loop1041(M0.cdr(kws1042),required1043,M0.cdr(allowed1044));} else {var if_res550 = loop1041(kws1042,required1043,M0.cdr(allowed1044));}var if_res551 = if_res550;} else {var if_res551 = M0.values(false,M0.car(kws1042));}var if_res552 = if_res551;}var if_res553 = if_res552;}var if_res554 = if_res553;}return if_res554;};return loop1041(kws1040,keyword_procedure_required(p1039),keyword_procedure_allowed(p1039));};var make_keyword_checker = function(req_kws1045, allowed_kws1046, arity_mask1047) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1046)!==false) {if (M0.null_p(req_kws1045)!==false) {var if_res557 = function(kws1048, a1049) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res555 = M0.bitwise_bit_set_p(arity_mask1047,a1049);} else {var if_res555 = false;}return if_res555;};} else {var if_res557 = function(kws1050, a1051) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1045,kws1050)!==false) {var if_res556 = M0.bitwise_bit_set_p(arity_mask1047,a1051);} else {var if_res556 = false;}return if_res556;};}var if_res570 = if_res557;} else {if (M0.null_p(allowed_kws1046)!==false) {var if_res569 = function(kws1052, a1053) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1052)!==false) {var if_res558 = M0.bitwise_bit_set_p(arity_mask1047,a1053);} else {var if_res558 = false;}return if_res558;};} else {if (M0.null_p(req_kws1045)!==false) {var if_res568 = function(kws1054, a1055) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1054,allowed_kws1046)!==false) {var if_res559 = M0.bitwise_bit_set_p(arity_mask1047,a1055);} else {var if_res559 = false;}return if_res559;};} else {if (M0.list_p(req_kws1045)!==false) {if (M0.list_p(allowed_kws1046)!==false) {var if_res560 = M0.eq_p(M0.length(req_kws1045),M0.length(allowed_kws1046));} else {var if_res560 = false;}var if_res561 = if_res560;} else {var if_res561 = false;}if (if_res561!==false) {var if_res567 = function(kws1056, a1057) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1058 = function(kws1059, req_kws1060) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1060)!==false) {var if_res564 = M0.null_p(kws1059);} else {if (M0.null_p(kws1059)!==false) {var if_res563 = false;} else {if (M0.eq_p(M0.car(kws1059),M0.car(req_kws1060))!==false) {var if_res562 = loop1058(M0.cdr(kws1059),M0.cdr(req_kws1060));} else {var if_res562 = false;}var if_res563 = if_res562;}var if_res564 = if_res563;}return if_res564;};if (loop1058(kws1056,req_kws1045)!==false) {var if_res565 = M0.bitwise_bit_set_p(arity_mask1047,a1057);} else {var if_res565 = false;}return if_res565;};} else {var if_res567 = function(kws1061, a1062) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1045,kws1061,allowed_kws1046)!==false) {var if_res566 = M0.bitwise_bit_set_p(arity_mask1047,a1062);} else {var if_res566 = false;}return if_res566;};}var if_res568 = if_res567;}var if_res569 = if_res568;}var if_res570 = if_res569;}return if_res570;};var subset_p = function(l11063, l21064) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11063)!==false) {var if_res573 = true;} else {if (M0.null_p(l21064)!==false) {var if_res572 = false;} else {if (M0.eq_p(M0.car(l11063),M0.car(l21064))!==false) {var if_res571 = subset_p(M0.cdr(l11063),M0.cdr(l21064));} else {var if_res571 = subset_p(l11063,M0.cdr(l21064));}var if_res572 = if_res571;}var if_res573 = if_res572;}return if_res573;};var subsets_p = function(l11065, l21066, l31067) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11065)!==false) {var if_res578 = subset_p(l21066,l31067);} else {if (M0.null_p(l21066)!==false) {var if_res577 = false;} else {if (M0.null_p(l31067)!==false) {var if_res576 = false;} else {var v21068 = M0.car(l21066);if (M0.eq_p(M0.car(l11065),v21068)!==false) {var if_res575 = subsets_p(M0.cdr(l11065),M0.cdr(l21066),M0.cdr(l31067));} else {if (M0.eq_p(v21068,M0.car(l31067))!==false) {var if_res574 = subsets_p(l11065,M0.cdr(l21066),M0.cdr(l31067));} else {var if_res574 = subsets_p(l11065,l21066,M0.cdr(l31067));}var if_res575 = if_res574;}var if_res576 = if_res575;}var if_res577 = if_res576;}var if_res578 = if_res577;}return if_res578;};var keyword_procedure_extract_by_method = function(kws1069, n1070, p1071, method_n1072) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1071)!==false) {var if_res579 = keyword_procedure_checker(p1071)(kws1069,n1070);} else {var if_res579 = false;}if (if_res579!==false) {var if_res609 = keyword_procedure_proc(p1071);} else {if (M0.not(keyword_procedure_p(p1071))!==false) {if (M0.procedure_p(p1071)!==false) {if (new_procedure_p(p1071)!==false) {var a1075 = procedure_accessor_ref(p1071);if (a1075!==false) {var if_res580 = a1075(p1071);} else {var if_res580 = false;}var if_res581 = if_res580;} else {var if_res581 = false;}var or_part1074 = if_res581;if (or_part1074!==false) {var if_res584 = or_part1074;} else {var or_part1076 = M0.procedure_extract_target(p1071);if (or_part1076!==false) {var if_res583 = or_part1076;} else {if (new_procedure_p(p1071)!==false) {var if_res582 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res582 = false;}var if_res583 = if_res582;}var if_res584 = if_res583;}var if_res585 = if_res584;} else {var if_res585 = false;}var if_res586 = if_res585;} else {var if_res586 = false;}var p21073 = if_res586;if (p21073!==false) {if (M0.eq_p(p21073,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31077 = keyword_procedure_extract_by_method(kws1069,M0.add1(n1070),new_procedure_ref(p1071),M0.add1(method_n1072));var if_res588 = $rjs_core.attachProcedureArity(function(kws1078, kw_args1079, ...args1080587) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1080 = $rjs_core.Pair.listFromArray(args1080587);return M0.apply(p31077,kws1078,kw_args1079,M0.cons(p1071,args1080));});} else {var if_res588 = keyword_procedure_extract_by_method(kws1069,n1070,p21073,method_n1072);}var if_res608 = if_res588;} else {var if_res608 = $rjs_core.attachProcedureArity(function(kws1081, kw_args1082, ...args1083589) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1083 = $rjs_core.Pair.listFromArray(args1083589);if (keyword_procedure_p(p1071)!==false) {var if_res590 = check_kw_args(p1071,kws1081);} else {var if_res590 = M0.values(false,M0.car(kws1081));}var let_result591 = if_res590;var missing_kw1084 = let_result591.getAt(0);var extra_kw1085 = let_result591.getAt(1);var or_part1090 = keyword_method_p(p1071);if (or_part1090!==false) {var if_res592 = or_part1090;} else {var if_res592 = okm_p(p1071);}if (if_res592!==false) {var if_res593 = 1;} else {var if_res593 = 0;}var method_n1089 = method_n1072+if_res593;if (M0.__gt__eq_(n1070,method_n1089)!==false) {var if_res594 = n1070-method_n1089;} else {var if_res594 = n1070;}var n1086 = if_res594;if (M0.null_p(args1083)!==false) {var if_res595 = M0.null_p(kws1081);} else {var if_res595 = false;}if (if_res595!==false) {var if_res596 = $rjs_core.UString.make("");} else {var if_res596 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1091) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1091);},args1083),M0.map(function(kw1092, kw_arg1093) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1092,kw_arg1093);},kws1081,kw_args1082)));}var args_str1087 = if_res596;var proc_name1088 = function(p1094) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1094)!==false) {var if_res597 = M0.car(keyword_procedure_name_plus_fail(p1094));} else {var if_res597 = false;}var or_part1095 = if_res597;if (or_part1095!==false) {var if_res599 = or_part1095;} else {var or_part1096 = M0.object_name(p1094);if (or_part1096!==false) {var if_res598 = or_part1096;} else {var if_res598 = p1094;}var if_res599 = if_res598;}return if_res599;};var or_part1097 = extra_kw1085;if (or_part1097!==false) {var if_res606 = or_part1097;} else {var if_res606 = missing_kw1084;}if (if_res606!==false) {var if_res607 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res607 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1085!==false) {if (keyword_procedure_p(p1071)!==false) {var if_res601 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1088(p1071),extra_kw1085,args_str1087);} else {if (M0.procedure_p(p1071)!==false) {var if_res600 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1088(p1071),args_str1087);} else {var if_res600 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1071,args_str1087);}var if_res601 = if_res600;}var if_res605 = if_res601;} else {if (missing_kw1084!==false) {var if_res604 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1088(p1071),missing_kw1084,args_str1087);} else {var temp603 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1086-2)!==false) {var if_res602 = $rjs_core.UString.make("");} else {var if_res602 = $rjs_core.UString.make("s");}var if_res604 = M0.format(temp603,n1086-2,if_res602,proc_name1088(p1071),args_str1087);}var if_res605 = if_res604;}return M0.raise(if_res607(if_res605,M0.current_continuation_marks()));});}var if_res609 = if_res608;}return if_res609;};var keyword_procedure_extract = function(p1098, kws1099, n1100) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1099,n1100,p1098,0);};var cl610 = function(proc1101, arity1102, req_kw1103, allowed_kw1104, name1105) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1101,arity1102,false,name1105,req_kw1103,allowed_kw1104);};var cl611 = function(proc1106, arity1107, req_kw1108, allowed_kw1109) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1106,arity1107,false,false,req_kw1108,allowed_kw1109);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam612 = {'5':cl610,'4':cl611}[arguments.length];if (fixed_lam612!==undefined) {return fixed_lam612.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl613 = function(proc1110, mask1111, req_kw1112, allowed_kw1113, name1114) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1110,false,mask1111,name1114,req_kw1112,allowed_kw1113);};var cl614 = function(proc1115, mask1116, req_kw1117, allowed_kw1118) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1115,false,mask1116,false,req_kw1117,allowed_kw1118);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam615 = {'5':cl613,'4':cl614}[arguments.length];if (fixed_lam615!==undefined) {return fixed_lam615.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1119, proc1120, arity1121, mask1122, name1123, req_kw1124, allowed_kw1125) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1120)!==false) {var if_res616 = okp_ref(proc1120,0);} else {var if_res616 = proc1120;}var p1127 = if_res616;if (arity1121!==false) {var if_res617 = M0.__rjs_quoted__.procedure_reduce_arity(p1127,arity1121);} else {var if_res617 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1127,mask1122,name1123);}var plain_proc1126 = if_res617;var sorted_p1128 = function(kws1129) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1130 = function(kws1131) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1131)!==false) {var if_res620 = true;} else {if (M0.null_p(M0.cdr(kws1131))!==false) {var if_res619 = true;} else {if (M0.keyword_lt__p(M0.car(kws1131),M0.cadr(kws1131))!==false) {var if_res618 = loop1130(M0.cdr(kws1131));} else {var if_res618 = false;}var if_res619 = if_res618;}var if_res620 = if_res619;}return if_res620;};return loop1130(kws1129);};if (M0.list_p(req_kw1124)!==false) {if (M0.andmap(M0.keyword_p,req_kw1124)!==false) {var if_res621 = sorted_p1128(req_kw1124);} else {var if_res621 = false;}var if_res622 = if_res621;} else {var if_res622 = false;}if (if_res622!==false) {var if_res625 = M0.rvoid();} else {var temp624 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1132 = arity1121;if (or_part1132!==false) {var if_res623 = or_part1132;} else {var if_res623 = mask1122;}var if_res625 = M0.raise_argument_error(who1119,temp624,2,proc1120,if_res623,req_kw1124,allowed_kw1125);}if_res625;if (allowed_kw1125!==false) {if (M0.list_p(allowed_kw1125)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1125)!==false) {var if_res626 = sorted_p1128(allowed_kw1125);} else {var if_res626 = false;}var if_res627 = if_res626;} else {var if_res627 = false;}if (if_res627!==false) {var if_res630 = M0.rvoid();} else {var temp629 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1133 = arity1121;if (or_part1133!==false) {var if_res628 = or_part1133;} else {var if_res628 = mask1122;}var if_res630 = M0.raise_argument_error(who1119,temp629,3,proc1120,if_res628,req_kw1124,allowed_kw1125);}if_res630;if (subset_p(req_kw1124,allowed_kw1125)!==false) {var if_res631 = M0.rvoid();} else {var if_res631 = M0.raise_arguments_error(who1119,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1125,$rjs_core.UString.make("required keywords"),req_kw1124);}var if_res632 = if_res631;} else {var if_res632 = M0.rvoid();}if_res632;var let_result633 = procedure_keywords(proc1120);var old_req1134 = let_result633.getAt(0);var old_allowed1135 = let_result633.getAt(1);if (subset_p(old_req1134,req_kw1124)!==false) {var if_res634 = M0.rvoid();} else {var if_res634 = M0.raise_arguments_error(who1119,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1134,$rjs_core.UString.make("requested required keywords"),req_kw1124);}if_res634;if (old_allowed1135!==false) {if (subset_p(req_kw1124,old_allowed1135)!==false) {var if_res635 = M0.rvoid();} else {var if_res635 = M0.raise_arguments_error(who1119,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1135,$rjs_core.UString.make("requested required keywords"),req_kw1124);}if_res635;var or_part1136 = M0.not(allowed_kw1125);if (or_part1136!==false) {var if_res636 = or_part1136;} else {var if_res636 = subset_p(allowed_kw1125,old_allowed1135);}if (if_res636!==false) {var if_res637 = M0.rvoid();} else {var if_res637 = M0.raise_arguments_error(who1119,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1135,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1125);}var if_res638 = if_res637;} else {var if_res638 = M0.rvoid();}if_res638;if (M0.null_p(allowed_kw1125)!==false) {var if_res646 = plain_proc1126;} else {var or_part1138 = mask1122;if (or_part1138!==false) {var if_res639 = or_part1138;} else {var if_res639 = arity__gt_mask(arity1121);}var mask1137 = if_res639;var new_mask1139 = M0.arithmetic_shift(mask1137,2);var kw_checker1140 = make_keyword_checker(req_kw1124,allowed_kw1125,new_mask1139);var proc1141 = normalize_proc(proc1120);var new_kw_proc1142 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1141),new_mask1139);if (M0.null_p(req_kw1124)!==false) {if (okm_p(proc1141)!==false) {var if_res640 = make_optional_keyword_method;} else {var if_res640 = make_optional_keyword_procedure;}var if_res645 = if_res640(kw_checker1140,new_kw_proc1142,req_kw1124,allowed_kw1125,plain_proc1126);} else {if (named_keyword_procedure_p(proc1141)!==false) {var if_res643 = M0.car(keyword_procedure_name_plus_fail(proc1141));} else {var if_res643 = false;}var or_part1143 = if_res643;if (or_part1143!==false) {var if_res644 = or_part1143;} else {var if_res644 = M0.object_name(proc1141);}var temp642 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1137,1));var or_part1144 = okm_p(proc1141);if (or_part1144!==false) {var if_res641 = or_part1144;} else {var if_res641 = keyword_method_p(proc1141);}var if_res645 = make_required(if_res644,temp642,if_res641,false)(kw_checker1140,new_kw_proc1142,req_kw1124,allowed_kw1125);}var if_res646 = if_res645;}return if_res646;};var arity__gt_mask = function(a1145) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1145)!==false) {var if_res652 = M0.arithmetic_shift(1,a1145);} else {if (M0.arity_at_least_p(a1145)!==false) {var if_res651 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1145))));} else {if (M0.list_p(a1145)!==false) {var loop1146 = function(mask1147, l1148) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1148)!==false) {var if_res649 = mask1147;} else {var a1149 = M0.car(l1148);var or_part1150 = M0.exact_nonnegative_integer_p(a1149);if (or_part1150!==false) {var if_res647 = or_part1150;} else {var if_res647 = M0.arity_at_least_p(a1149);}if (if_res647!==false) {var if_res648 = loop1146(M0.bitwise_ior(mask1147,arity__gt_mask(a1149)),M0.cdr(l1148));} else {var if_res648 = false;}var if_res649 = if_res648;}return if_res649;};var if_res650 = loop1146(0,a1145);} else {var if_res650 = false;}var if_res651 = if_res650;}var if_res652 = if_res651;}return if_res652;};var cl653 = function(proc1152, arity1153, name1154) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1152)!==false) {var let_result656 = procedure_keywords(proc1152);var req1155 = let_result656.getAt(0);var allows1156 = let_result656.getAt(1);if (M0.pair_p(req1155)!==false) {var if_res657 = M0.not(M0.null_p(arity1153));} else {var if_res657 = false;}var if_res658 = if_res657;} else {var if_res658 = false;}if (if_res658!==false) {var if_res660 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1152);} else {if (okm_p(proc1152)!==false) {var if_res659 = M0.__rjs_quoted__.procedure__gt_method(proc1152);} else {var if_res659 = proc1152;}var if_res660 = M0.__rjs_quoted__.procedure_reduce_arity(if_res659,arity1153,name1154);}return if_res660;};var cl654 = function(proc1157, arity1158) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1157,arity1158,false);};var procedure_reduce_arity1151 = $rjs_core.attachProcedureArity(function() {var fixed_lam655 = {'3':cl653,'2':cl654}[arguments.length];if (fixed_lam655!==undefined) {return fixed_lam655.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1151;var cl661 = function(proc1160, mask1161, name1162) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1160)!==false) {var let_result664 = procedure_keywords(proc1160);var req1163 = let_result664.getAt(0);var allows1164 = let_result664.getAt(1);if (M0.pair_p(req1163)!==false) {var if_res665 = M0.not(M0.eqv_p(mask1161,0));} else {var if_res665 = false;}var if_res666 = if_res665;} else {var if_res666 = false;}if (if_res666!==false) {var if_res668 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1160);} else {if (okm_p(proc1160)!==false) {var if_res667 = M0.__rjs_quoted__.procedure__gt_method(proc1160);} else {var if_res667 = proc1160;}var if_res668 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res667,mask1161,name1162);}return if_res668;};var cl662 = function(proc1165, mask1166) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1165,mask1166,false);};var procedure_reduce_arity1159 = $rjs_core.attachProcedureArity(function() {var fixed_lam663 = {'3':cl661,'2':cl662}[arguments.length];if (fixed_lam663!==undefined) {return fixed_lam663.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1159;var procedure__gt_method1167 = function(proc1168) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1169 = normalize_proc(proc1168);if (keyword_procedure_p(proc1169)!==false) {if (okm_p(proc1169)!==false) {var if_res671 = proc1169;} else {if (keyword_method_p(proc1169)!==false) {var if_res670 = proc1169;} else {if (okp_p(proc1169)!==false) {var if_res669 = make_optional_keyword_method(keyword_procedure_checker(proc1169),keyword_procedure_proc(proc1169),keyword_procedure_required(proc1169),keyword_procedure_allowed(proc1169),okp_ref(proc1169,0));} else {var name_plus_fail1170 = keyword_procedure_name_plus_fail(proc1169);var mk1171 = make_required(M0.car(name_plus_fail1170),M0.cdr(name_plus_fail1170),true,false);var if_res669 = mk1171(keyword_procedure_checker(proc1169),keyword_procedure_proc(proc1169),keyword_procedure_required(proc1169),keyword_procedure_allowed(proc1169));}var if_res670 = if_res669;}var if_res671 = if_res670;}var if_res672 = if_res671;} else {var if_res672 = M0.__rjs_quoted__.procedure__gt_method(proc1169);}return if_res672;};var new_procedure__gt_method = procedure__gt_method1167;var procedure_rename1172 = function(proc1173, name1174) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1173)!==false) {var if_res673 = M0.symbol_p(name1174);} else {var if_res673 = false;}if (M0.not(if_res673)!==false) {var if_res676 = M0.__rjs_quoted__.procedure_rename(proc1173,name1174);} else {if (okp_p(proc1173)!==false) {if (okm_p(proc1173)!==false) {var if_res674 = make_optional_keyword_method;} else {var if_res674 = make_optional_keyword_procedure;}var if_res675 = if_res674(keyword_procedure_checker(proc1173),keyword_procedure_proc(proc1173),keyword_procedure_required(proc1173),keyword_procedure_allowed(proc1173),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1173,0),name1174));} else {var name_plus_fail1175 = keyword_procedure_name_plus_fail(proc1173);var mk1176 = make_required(name1174,M0.cdr(name_plus_fail1175),keyword_method_p(proc1173),false);var if_res675 = mk1176(keyword_procedure_checker(proc1173),keyword_procedure_proc(proc1173),keyword_procedure_required(proc1173),keyword_procedure_allowed(proc1173));}var if_res676 = if_res675;}return if_res676;};var new_procedure_rename = procedure_rename1172;var chaperone_procedure1177 = $rjs_core.attachProcedureArity(function(proc1178, wrap_proc1179, ...props1180677) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1180 = $rjs_core.Pair.listFromArray(props1180677);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1178,wrap_proc1179,props1180);});var new_chaperone_procedure = chaperone_procedure1177;var unsafe_chaperone_procedure1181 = $rjs_core.attachProcedureArity(function(proc1182, wrap_proc1183, ...props1184678) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1184 = $rjs_core.Pair.listFromArray(props1184678);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1182,wrap_proc1183,props1184);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1181;var impersonate_procedure1185 = $rjs_core.attachProcedureArity(function(proc1186, wrap_proc1187, ...props1188679) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1188 = $rjs_core.Pair.listFromArray(props1188679);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1186,wrap_proc1187,props1188);});var new_impersonate_procedure = impersonate_procedure1185;var unsafe_impersonate_procedure1189 = $rjs_core.attachProcedureArity(function(proc1190, wrap_proc1191, ...props1192680) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1192 = $rjs_core.Pair.listFromArray(props1192680);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1190,wrap_proc1191,props1192);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1189;var chaperone_procedure_times_1193 = $rjs_core.attachProcedureArity(function(proc1194, wrap_proc1195, ...props1196681) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1196 = $rjs_core.Pair.listFromArray(props1196681);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1194,wrap_proc1195,props1196);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1193;var impersonate_procedure_times_1197 = $rjs_core.attachProcedureArity(function(proc1198, wrap_proc1199, ...props1200682) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1200 = $rjs_core.Pair.listFromArray(props1200682);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1198,wrap_proc1199,props1200);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1197;var do_chaperone_procedure = function(is_impersonator_p1201, self_arg_p1202, chaperone_procedure1203, name1204, proc1205, wrap_proc1206, props1207) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1208 = normalize_proc(proc1205);var n_wrap_proc1209 = normalize_proc(wrap_proc1206);var or_part1210 = M0.not(keyword_procedure_p(n_proc1208));if (or_part1210!==false) {var if_res684 = or_part1210;} else {var or_part1211 = M0.not(M0.procedure_p(wrap_proc1206));if (or_part1211!==false) {var if_res683 = or_part1211;} else {var if_res683 = bad_props_p(props1207);}var if_res684 = if_res683;}if (if_res684!==false) {var if_res751 = M0.apply(chaperone_procedure1203,proc1205,wrap_proc1206,props1207);} else {chaperone_arity_match_checking(self_arg_p1202,name1204,proc1205,wrap_proc1206,props1207);var loop1213 = function(props1214) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1214)!==false) {var if_res686 = false;} else {if (M0.eq_p(M0.car(props1214),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res685 = M0.cadr(props1214);} else {var if_res685 = loop1213(M0.cddr(props1214));}var if_res686 = if_res685;}return if_res686;};var mark_prop1212 = loop1213(props1207);var chaperone_procedure_by_add_mark1215 = function(proc1216, wrap_proc1217) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1212!==false) {var if_res687 = chaperone_procedure1203(proc1216,wrap_proc1217,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1212);} else {var if_res687 = chaperone_procedure1203(proc1216,wrap_proc1217);}return if_res687;};var p1219 = keyword_procedure_proc(n_wrap_proc1209);if (self_arg_p1202!==false) {var cl688 = $rjs_core.attachProcedureArity(function(self_proc1220, kws1221, args1222, ...rest1223693) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1223 = $rjs_core.Pair.listFromArray(rest1223693);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1219,kws1221,args1222,self_proc1220,rest1223);},$rjs_core.attachProcedureArity(function(...results1224694) {var results1224 = $rjs_core.Pair.listFromArray(results1224694);var len1225 = M0.length(results1224);var alen1226 = M0.length(rest1223);if (M0.__lt_(len1225,alen1226+1)!==false) {var if_res695 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1226+1,$rjs_core.UString.make("received number of results"),len1225,$rjs_core.UString.make("wrapper procedure"),wrap_proc1206);} else {var if_res695 = M0.rvoid();}if_res695;var num_extra1227 = len1225-(alen1226+1);var new_args1228 = M0.list_ref(results1224,num_extra1227);if (M0.list_p(new_args1228)!==false) {var if_res696 = M0.__eq_(M0.length(new_args1228),M0.length(args1222));} else {var if_res696 = false;}if (if_res696!==false) {var if_res700 = M0.rvoid();} else {var temp699 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp698 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1225,alen1226)!==false) {var if_res697 = $rjs_core.UString.make("");} else {var if_res697 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res700 = M0.raise_arguments_error(temp699,M0.format(temp698,if_res697),$rjs_core.UString.make("first result"),new_args1228,$rjs_core.UString.make("wrapper procedure"),wrap_proc1206);}if_res700;M0.for_each(function(kw1229, new_arg1230, arg1231) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1201!==false) {var if_res702 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1230,arg1231)!==false) {var if_res701 = M0.rvoid();} else {var if_res701 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1229),$rjs_core.UString.make("result"),new_arg1230,$rjs_core.UString.make("wrapper procedure"),wrap_proc1206);}var if_res702 = if_res701;}return if_res702;},kws1221,new_args1228,args1222);var tmp1232 = num_extra1227;if (M0.equal_p(tmp1232,0)!==false) {var if_res705 = M0.apply(M0.values,kws1221,results1224);} else {if (M0.equal_p(tmp1232,1)!==false) {var if_res704 = M0.apply(M0.values,M0.car(results1224),kws1221,M0.cdr(results1224));} else {var loop1233 = function(results1234, c1235) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1235)!==false) {var if_res703 = M0.cons(kws1221,results1234);} else {var if_res703 = M0.cons(M0.car(results1234),loop1233(M0.cdr(results1234),M0.sub1(c1235)));}return if_res703;};var if_res704 = M0.apply(M0.values,loop1233(results1224,num_extra1227));}var if_res705 = if_res704;}return if_res705;}));});var cl689 = $rjs_core.attachProcedureArity(function(...other1236706) {var other1236 = $rjs_core.Pair.listFromArray(other1236706);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res726 = $rjs_core.attachProcedureArity(function() {var fixed_lam690 = {}[arguments.length];if (fixed_lam690!==undefined) {return fixed_lam690.apply(null,arguments);} else {if (M0.__gt__eq_(cl688.length,1)!==false) {var if_res692 = cl688.apply(null,arguments);} else {if (true!==false) {var if_res691 = cl689.apply(null,arguments);} else {var if_res691 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res692 = if_res691;}return if_res692;}},[M0.make_arity_at_least(0)]);} else {var cl707 = $rjs_core.attachProcedureArity(function(kws1237, args1238, ...rest1239712) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1239 = $rjs_core.Pair.listFromArray(rest1239712);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1219,kws1237,args1238,rest1239);},$rjs_core.attachProcedureArity(function(...results1240713) {var results1240 = $rjs_core.Pair.listFromArray(results1240713);var len1241 = M0.length(results1240);var alen1242 = M0.length(rest1239);if (M0.__lt_(len1241,alen1242+1)!==false) {var if_res714 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1242+1,$rjs_core.UString.make("received number of results"),len1241,$rjs_core.UString.make("wrapper procedure"),wrap_proc1206);} else {var if_res714 = M0.rvoid();}if_res714;var num_extra1243 = len1241-(alen1242+1);var new_args1244 = M0.list_ref(results1240,num_extra1243);if (M0.list_p(new_args1244)!==false) {var if_res715 = M0.__eq_(M0.length(new_args1244),M0.length(args1238));} else {var if_res715 = false;}if (if_res715!==false) {var if_res719 = M0.rvoid();} else {var temp718 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp717 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1241,alen1242)!==false) {var if_res716 = $rjs_core.UString.make("");} else {var if_res716 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res719 = M0.raise_arguments_error(temp718,M0.format(temp717,if_res716),$rjs_core.UString.make("first result"),new_args1244,$rjs_core.UString.make("wrapper procedure"),wrap_proc1206);}if_res719;M0.for_each(function(kw1245, new_arg1246, arg1247) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1201!==false) {var if_res721 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1246,arg1247)!==false) {var if_res720 = M0.rvoid();} else {var if_res720 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1245),$rjs_core.UString.make("result"),new_arg1246,$rjs_core.UString.make("wrapper procedure"),wrap_proc1206);}var if_res721 = if_res720;}return if_res721;},kws1237,new_args1244,args1238);var tmp1248 = num_extra1243;if (M0.equal_p(tmp1248,0)!==false) {var if_res724 = M0.apply(M0.values,kws1237,results1240);} else {if (M0.equal_p(tmp1248,1)!==false) {var if_res723 = M0.apply(M0.values,M0.car(results1240),kws1237,M0.cdr(results1240));} else {var loop1249 = function(results1250, c1251) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1251)!==false) {var if_res722 = M0.cons(kws1237,results1250);} else {var if_res722 = M0.cons(M0.car(results1250),loop1249(M0.cdr(results1250),M0.sub1(c1251)));}return if_res722;};var if_res723 = M0.apply(M0.values,loop1249(results1240,num_extra1243));}var if_res724 = if_res723;}return if_res724;}));});var cl708 = $rjs_core.attachProcedureArity(function(...other1252725) {var other1252 = $rjs_core.Pair.listFromArray(other1252725);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res726 = $rjs_core.attachProcedureArity(function() {var fixed_lam709 = {}[arguments.length];if (fixed_lam709!==undefined) {return fixed_lam709.apply(null,arguments);} else {if (M0.__gt__eq_(cl707.length,1)!==false) {var if_res711 = cl707.apply(null,arguments);} else {if (true!==false) {var if_res710 = cl708.apply(null,arguments);} else {var if_res710 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res711 = if_res710;}return if_res711;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1218 = if_res726;var wrap1255 = function(proc1256, n_proc1257) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1257,proc1256))!==false) {var if_res727 = new_procedure_p(proc1256);} else {var if_res727 = false;}if (if_res727!==false) {var v1258 = new_procedure_ref(proc1256);if (M0.exact_integer_p(v1258)!==false) {var acc1259 = procedure_accessor_ref(proc1256);var if_res743 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1256,acc1259,function(self1260, sub_proc1261) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result728 = wrap1255(sub_proc1261,normalize_proc(sub_proc1261));var f1262 = let_result728.getAt(0);var acc1263 = let_result728.getAt(1);return f1262;}),acc1259);} else {if (is_impersonator_p1201!==false) {var if_res742 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res742 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1257)!==false) {var if_res741 = chaperone_procedure_by_add_mark1215(proc1256,wrap_proc1206);} else {var if_res741 = proc1256;}var new_kw_proc1264 = if_res742(if_res741,new_procedure_ref,function(self1265, proc1266) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1201!==false) {var if_res740 = new_impersonate_procedure;} else {var if_res740 = new_chaperone_procedure;}if (self_arg_p1202!==false) {var if_res739 = $rjs_core.attachProcedureArity(function(proc_self1267, kws1268, kw_args1269, self1270, ...args1271729) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1271 = $rjs_core.Pair.listFromArray(args1271729);var len1272 = M0.length(args1271);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1218,proc_self1267,kws1268,kw_args1269,args1271);},$rjs_core.attachProcedureArity(function(...results1273730) {var results1273 = $rjs_core.Pair.listFromArray(results1273730);var r_len1274 = M0.length(results1273);var list_take1275 = function(l1276, n1277) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1277)!==false) {var if_res731 = M0.rnull;} else {var if_res731 = M0.cons(M0.car(l1276),list_take1275(M0.cdr(l1276),M0.sub1(n1277)));}return if_res731;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res732 = M0.__eq_(r_len1274,2+len1272);} else {var if_res732 = false;}if (if_res732!==false) {var if_res733 = M0.apply(M0.values,M0.cadr(results1273),self1270,M0.cddr(results1273));} else {var skip1278 = r_len1274-len1272;var if_res733 = M0.apply(M0.values,M0.append(list_take1275(results1273,skip1278-2),M0.list(M0.list_ref(results1273,M0.sub1(skip1278)),self1270),M0.__rjs_quoted__.list_tail(results1273,skip1278)));}return if_res733;}));});} else {var if_res739 = $rjs_core.attachProcedureArity(function(kws1279, kw_args1280, self1281, ...args1282734) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1282 = $rjs_core.Pair.listFromArray(args1282734);var len1283 = M0.length(args1282);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1218,kws1279,kw_args1280,args1282);},$rjs_core.attachProcedureArity(function(...results1284735) {var results1284 = $rjs_core.Pair.listFromArray(results1284735);var r_len1285 = M0.length(results1284);var list_take1286 = function(l1287, n1288) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1288)!==false) {var if_res736 = M0.rnull;} else {var if_res736 = M0.cons(M0.car(l1287),list_take1286(M0.cdr(l1287),M0.sub1(n1288)));}return if_res736;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res737 = M0.__eq_(r_len1285,2+len1283);} else {var if_res737 = false;}if (if_res737!==false) {var if_res738 = M0.apply(M0.values,M0.cadr(results1284),self1281,M0.cddr(results1284));} else {var skip1289 = r_len1285-len1283;var if_res738 = M0.apply(M0.values,M0.append(list_take1286(results1284,skip1289-2),M0.list(M0.list_ref(results1284,M0.sub1(skip1289)),self1281),M0.__rjs_quoted__.list_tail(results1284,skip1289)));}return if_res738;}));});}return if_res740(proc1266,make_keyword_procedure(if_res739));});var if_res743 = M0.values(new_kw_proc1264,new_procedure_ref);}var if_res748 = if_res743;} else {if (okp_p(n_proc1257)!==false) {if (is_impersonator_p1201!==false) {if (okm_p(n_proc1257)!==false) {var if_res744 = make_optional_keyword_method_impersonator;} else {var if_res744 = make_optional_keyword_procedure_impersonator;}var if_res745 = if_res744(keyword_procedure_checker(n_proc1257),chaperone_procedure_by_add_mark1215(keyword_procedure_proc(n_proc1257),kw_chaperone1218),keyword_procedure_required(n_proc1257),keyword_procedure_allowed(n_proc1257),chaperone_procedure_by_add_mark1215(okp_ref(n_proc1257,0),okp_ref(n_wrap_proc1209,0)),n_proc1257);} else {var if_res745 = M0.__rjs_quoted__.chaperone_struct(proc1256,keyword_procedure_proc,function(self1290, proc1291) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1215(proc1291,kw_chaperone1218);},M0.make_struct_field_accessor(okp_ref,0),function(self1292, proc1293) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1215(proc1293,okp_ref(n_wrap_proc1209,0));});}var if_res747 = M0.values(if_res745,keyword_procedure_proc);} else {if (is_impersonator_p1201!==false) {var name_plus_fail1294 = keyword_procedure_name_plus_fail(n_proc1257);var mk1295 = make_required(M0.car(name_plus_fail1294),M0.cdr(name_plus_fail1294),keyword_method_p(n_proc1257),true);var if_res746 = mk1295(keyword_procedure_checker(n_proc1257),chaperone_procedure_by_add_mark1215(keyword_procedure_proc(n_proc1257),kw_chaperone1218),keyword_procedure_required(n_proc1257),keyword_procedure_allowed(n_proc1257),n_proc1257);} else {var if_res746 = M0.__rjs_quoted__.chaperone_struct(n_proc1257,keyword_procedure_proc,function(self1296, proc1297) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1215(proc1297,kw_chaperone1218);});}var if_res747 = M0.values(if_res746,keyword_procedure_proc);}var if_res748 = if_res747;}return if_res748;};var let_result749 = wrap1255(proc1205,n_proc1208);var new_proc1253 = let_result749.getAt(0);var chap_accessor1254 = let_result749.getAt(1);if (M0.null_p(props1207)!==false) {var if_res750 = new_proc1253;} else {var if_res750 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1253,chap_accessor1254,false,props1207);}var if_res751 = if_res750;}return if_res751;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1298, name1299, proc1300, wrap_proc1301, props1302) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1303 = normalize_proc(proc1300);var n_wrap_proc1304 = normalize_proc(wrap_proc1301);var or_part1305 = M0.not(keyword_procedure_p(n_proc1303));if (or_part1305!==false) {var if_res753 = or_part1305;} else {var or_part1306 = M0.not(M0.procedure_p(wrap_proc1301));if (or_part1306!==false) {var if_res752 = or_part1306;} else {var if_res752 = bad_props_p(props1302);}var if_res753 = if_res752;}if (if_res753!==false) {var if_res754 = M0.apply(unsafe_chaperone_procedure1298,proc1300,wrap_proc1301,props1302);} else {chaperone_arity_match_checking(false,name1299,proc1300,wrap_proc1301,props1302);var if_res754 = M0.apply(unsafe_chaperone_procedure1298,proc1300,wrap_proc1301,props1302);}return if_res754;};var bad_props_p = function(props1307) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1308 = function(props1309) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1309)!==false) {var if_res757 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1309))!==false) {var props1310 = M0.cdr(props1309);var or_part1311 = M0.null_p(props1310);if (or_part1311!==false) {var if_res755 = or_part1311;} else {var if_res755 = loop1308(M0.cdr(props1310));}var if_res756 = if_res755;} else {var if_res756 = true;}var if_res757 = if_res756;}return if_res757;};return loop1308(props1307);};var chaperone_arity_match_checking = function(self_arg_p1312, name1313, proc1314, wrap_proc1315, props1316) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1317 = M0.procedure_arity(proc1314);var b1318 = M0.procedure_arity(wrap_proc1315);if (self_arg_p1312!==false) {var if_res758 = 1;} else {var if_res758 = 0;}var d1319 = if_res758;var let_result759 = procedure_keywords(proc1314);var a_req1320 = let_result759.getAt(0);var a_allow1321 = let_result759.getAt(1);var let_result760 = procedure_keywords(wrap_proc1315);var b_req1322 = let_result760.getAt(0);var b_allow1323 = let_result760.getAt(1);var includes_p1324 = function(a1325, b1326) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1326)!==false) {if (M0.number_p(a1325)!==false) {var if_res762 = M0.__eq_(b1326,a1325+d1319);} else {if (M0.arity_at_least_p(a1325)!==false) {var if_res761 = M0.__gt__eq_(b1326,M0.arity_at_least_value(a1325)+d1319);} else {var if_res761 = M0.ormap(function(a1327) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1324(a1327,b1326);},a1325);}var if_res762 = if_res761;}var if_res766 = if_res762;} else {if (M0.arity_at_least_p(b1326)!==false) {if (M0.number_p(a1325)!==false) {var if_res764 = false;} else {if (M0.arity_at_least_p(a1325)!==false) {var if_res763 = M0.__gt__eq_(M0.arity_at_least_value(b1326),M0.arity_at_least_value(a1325)+d1319);} else {var if_res763 = M0.ormap(function(a1328) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1324(b1326,a1328);},a1325);}var if_res764 = if_res763;}var if_res765 = if_res764;} else {var if_res765 = M0.andmap(function(b1329) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1324(a1325,b1329);},b1326);}var if_res766 = if_res765;}return if_res766;};if (includes_p1324(b1318,a1317)!==false) {var if_res767 = M0.rvoid();} else {var if_res767 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1314,wrap_proc1315,props1316);}if_res767;if (subset_p(b_req1322,a_req1320)!==false) {var if_res768 = M0.rvoid();} else {var if_res768 = M0.raise_arguments_error(name1313,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1315,$rjs_core.UString.make("original procedure"),proc1314);}if_res768;var or_part1330 = M0.not(b_allow1323);if (or_part1330!==false) {var if_res770 = or_part1330;} else {if (a_allow1321!==false) {var if_res769 = subset_p(a_allow1321,b_allow1323);} else {var if_res769 = false;}var if_res770 = if_res769;}if (if_res770!==false) {var if_res771 = M0.rvoid();} else {var if_res771 = M0.raise_arguments_error(name1313,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1315,$rjs_core.UString.make("original procedure"),proc1314);}if_res771;return M0.rvoid();};var normalize_proc = function(proc1331) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1331)!==false) {var if_res779 = proc1331;} else {if (new_procedure_p(proc1331)!==false) {var let_result772 = procedure_keywords(proc1331);var req_kws1332 = let_result772.getAt(0);var allowed_kws1333 = let_result772.getAt(1);if (M0.null_p(allowed_kws1333)!==false) {var if_res777 = proc1331;} else {var if_res777 = make_optional_keyword_procedure(function(given_kws1334, given_argc1335) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1331,given_argc1335-2,true)!==false) {var or_part1336 = M0.not(allowed_kws1333);if (or_part1336!==false) {var if_res774 = or_part1336;} else {var if_res774 = subset_p(given_kws1334,allowed_kws1333);}if (if_res774!==false) {var if_res775 = subset_p(req_kws1332,given_kws1334);} else {var if_res775 = false;}var if_res776 = if_res775;} else {var if_res776 = false;}return if_res776;},$rjs_core.attachProcedureArity(function(kws1337, kw_args1338, ...vals1339773) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1339 = $rjs_core.Pair.listFromArray(vals1339773);return keyword_apply(proc1331,kws1337,kw_args1338,vals1339);}),req_kws1332,allowed_kws1333,proc1331);}var if_res778 = if_res777;} else {var if_res778 = proc1331;}var if_res779 = if_res778;}return if_res779;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };