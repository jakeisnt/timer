import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result459 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result459.getAt(0);var keyword_impersonator_p = let_result459.getAt(1);var keyword_impersonator_ref = let_result459.getAt(2);var keyword_procedure_impersonator_of = function(v957) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v957)!==false) {var if_res460 = keyword_impersonator_ref(v957)(v957);} else {var if_res460 = false;}return if_res460;};var let_result461 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result461.getAt(0);var mk_kw_proc = let_result461.getAt(1);var keyword_procedure_p = let_result461.getAt(2);var keyword_procedure_ref = let_result461.getAt(3);var keyword_procedure_set_bang_ = let_result461.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result462 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result462.getAt(0);var make_km = let_result462.getAt(1);var keyword_method_p = let_result462.getAt(2);var km_ref = let_result462.getAt(3);var km_set_bang_ = let_result462.getAt(4);var generate_arity_string = function(proc958) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result463 = procedure_keywords(proc958);var req959 = let_result463.getAt(0);var allowed960 = let_result463.getAt(1);var a961 = M0.procedure_arity(proc958);var keywords_desc962 = function(opt964, req965) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp469 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req965))!==false) {var if_res468 = M0.format($rjs_core.UString.make("an ~aargument"),opt964);} else {var if_res468 = M0.format($rjs_core.UString.make("~aarguments"),opt964);}if (M0.null_p(M0.cdr(req965))!==false) {var if_res467 = $rjs_core.UString.make("");} else {var if_res467 = $rjs_core.UString.make("s");}var tmp966 = M0.length(req965);if (M0.equal_p(tmp966,1)!==false) {var if_res466 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req965));} else {if (M0.equal_p(tmp966,2)!==false) {var if_res465 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req965),M0.cadr(req965));} else {var loop967 = function(req968) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req968))!==false) {var if_res464 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req968));} else {var if_res464 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req968),loop967(M0.cdr(req968)));}return if_res464;};var if_res465 = loop967(req965);}var if_res466 = if_res465;}return M0.format(temp469,if_res468,if_res467,if_res466);};var method_adjust963 = function(a969) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part970 = okm_p(proc958);if (or_part970!==false) {var if_res470 = or_part970;} else {var if_res470 = keyword_method_p(proc958);}if (if_res470!==false) {if (M0.zero_p(a969)!==false) {var if_res471 = 0;} else {var if_res471 = M0.sub1(a969);}var if_res472 = if_res471;} else {var if_res472 = a969;}return if_res472;};if (M0.number_p(a961)!==false) {var a971 = method_adjust963(a961);var if_res479 = M0.format($rjs_core.UString.make("~a"),a971);} else {if (M0.arity_at_least_p(a961)!==false) {var a972 = method_adjust963(M0.arity_at_least_value(a961));var if_res478 = M0.format($rjs_core.UString.make("at least ~a"),a972);} else {var if_res478 = $rjs_core.UString.make("a different number");}var if_res479 = if_res478;}if (M0.null_p(req959)!==false) {var if_res477 = $rjs_core.UString.make("");} else {var if_res477 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc962($rjs_core.UString.make(""),req959));}if (allowed960!==false) {var loop974 = function(req975, allowed976) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req975)!==false) {var if_res474 = allowed976;} else {if (M0.eq_p(M0.car(req975),M0.car(allowed976))!==false) {var if_res473 = loop974(M0.cdr(req975),M0.cdr(allowed976));} else {var if_res473 = M0.cons(M0.car(allowed976),loop974(req975,M0.cdr(allowed976)));}var if_res474 = if_res473;}return if_res474;};var others973 = loop974(req959,allowed960);if (M0.null_p(others973)!==false) {var if_res475 = $rjs_core.UString.make("");} else {var if_res475 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc962($rjs_core.UString.make("optional "),others973));}var if_res476 = if_res475;} else {var if_res476 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res479,if_res477,if_res476);};var let_result480 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result480.getAt(0);var make_optional_keyword_procedure = let_result480.getAt(1);var okp_p = let_result480.getAt(2);var okp_ref = let_result480.getAt(3);var okp_set_bang_ = let_result480.getAt(4);var let_result481 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result481.getAt(0);var make_optional_keyword_method = let_result481.getAt(1);var okm_p = let_result481.getAt(2);var okm_ref = let_result481.getAt(3);var okm_set_bang_ = let_result481.getAt(4);var let_result482 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result482.getAt(0);var named_keyword_procedure_p = let_result482.getAt(1);var keyword_procedure_name_plus_fail = let_result482.getAt(2);var let_result484 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v977, info_l978) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v977)!==false) {var if_res483 = M0.make_struct_field_accessor(M0.list_ref(info_l978,3),v977);} else {var if_res483 = false;}return if_res483;});var prop_procedure_accessor = let_result484.getAt(0);var procedure_accessor_p = let_result484.getAt(1);var procedure_accessor_ref = let_result484.getAt(2);var let_result485 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result485.getAt(0);var new_procedure_p = let_result485.getAt(1);var new_procedure_ref = let_result485.getAt(2);var let_result486 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v979) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v979,0);})));var struct_keyword_procedure_impersonator = let_result486.getAt(0);var make_kpp = let_result486.getAt(1);var keyword_procedure_impersonator_p = let_result486.getAt(2);var kpp_ref = let_result486.getAt(3);var kpp_set_bang_ = let_result486.getAt(4);var let_result487 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v980) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v980,0);})));var struct_keyword_method_impersonator = let_result487.getAt(0);var make_kmp = let_result487.getAt(1);var keyword_method_impersonator_p = let_result487.getAt(2);var kmp_ref = let_result487.getAt(3);var kmp_set_bang_ = let_result487.getAt(4);var let_result488 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v981) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v981,0);})));var struct_okpp = let_result488.getAt(0);var make_optional_keyword_procedure_impersonator = let_result488.getAt(1);var okpp_p = let_result488.getAt(2);var okpp_ref = let_result488.getAt(3);var okpp_set_bang_ = let_result488.getAt(4);var let_result489 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v982) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v982,0);})));var struct_okmp = let_result489.getAt(0);var make_optional_keyword_method_impersonator = let_result489.getAt(1);var okmp_p = let_result489.getAt(2);var okmp_ref = let_result489.getAt(3);var okmp_set_bang_ = let_result489.getAt(4);var let_result490 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result490.getAt(0);var make_kp_by_ae = let_result490.getAt(1);var kp_by_ae_p = let_result490.getAt(2);var kp_by_ae_ref = let_result490.getAt(3);var kp_by_ae_set_bang_ = let_result490.getAt(4);var let_result491 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result491.getAt(0);var make_km_by_ae = let_result491.getAt(1);var km_by_ae_p = let_result491.getAt(2);var km_by_ae_ref = let_result491.getAt(3);var km_by_ae_set_bang_ = let_result491.getAt(4);var let_result492 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result492.getAt(0);var make_kpi_by_ae = let_result492.getAt(1);var kpi_by_ae_p = let_result492.getAt(2);var kpi_by_ae_ref = let_result492.getAt(3);var kpi_by_ae_set_bang_ = let_result492.getAt(4);var let_result493 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result493.getAt(0);var make_kmi_by_ae = let_result493.getAt(1);var kmi_by_ae_p = let_result493.getAt(2);var kmi_by_ae_ref = let_result493.getAt(3);var kmi_by_ae_set_bang_ = let_result493.getAt(4);var make_required = function(name983, fail_proc984, method_p985, impersonator_p986) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part992 = name983;if (or_part992!==false) {var if_res497 = or_part992;} else {var if_res497 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p986!==false) {if (method_p985!==false) {var if_res494 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res494 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res496 = if_res494;} else {if (method_p985!==false) {var if_res495 = struct_keyword_method_by_arity_error;} else {var if_res495 = struct_keyword_procedure_by_arity_error;}var if_res496 = if_res495;}var let_result498 = M0.make_struct_type(if_res497,if_res496,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name983,fail_proc984))),M0.current_inspector(),fail_proc984);var s_987 = let_result498.getAt(0);var mk988 = let_result498.getAt(1);var __p989 = let_result498.getAt(2);var __ref990 = let_result498.getAt(3);var __set_bang_991 = let_result498.getAt(4);return mk988;};var cl499 = function(proc993) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name994 = M0.object_name(proc993);var plain_proc995 = $rjs_core.attachProcedureArity(function(...args996502) {var args996 = $rjs_core.Pair.listFromArray(args996502);return M0.apply(proc993,M0.rnull,M0.rnull,args996);});if (M0.symbol_p(proc_name994)!==false) {var if_res503 = M0.__rjs_quoted__.procedure_rename(plain_proc995,proc_name994);} else {var if_res503 = plain_proc995;}return make_keyword_procedure(proc993,if_res503);};var cl500 = function(proc997, plain_proc998) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc997)!==false) {var if_res504 = M0.procedure_arity_mask(proc997);} else {var if_res504 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res504),proc997,M0.rnull,false,plain_proc998);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam501 = {'1':cl499,'2':cl500}[arguments.length];if (fixed_lam501!==undefined) {return fixed_lam501.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc999, kws1000, kw_vals1001, normal_args1002, ...normal_argss1003505) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1003 = $rjs_core.Pair.listFromArray(normal_argss1003505);var type_error1004 = function(what1005, which1006) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1005,which1006,proc999,kws1000,kw_vals1001,normal_args1002,normal_argss1003);};if (M0.procedure_p(proc999)!==false) {var if_res506 = M0.rvoid();} else {var if_res506 = type_error1004($rjs_core.UString.make("procedure?"),0);}if_res506;var loop1007 = function(ks1008) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1008)!==false) {var if_res513 = M0.rvoid();} else {var or_part1009 = M0.not(M0.pair_p(ks1008));if (or_part1009!==false) {var if_res507 = or_part1009;} else {var if_res507 = M0.not(M0.keyword_p(M0.car(ks1008)));}if (if_res507!==false) {var if_res512 = type_error1004($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1008))!==false) {var if_res511 = M0.rvoid();} else {var or_part1010 = M0.not(M0.pair_p(M0.cdr(ks1008)));if (or_part1010!==false) {var if_res508 = or_part1010;} else {var if_res508 = M0.not(M0.keyword_p(M0.cadr(ks1008)));}if (if_res508!==false) {var if_res510 = loop1007(M0.cdr(ks1008));} else {if (M0.keyword_lt__p(M0.car(ks1008),M0.cadr(ks1008))!==false) {var if_res509 = loop1007(M0.cdr(ks1008));} else {var if_res509 = type_error1004($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res510 = if_res509;}var if_res511 = if_res510;}var if_res512 = if_res511;}var if_res513 = if_res512;}return if_res513;};loop1007(kws1000);if (M0.list_p(kw_vals1001)!==false) {var if_res514 = M0.rvoid();} else {var if_res514 = type_error1004($rjs_core.UString.make("list?"),2);}if_res514;if (M0.__eq_(M0.length(kws1000),M0.length(kw_vals1001))!==false) {var if_res515 = M0.rvoid();} else {var if_res515 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1000),$rjs_core.UString.make("value list length"),M0.length(kw_vals1001),$rjs_core.UString.make("keyword list"),kws1000,$rjs_core.UString.make("value list"),kw_vals1001);}if_res515;var loop1012 = function(normal_argss1013, pos1014) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1013))!==false) {var l1015 = M0.car(normal_argss1013);if (M0.list_p(l1015)!==false) {var if_res516 = l1015;} else {var if_res516 = type_error1004($rjs_core.UString.make("list?"),pos1014);}var if_res517 = if_res516;} else {var if_res517 = M0.cons(M0.car(normal_argss1013),loop1012(M0.cdr(normal_argss1013),M0.add1(pos1014)));}return if_res517;};var normal_args1011 = loop1012(M0.cons(normal_args1002,normal_argss1003),3);if (M0.null_p(kws1000)!==false) {var if_res518 = M0.apply(proc999,normal_args1011);} else {var if_res518 = M0.apply(keyword_procedure_extract_by_method(kws1000,2+M0.length(normal_args1011),proc999,0),kws1000,kw_vals1001,normal_args1011);}return if_res518;});var procedure_keywords = function(p1016) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1016)!==false) {var if_res523 = M0.values(keyword_procedure_required(p1016),keyword_procedure_allowed(p1016));} else {if (M0.procedure_p(p1016)!==false) {if (new_procedure_p(p1016)!==false) {var v1017 = new_procedure_ref(p1016);if (M0.procedure_p(v1017)!==false) {var if_res520 = procedure_keywords(v1017);} else {var a1018 = procedure_accessor_ref(p1016);if (a1018!==false) {var if_res519 = procedure_keywords(a1018(p1016));} else {var if_res519 = M0.values(M0.rnull,M0.rnull);}var if_res520 = if_res519;}var if_res521 = if_res520;} else {var if_res521 = M0.values(M0.rnull,M0.rnull);}var if_res522 = if_res521;} else {var if_res522 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1016);}var if_res523 = if_res522;}return if_res523;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1019, ...args1020524) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1020 = $rjs_core.Pair.listFromArray(args1020524);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1019,0),M0.rnull,M0.rnull,args1020);});var check_kw_args = function(p1021, kws1022) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1023 = function(kws1024, required1025, allowed1026) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1024)!==false) {if (M0.null_p(required1025)!==false) {var if_res525 = M0.values(false,false);} else {var if_res525 = M0.values(M0.car(required1025),false);}var if_res534 = if_res525;} else {if (M0.pair_p(required1025)!==false) {var if_res526 = M0.eq_p(M0.car(required1025),M0.car(kws1024));} else {var if_res526 = false;}if (if_res526!==false) {var temp529 = M0.cdr(kws1024);var temp528 = M0.cdr(required1025);if (allowed1026!==false) {var if_res527 = M0.cdr(allowed1026);} else {var if_res527 = false;}var if_res533 = loop1023(temp529,temp528,if_res527);} else {if (M0.not(allowed1026)!==false) {var if_res532 = loop1023(M0.cdr(kws1024),required1025,false);} else {if (M0.pair_p(allowed1026)!==false) {if (M0.eq_p(M0.car(allowed1026),M0.car(kws1024))!==false) {var if_res530 = loop1023(M0.cdr(kws1024),required1025,M0.cdr(allowed1026));} else {var if_res530 = loop1023(kws1024,required1025,M0.cdr(allowed1026));}var if_res531 = if_res530;} else {var if_res531 = M0.values(false,M0.car(kws1024));}var if_res532 = if_res531;}var if_res533 = if_res532;}var if_res534 = if_res533;}return if_res534;};return loop1023(kws1022,keyword_procedure_required(p1021),keyword_procedure_allowed(p1021));};var make_keyword_checker = function(req_kws1027, allowed_kws1028, arity_mask1029) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1028)!==false) {if (M0.null_p(req_kws1027)!==false) {var if_res537 = function(kws1030, a1031) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res535 = M0.bitwise_bit_set_p(arity_mask1029,a1031);} else {var if_res535 = false;}return if_res535;};} else {var if_res537 = function(kws1032, a1033) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1027,kws1032)!==false) {var if_res536 = M0.bitwise_bit_set_p(arity_mask1029,a1033);} else {var if_res536 = false;}return if_res536;};}var if_res550 = if_res537;} else {if (M0.null_p(allowed_kws1028)!==false) {var if_res549 = function(kws1034, a1035) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1034)!==false) {var if_res538 = M0.bitwise_bit_set_p(arity_mask1029,a1035);} else {var if_res538 = false;}return if_res538;};} else {if (M0.null_p(req_kws1027)!==false) {var if_res548 = function(kws1036, a1037) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1036,allowed_kws1028)!==false) {var if_res539 = M0.bitwise_bit_set_p(arity_mask1029,a1037);} else {var if_res539 = false;}return if_res539;};} else {if (M0.list_p(req_kws1027)!==false) {if (M0.list_p(allowed_kws1028)!==false) {var if_res540 = M0.eq_p(M0.length(req_kws1027),M0.length(allowed_kws1028));} else {var if_res540 = false;}var if_res541 = if_res540;} else {var if_res541 = false;}if (if_res541!==false) {var if_res547 = function(kws1038, a1039) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1040 = function(kws1041, req_kws1042) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1042)!==false) {var if_res544 = M0.null_p(kws1041);} else {if (M0.null_p(kws1041)!==false) {var if_res543 = false;} else {if (M0.eq_p(M0.car(kws1041),M0.car(req_kws1042))!==false) {var if_res542 = loop1040(M0.cdr(kws1041),M0.cdr(req_kws1042));} else {var if_res542 = false;}var if_res543 = if_res542;}var if_res544 = if_res543;}return if_res544;};if (loop1040(kws1038,req_kws1027)!==false) {var if_res545 = M0.bitwise_bit_set_p(arity_mask1029,a1039);} else {var if_res545 = false;}return if_res545;};} else {var if_res547 = function(kws1043, a1044) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1027,kws1043,allowed_kws1028)!==false) {var if_res546 = M0.bitwise_bit_set_p(arity_mask1029,a1044);} else {var if_res546 = false;}return if_res546;};}var if_res548 = if_res547;}var if_res549 = if_res548;}var if_res550 = if_res549;}return if_res550;};var subset_p = function(l11045, l21046) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11045)!==false) {var if_res553 = true;} else {if (M0.null_p(l21046)!==false) {var if_res552 = false;} else {if (M0.eq_p(M0.car(l11045),M0.car(l21046))!==false) {var if_res551 = subset_p(M0.cdr(l11045),M0.cdr(l21046));} else {var if_res551 = subset_p(l11045,M0.cdr(l21046));}var if_res552 = if_res551;}var if_res553 = if_res552;}return if_res553;};var subsets_p = function(l11047, l21048, l31049) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11047)!==false) {var if_res558 = subset_p(l21048,l31049);} else {if (M0.null_p(l21048)!==false) {var if_res557 = false;} else {if (M0.null_p(l31049)!==false) {var if_res556 = false;} else {var v21050 = M0.car(l21048);if (M0.eq_p(M0.car(l11047),v21050)!==false) {var if_res555 = subsets_p(M0.cdr(l11047),M0.cdr(l21048),M0.cdr(l31049));} else {if (M0.eq_p(v21050,M0.car(l31049))!==false) {var if_res554 = subsets_p(l11047,M0.cdr(l21048),M0.cdr(l31049));} else {var if_res554 = subsets_p(l11047,l21048,M0.cdr(l31049));}var if_res555 = if_res554;}var if_res556 = if_res555;}var if_res557 = if_res556;}var if_res558 = if_res557;}return if_res558;};var keyword_procedure_extract_by_method = function(kws1051, n1052, p1053, method_n1054) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1053)!==false) {var if_res559 = keyword_procedure_checker(p1053)(kws1051,n1052);} else {var if_res559 = false;}if (if_res559!==false) {var if_res589 = keyword_procedure_proc(p1053);} else {if (M0.not(keyword_procedure_p(p1053))!==false) {if (M0.procedure_p(p1053)!==false) {if (new_procedure_p(p1053)!==false) {var a1057 = procedure_accessor_ref(p1053);if (a1057!==false) {var if_res560 = a1057(p1053);} else {var if_res560 = false;}var if_res561 = if_res560;} else {var if_res561 = false;}var or_part1056 = if_res561;if (or_part1056!==false) {var if_res564 = or_part1056;} else {var or_part1058 = M0.procedure_extract_target(p1053);if (or_part1058!==false) {var if_res563 = or_part1058;} else {if (new_procedure_p(p1053)!==false) {var if_res562 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res562 = false;}var if_res563 = if_res562;}var if_res564 = if_res563;}var if_res565 = if_res564;} else {var if_res565 = false;}var if_res566 = if_res565;} else {var if_res566 = false;}var p21055 = if_res566;if (p21055!==false) {if (M0.eq_p(p21055,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31059 = keyword_procedure_extract_by_method(kws1051,M0.add1(n1052),new_procedure_ref(p1053),M0.add1(method_n1054));var if_res568 = $rjs_core.attachProcedureArity(function(kws1060, kw_args1061, ...args1062567) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1062 = $rjs_core.Pair.listFromArray(args1062567);return M0.apply(p31059,kws1060,kw_args1061,M0.cons(p1053,args1062));});} else {var if_res568 = keyword_procedure_extract_by_method(kws1051,n1052,p21055,method_n1054);}var if_res588 = if_res568;} else {var if_res588 = $rjs_core.attachProcedureArity(function(kws1063, kw_args1064, ...args1065569) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1065 = $rjs_core.Pair.listFromArray(args1065569);if (keyword_procedure_p(p1053)!==false) {var if_res570 = check_kw_args(p1053,kws1063);} else {var if_res570 = M0.values(false,M0.car(kws1063));}var let_result571 = if_res570;var missing_kw1066 = let_result571.getAt(0);var extra_kw1067 = let_result571.getAt(1);var or_part1072 = keyword_method_p(p1053);if (or_part1072!==false) {var if_res572 = or_part1072;} else {var if_res572 = okm_p(p1053);}if (if_res572!==false) {var if_res573 = 1;} else {var if_res573 = 0;}var method_n1071 = method_n1054+if_res573;if (M0.__gt__eq_(n1052,method_n1071)!==false) {var if_res574 = n1052-method_n1071;} else {var if_res574 = n1052;}var n1068 = if_res574;if (M0.null_p(args1065)!==false) {var if_res575 = M0.null_p(kws1063);} else {var if_res575 = false;}if (if_res575!==false) {var if_res576 = $rjs_core.UString.make("");} else {var if_res576 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1073) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1073);},args1065),M0.map(function(kw1074, kw_arg1075) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1074,kw_arg1075);},kws1063,kw_args1064)));}var args_str1069 = if_res576;var proc_name1070 = function(p1076) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1076)!==false) {var if_res577 = M0.car(keyword_procedure_name_plus_fail(p1076));} else {var if_res577 = false;}var or_part1077 = if_res577;if (or_part1077!==false) {var if_res579 = or_part1077;} else {var or_part1078 = M0.object_name(p1076);if (or_part1078!==false) {var if_res578 = or_part1078;} else {var if_res578 = p1076;}var if_res579 = if_res578;}return if_res579;};var or_part1079 = extra_kw1067;if (or_part1079!==false) {var if_res586 = or_part1079;} else {var if_res586 = missing_kw1066;}if (if_res586!==false) {var if_res587 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res587 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1067!==false) {if (keyword_procedure_p(p1053)!==false) {var if_res581 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1070(p1053),extra_kw1067,args_str1069);} else {if (M0.procedure_p(p1053)!==false) {var if_res580 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1070(p1053),args_str1069);} else {var if_res580 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1053,args_str1069);}var if_res581 = if_res580;}var if_res585 = if_res581;} else {if (missing_kw1066!==false) {var if_res584 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1070(p1053),missing_kw1066,args_str1069);} else {var temp583 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1068-2)!==false) {var if_res582 = $rjs_core.UString.make("");} else {var if_res582 = $rjs_core.UString.make("s");}var if_res584 = M0.format(temp583,n1068-2,if_res582,proc_name1070(p1053),args_str1069);}var if_res585 = if_res584;}return M0.raise(if_res587(if_res585,M0.current_continuation_marks()));});}var if_res589 = if_res588;}return if_res589;};var keyword_procedure_extract = function(p1080, kws1081, n1082) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1081,n1082,p1080,0);};var cl590 = function(proc1083, arity1084, req_kw1085, allowed_kw1086, name1087) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1083,arity1084,false,name1087,req_kw1085,allowed_kw1086);};var cl591 = function(proc1088, arity1089, req_kw1090, allowed_kw1091) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1088,arity1089,false,false,req_kw1090,allowed_kw1091);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam592 = {'5':cl590,'4':cl591}[arguments.length];if (fixed_lam592!==undefined) {return fixed_lam592.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl593 = function(proc1092, mask1093, req_kw1094, allowed_kw1095, name1096) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1092,false,mask1093,name1096,req_kw1094,allowed_kw1095);};var cl594 = function(proc1097, mask1098, req_kw1099, allowed_kw1100) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1097,false,mask1098,false,req_kw1099,allowed_kw1100);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam595 = {'5':cl593,'4':cl594}[arguments.length];if (fixed_lam595!==undefined) {return fixed_lam595.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1101, proc1102, arity1103, mask1104, name1105, req_kw1106, allowed_kw1107) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1102)!==false) {var if_res596 = okp_ref(proc1102,0);} else {var if_res596 = proc1102;}var p1109 = if_res596;if (arity1103!==false) {var if_res597 = M0.__rjs_quoted__.procedure_reduce_arity(p1109,arity1103);} else {var if_res597 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1109,mask1104,name1105);}var plain_proc1108 = if_res597;var sorted_p1110 = function(kws1111) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1112 = function(kws1113) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1113)!==false) {var if_res600 = true;} else {if (M0.null_p(M0.cdr(kws1113))!==false) {var if_res599 = true;} else {if (M0.keyword_lt__p(M0.car(kws1113),M0.cadr(kws1113))!==false) {var if_res598 = loop1112(M0.cdr(kws1113));} else {var if_res598 = false;}var if_res599 = if_res598;}var if_res600 = if_res599;}return if_res600;};return loop1112(kws1111);};if (M0.list_p(req_kw1106)!==false) {if (M0.andmap(M0.keyword_p,req_kw1106)!==false) {var if_res601 = sorted_p1110(req_kw1106);} else {var if_res601 = false;}var if_res602 = if_res601;} else {var if_res602 = false;}if (if_res602!==false) {var if_res605 = M0.rvoid();} else {var temp604 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1114 = arity1103;if (or_part1114!==false) {var if_res603 = or_part1114;} else {var if_res603 = mask1104;}var if_res605 = M0.raise_argument_error(who1101,temp604,2,proc1102,if_res603,req_kw1106,allowed_kw1107);}if_res605;if (allowed_kw1107!==false) {if (M0.list_p(allowed_kw1107)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1107)!==false) {var if_res606 = sorted_p1110(allowed_kw1107);} else {var if_res606 = false;}var if_res607 = if_res606;} else {var if_res607 = false;}if (if_res607!==false) {var if_res610 = M0.rvoid();} else {var temp609 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1115 = arity1103;if (or_part1115!==false) {var if_res608 = or_part1115;} else {var if_res608 = mask1104;}var if_res610 = M0.raise_argument_error(who1101,temp609,3,proc1102,if_res608,req_kw1106,allowed_kw1107);}if_res610;if (subset_p(req_kw1106,allowed_kw1107)!==false) {var if_res611 = M0.rvoid();} else {var if_res611 = M0.raise_arguments_error(who1101,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1107,$rjs_core.UString.make("required keywords"),req_kw1106);}var if_res612 = if_res611;} else {var if_res612 = M0.rvoid();}if_res612;var let_result613 = procedure_keywords(proc1102);var old_req1116 = let_result613.getAt(0);var old_allowed1117 = let_result613.getAt(1);if (subset_p(old_req1116,req_kw1106)!==false) {var if_res614 = M0.rvoid();} else {var if_res614 = M0.raise_arguments_error(who1101,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1116,$rjs_core.UString.make("requested required keywords"),req_kw1106);}if_res614;if (old_allowed1117!==false) {if (subset_p(req_kw1106,old_allowed1117)!==false) {var if_res615 = M0.rvoid();} else {var if_res615 = M0.raise_arguments_error(who1101,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1117,$rjs_core.UString.make("requested required keywords"),req_kw1106);}if_res615;var or_part1118 = M0.not(allowed_kw1107);if (or_part1118!==false) {var if_res616 = or_part1118;} else {var if_res616 = subset_p(allowed_kw1107,old_allowed1117);}if (if_res616!==false) {var if_res617 = M0.rvoid();} else {var if_res617 = M0.raise_arguments_error(who1101,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1117,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1107);}var if_res618 = if_res617;} else {var if_res618 = M0.rvoid();}if_res618;if (M0.null_p(allowed_kw1107)!==false) {var if_res626 = plain_proc1108;} else {var or_part1120 = mask1104;if (or_part1120!==false) {var if_res619 = or_part1120;} else {var if_res619 = arity__gt_mask(arity1103);}var mask1119 = if_res619;var new_mask1121 = M0.arithmetic_shift(mask1119,2);var kw_checker1122 = make_keyword_checker(req_kw1106,allowed_kw1107,new_mask1121);var proc1123 = normalize_proc(proc1102);var new_kw_proc1124 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1123),new_mask1121);if (M0.null_p(req_kw1106)!==false) {if (okm_p(proc1123)!==false) {var if_res620 = make_optional_keyword_method;} else {var if_res620 = make_optional_keyword_procedure;}var if_res625 = if_res620(kw_checker1122,new_kw_proc1124,req_kw1106,allowed_kw1107,plain_proc1108);} else {if (named_keyword_procedure_p(proc1123)!==false) {var if_res623 = M0.car(keyword_procedure_name_plus_fail(proc1123));} else {var if_res623 = false;}var or_part1125 = if_res623;if (or_part1125!==false) {var if_res624 = or_part1125;} else {var if_res624 = M0.object_name(proc1123);}var temp622 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1119,1));var or_part1126 = okm_p(proc1123);if (or_part1126!==false) {var if_res621 = or_part1126;} else {var if_res621 = keyword_method_p(proc1123);}var if_res625 = make_required(if_res624,temp622,if_res621,false)(kw_checker1122,new_kw_proc1124,req_kw1106,allowed_kw1107);}var if_res626 = if_res625;}return if_res626;};var arity__gt_mask = function(a1127) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1127)!==false) {var if_res632 = M0.arithmetic_shift(1,a1127);} else {if (M0.arity_at_least_p(a1127)!==false) {var if_res631 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1127))));} else {if (M0.list_p(a1127)!==false) {var loop1128 = function(mask1129, l1130) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1130)!==false) {var if_res629 = mask1129;} else {var a1131 = M0.car(l1130);var or_part1132 = M0.exact_nonnegative_integer_p(a1131);if (or_part1132!==false) {var if_res627 = or_part1132;} else {var if_res627 = M0.arity_at_least_p(a1131);}if (if_res627!==false) {var if_res628 = loop1128(M0.bitwise_ior(mask1129,arity__gt_mask(a1131)),M0.cdr(l1130));} else {var if_res628 = false;}var if_res629 = if_res628;}return if_res629;};var if_res630 = loop1128(0,a1127);} else {var if_res630 = false;}var if_res631 = if_res630;}var if_res632 = if_res631;}return if_res632;};var cl633 = function(proc1134, arity1135, name1136) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1134)!==false) {var let_result636 = procedure_keywords(proc1134);var req1137 = let_result636.getAt(0);var allows1138 = let_result636.getAt(1);if (M0.pair_p(req1137)!==false) {var if_res637 = M0.not(M0.null_p(arity1135));} else {var if_res637 = false;}var if_res638 = if_res637;} else {var if_res638 = false;}if (if_res638!==false) {var if_res640 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1134);} else {if (okm_p(proc1134)!==false) {var if_res639 = M0.__rjs_quoted__.procedure__gt_method(proc1134);} else {var if_res639 = proc1134;}var if_res640 = M0.__rjs_quoted__.procedure_reduce_arity(if_res639,arity1135,name1136);}return if_res640;};var cl634 = function(proc1139, arity1140) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1139,arity1140,false);};var procedure_reduce_arity1133 = $rjs_core.attachProcedureArity(function() {var fixed_lam635 = {'3':cl633,'2':cl634}[arguments.length];if (fixed_lam635!==undefined) {return fixed_lam635.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1133;var cl641 = function(proc1142, mask1143, name1144) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1142)!==false) {var let_result644 = procedure_keywords(proc1142);var req1145 = let_result644.getAt(0);var allows1146 = let_result644.getAt(1);if (M0.pair_p(req1145)!==false) {var if_res645 = M0.not(M0.eqv_p(mask1143,0));} else {var if_res645 = false;}var if_res646 = if_res645;} else {var if_res646 = false;}if (if_res646!==false) {var if_res648 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1142);} else {if (okm_p(proc1142)!==false) {var if_res647 = M0.__rjs_quoted__.procedure__gt_method(proc1142);} else {var if_res647 = proc1142;}var if_res648 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res647,mask1143,name1144);}return if_res648;};var cl642 = function(proc1147, mask1148) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1147,mask1148,false);};var procedure_reduce_arity1141 = $rjs_core.attachProcedureArity(function() {var fixed_lam643 = {'3':cl641,'2':cl642}[arguments.length];if (fixed_lam643!==undefined) {return fixed_lam643.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1141;var procedure__gt_method1149 = function(proc1150) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1151 = normalize_proc(proc1150);if (keyword_procedure_p(proc1151)!==false) {if (okm_p(proc1151)!==false) {var if_res651 = proc1151;} else {if (keyword_method_p(proc1151)!==false) {var if_res650 = proc1151;} else {if (okp_p(proc1151)!==false) {var if_res649 = make_optional_keyword_method(keyword_procedure_checker(proc1151),keyword_procedure_proc(proc1151),keyword_procedure_required(proc1151),keyword_procedure_allowed(proc1151),okp_ref(proc1151,0));} else {var name_plus_fail1152 = keyword_procedure_name_plus_fail(proc1151);var mk1153 = make_required(M0.car(name_plus_fail1152),M0.cdr(name_plus_fail1152),true,false);var if_res649 = mk1153(keyword_procedure_checker(proc1151),keyword_procedure_proc(proc1151),keyword_procedure_required(proc1151),keyword_procedure_allowed(proc1151));}var if_res650 = if_res649;}var if_res651 = if_res650;}var if_res652 = if_res651;} else {var if_res652 = M0.__rjs_quoted__.procedure__gt_method(proc1151);}return if_res652;};var new_procedure__gt_method = procedure__gt_method1149;var procedure_rename1154 = function(proc1155, name1156) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1155)!==false) {var if_res653 = M0.symbol_p(name1156);} else {var if_res653 = false;}if (M0.not(if_res653)!==false) {var if_res656 = M0.__rjs_quoted__.procedure_rename(proc1155,name1156);} else {if (okp_p(proc1155)!==false) {if (okm_p(proc1155)!==false) {var if_res654 = make_optional_keyword_method;} else {var if_res654 = make_optional_keyword_procedure;}var if_res655 = if_res654(keyword_procedure_checker(proc1155),keyword_procedure_proc(proc1155),keyword_procedure_required(proc1155),keyword_procedure_allowed(proc1155),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1155,0),name1156));} else {var name_plus_fail1157 = keyword_procedure_name_plus_fail(proc1155);var mk1158 = make_required(name1156,M0.cdr(name_plus_fail1157),keyword_method_p(proc1155),false);var if_res655 = mk1158(keyword_procedure_checker(proc1155),keyword_procedure_proc(proc1155),keyword_procedure_required(proc1155),keyword_procedure_allowed(proc1155));}var if_res656 = if_res655;}return if_res656;};var new_procedure_rename = procedure_rename1154;var chaperone_procedure1159 = $rjs_core.attachProcedureArity(function(proc1160, wrap_proc1161, ...props1162657) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1162 = $rjs_core.Pair.listFromArray(props1162657);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1160,wrap_proc1161,props1162);});var new_chaperone_procedure = chaperone_procedure1159;var unsafe_chaperone_procedure1163 = $rjs_core.attachProcedureArity(function(proc1164, wrap_proc1165, ...props1166658) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1166 = $rjs_core.Pair.listFromArray(props1166658);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1164,wrap_proc1165,props1166);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1163;var impersonate_procedure1167 = $rjs_core.attachProcedureArity(function(proc1168, wrap_proc1169, ...props1170659) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1170 = $rjs_core.Pair.listFromArray(props1170659);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1168,wrap_proc1169,props1170);});var new_impersonate_procedure = impersonate_procedure1167;var unsafe_impersonate_procedure1171 = $rjs_core.attachProcedureArity(function(proc1172, wrap_proc1173, ...props1174660) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1174 = $rjs_core.Pair.listFromArray(props1174660);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1172,wrap_proc1173,props1174);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1171;var chaperone_procedure_times_1175 = $rjs_core.attachProcedureArity(function(proc1176, wrap_proc1177, ...props1178661) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1178 = $rjs_core.Pair.listFromArray(props1178661);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1176,wrap_proc1177,props1178);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1175;var impersonate_procedure_times_1179 = $rjs_core.attachProcedureArity(function(proc1180, wrap_proc1181, ...props1182662) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1182 = $rjs_core.Pair.listFromArray(props1182662);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1180,wrap_proc1181,props1182);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1179;var do_chaperone_procedure = function(is_impersonator_p1183, self_arg_p1184, chaperone_procedure1185, name1186, proc1187, wrap_proc1188, props1189) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1190 = normalize_proc(proc1187);var n_wrap_proc1191 = normalize_proc(wrap_proc1188);var or_part1192 = M0.not(keyword_procedure_p(n_proc1190));if (or_part1192!==false) {var if_res664 = or_part1192;} else {var or_part1193 = M0.not(M0.procedure_p(wrap_proc1188));if (or_part1193!==false) {var if_res663 = or_part1193;} else {var if_res663 = bad_props_p(props1189);}var if_res664 = if_res663;}if (if_res664!==false) {var if_res731 = M0.apply(chaperone_procedure1185,proc1187,wrap_proc1188,props1189);} else {chaperone_arity_match_checking(self_arg_p1184,name1186,proc1187,wrap_proc1188,props1189);var loop1195 = function(props1196) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1196)!==false) {var if_res666 = false;} else {if (M0.eq_p(M0.car(props1196),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res665 = M0.cadr(props1196);} else {var if_res665 = loop1195(M0.cddr(props1196));}var if_res666 = if_res665;}return if_res666;};var mark_prop1194 = loop1195(props1189);var chaperone_procedure_by_add_mark1197 = function(proc1198, wrap_proc1199) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1194!==false) {var if_res667 = chaperone_procedure1185(proc1198,wrap_proc1199,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1194);} else {var if_res667 = chaperone_procedure1185(proc1198,wrap_proc1199);}return if_res667;};var p1201 = keyword_procedure_proc(n_wrap_proc1191);if (self_arg_p1184!==false) {var cl668 = $rjs_core.attachProcedureArity(function(self_proc1202, kws1203, args1204, ...rest1205673) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1205 = $rjs_core.Pair.listFromArray(rest1205673);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1201,kws1203,args1204,self_proc1202,rest1205);},$rjs_core.attachProcedureArity(function(...results1206674) {var results1206 = $rjs_core.Pair.listFromArray(results1206674);var len1207 = M0.length(results1206);var alen1208 = M0.length(rest1205);if (M0.__lt_(len1207,alen1208+1)!==false) {var if_res675 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1208+1,$rjs_core.UString.make("received number of results"),len1207,$rjs_core.UString.make("wrapper procedure"),wrap_proc1188);} else {var if_res675 = M0.rvoid();}if_res675;var num_extra1209 = len1207-(alen1208+1);var new_args1210 = M0.list_ref(results1206,num_extra1209);if (M0.list_p(new_args1210)!==false) {var if_res676 = M0.__eq_(M0.length(new_args1210),M0.length(args1204));} else {var if_res676 = false;}if (if_res676!==false) {var if_res680 = M0.rvoid();} else {var temp679 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp678 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1207,alen1208)!==false) {var if_res677 = $rjs_core.UString.make("");} else {var if_res677 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res680 = M0.raise_arguments_error(temp679,M0.format(temp678,if_res677),$rjs_core.UString.make("first result"),new_args1210,$rjs_core.UString.make("wrapper procedure"),wrap_proc1188);}if_res680;M0.for_each(function(kw1211, new_arg1212, arg1213) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1183!==false) {var if_res682 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1212,arg1213)!==false) {var if_res681 = M0.rvoid();} else {var if_res681 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1211),$rjs_core.UString.make("result"),new_arg1212,$rjs_core.UString.make("wrapper procedure"),wrap_proc1188);}var if_res682 = if_res681;}return if_res682;},kws1203,new_args1210,args1204);var tmp1214 = num_extra1209;if (M0.equal_p(tmp1214,0)!==false) {var if_res685 = M0.apply(M0.values,kws1203,results1206);} else {if (M0.equal_p(tmp1214,1)!==false) {var if_res684 = M0.apply(M0.values,M0.car(results1206),kws1203,M0.cdr(results1206));} else {var loop1215 = function(results1216, c1217) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1217)!==false) {var if_res683 = M0.cons(kws1203,results1216);} else {var if_res683 = M0.cons(M0.car(results1216),loop1215(M0.cdr(results1216),M0.sub1(c1217)));}return if_res683;};var if_res684 = M0.apply(M0.values,loop1215(results1206,num_extra1209));}var if_res685 = if_res684;}return if_res685;}));});var cl669 = $rjs_core.attachProcedureArity(function(...other1218686) {var other1218 = $rjs_core.Pair.listFromArray(other1218686);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res706 = $rjs_core.attachProcedureArity(function() {var fixed_lam670 = {}[arguments.length];if (fixed_lam670!==undefined) {return fixed_lam670.apply(null,arguments);} else {if (M0.__gt__eq_(cl668.length,1)!==false) {var if_res672 = cl668.apply(null,arguments);} else {if (true!==false) {var if_res671 = cl669.apply(null,arguments);} else {var if_res671 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res672 = if_res671;}return if_res672;}},[M0.make_arity_at_least(0)]);} else {var cl687 = $rjs_core.attachProcedureArity(function(kws1219, args1220, ...rest1221692) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1221 = $rjs_core.Pair.listFromArray(rest1221692);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1201,kws1219,args1220,rest1221);},$rjs_core.attachProcedureArity(function(...results1222693) {var results1222 = $rjs_core.Pair.listFromArray(results1222693);var len1223 = M0.length(results1222);var alen1224 = M0.length(rest1221);if (M0.__lt_(len1223,alen1224+1)!==false) {var if_res694 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1224+1,$rjs_core.UString.make("received number of results"),len1223,$rjs_core.UString.make("wrapper procedure"),wrap_proc1188);} else {var if_res694 = M0.rvoid();}if_res694;var num_extra1225 = len1223-(alen1224+1);var new_args1226 = M0.list_ref(results1222,num_extra1225);if (M0.list_p(new_args1226)!==false) {var if_res695 = M0.__eq_(M0.length(new_args1226),M0.length(args1220));} else {var if_res695 = false;}if (if_res695!==false) {var if_res699 = M0.rvoid();} else {var temp698 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp697 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1223,alen1224)!==false) {var if_res696 = $rjs_core.UString.make("");} else {var if_res696 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res699 = M0.raise_arguments_error(temp698,M0.format(temp697,if_res696),$rjs_core.UString.make("first result"),new_args1226,$rjs_core.UString.make("wrapper procedure"),wrap_proc1188);}if_res699;M0.for_each(function(kw1227, new_arg1228, arg1229) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1183!==false) {var if_res701 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1228,arg1229)!==false) {var if_res700 = M0.rvoid();} else {var if_res700 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1227),$rjs_core.UString.make("result"),new_arg1228,$rjs_core.UString.make("wrapper procedure"),wrap_proc1188);}var if_res701 = if_res700;}return if_res701;},kws1219,new_args1226,args1220);var tmp1230 = num_extra1225;if (M0.equal_p(tmp1230,0)!==false) {var if_res704 = M0.apply(M0.values,kws1219,results1222);} else {if (M0.equal_p(tmp1230,1)!==false) {var if_res703 = M0.apply(M0.values,M0.car(results1222),kws1219,M0.cdr(results1222));} else {var loop1231 = function(results1232, c1233) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1233)!==false) {var if_res702 = M0.cons(kws1219,results1232);} else {var if_res702 = M0.cons(M0.car(results1232),loop1231(M0.cdr(results1232),M0.sub1(c1233)));}return if_res702;};var if_res703 = M0.apply(M0.values,loop1231(results1222,num_extra1225));}var if_res704 = if_res703;}return if_res704;}));});var cl688 = $rjs_core.attachProcedureArity(function(...other1234705) {var other1234 = $rjs_core.Pair.listFromArray(other1234705);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res706 = $rjs_core.attachProcedureArity(function() {var fixed_lam689 = {}[arguments.length];if (fixed_lam689!==undefined) {return fixed_lam689.apply(null,arguments);} else {if (M0.__gt__eq_(cl687.length,1)!==false) {var if_res691 = cl687.apply(null,arguments);} else {if (true!==false) {var if_res690 = cl688.apply(null,arguments);} else {var if_res690 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res691 = if_res690;}return if_res691;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1200 = if_res706;var wrap1237 = function(proc1238, n_proc1239) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1239,proc1238))!==false) {var if_res707 = new_procedure_p(proc1238);} else {var if_res707 = false;}if (if_res707!==false) {var v1240 = new_procedure_ref(proc1238);if (M0.exact_integer_p(v1240)!==false) {var acc1241 = procedure_accessor_ref(proc1238);var if_res723 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1238,acc1241,function(self1242, sub_proc1243) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result708 = wrap1237(sub_proc1243,normalize_proc(sub_proc1243));var f1244 = let_result708.getAt(0);var acc1245 = let_result708.getAt(1);return f1244;}),acc1241);} else {if (is_impersonator_p1183!==false) {var if_res722 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res722 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1239)!==false) {var if_res721 = chaperone_procedure_by_add_mark1197(proc1238,wrap_proc1188);} else {var if_res721 = proc1238;}var new_kw_proc1246 = if_res722(if_res721,new_procedure_ref,function(self1247, proc1248) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1183!==false) {var if_res720 = new_impersonate_procedure;} else {var if_res720 = new_chaperone_procedure;}if (self_arg_p1184!==false) {var if_res719 = $rjs_core.attachProcedureArity(function(proc_self1249, kws1250, kw_args1251, self1252, ...args1253709) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1253 = $rjs_core.Pair.listFromArray(args1253709);var len1254 = M0.length(args1253);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1200,proc_self1249,kws1250,kw_args1251,args1253);},$rjs_core.attachProcedureArity(function(...results1255710) {var results1255 = $rjs_core.Pair.listFromArray(results1255710);var r_len1256 = M0.length(results1255);var list_take1257 = function(l1258, n1259) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1259)!==false) {var if_res711 = M0.rnull;} else {var if_res711 = M0.cons(M0.car(l1258),list_take1257(M0.cdr(l1258),M0.sub1(n1259)));}return if_res711;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res712 = M0.__eq_(r_len1256,2+len1254);} else {var if_res712 = false;}if (if_res712!==false) {var if_res713 = M0.apply(M0.values,M0.cadr(results1255),self1252,M0.cddr(results1255));} else {var skip1260 = r_len1256-len1254;var if_res713 = M0.apply(M0.values,M0.append(list_take1257(results1255,skip1260-2),M0.list(M0.list_ref(results1255,M0.sub1(skip1260)),self1252),M0.__rjs_quoted__.list_tail(results1255,skip1260)));}return if_res713;}));});} else {var if_res719 = $rjs_core.attachProcedureArity(function(kws1261, kw_args1262, self1263, ...args1264714) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1264 = $rjs_core.Pair.listFromArray(args1264714);var len1265 = M0.length(args1264);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1200,kws1261,kw_args1262,args1264);},$rjs_core.attachProcedureArity(function(...results1266715) {var results1266 = $rjs_core.Pair.listFromArray(results1266715);var r_len1267 = M0.length(results1266);var list_take1268 = function(l1269, n1270) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1270)!==false) {var if_res716 = M0.rnull;} else {var if_res716 = M0.cons(M0.car(l1269),list_take1268(M0.cdr(l1269),M0.sub1(n1270)));}return if_res716;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res717 = M0.__eq_(r_len1267,2+len1265);} else {var if_res717 = false;}if (if_res717!==false) {var if_res718 = M0.apply(M0.values,M0.cadr(results1266),self1263,M0.cddr(results1266));} else {var skip1271 = r_len1267-len1265;var if_res718 = M0.apply(M0.values,M0.append(list_take1268(results1266,skip1271-2),M0.list(M0.list_ref(results1266,M0.sub1(skip1271)),self1263),M0.__rjs_quoted__.list_tail(results1266,skip1271)));}return if_res718;}));});}return if_res720(proc1248,make_keyword_procedure(if_res719));});var if_res723 = M0.values(new_kw_proc1246,new_procedure_ref);}var if_res728 = if_res723;} else {if (okp_p(n_proc1239)!==false) {if (is_impersonator_p1183!==false) {if (okm_p(n_proc1239)!==false) {var if_res724 = make_optional_keyword_method_impersonator;} else {var if_res724 = make_optional_keyword_procedure_impersonator;}var if_res725 = if_res724(keyword_procedure_checker(n_proc1239),chaperone_procedure_by_add_mark1197(keyword_procedure_proc(n_proc1239),kw_chaperone1200),keyword_procedure_required(n_proc1239),keyword_procedure_allowed(n_proc1239),chaperone_procedure_by_add_mark1197(okp_ref(n_proc1239,0),okp_ref(n_wrap_proc1191,0)),n_proc1239);} else {var if_res725 = M0.__rjs_quoted__.chaperone_struct(proc1238,keyword_procedure_proc,function(self1272, proc1273) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1197(proc1273,kw_chaperone1200);},M0.make_struct_field_accessor(okp_ref,0),function(self1274, proc1275) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1197(proc1275,okp_ref(n_wrap_proc1191,0));});}var if_res727 = M0.values(if_res725,keyword_procedure_proc);} else {if (is_impersonator_p1183!==false) {var name_plus_fail1276 = keyword_procedure_name_plus_fail(n_proc1239);var mk1277 = make_required(M0.car(name_plus_fail1276),M0.cdr(name_plus_fail1276),keyword_method_p(n_proc1239),true);var if_res726 = mk1277(keyword_procedure_checker(n_proc1239),chaperone_procedure_by_add_mark1197(keyword_procedure_proc(n_proc1239),kw_chaperone1200),keyword_procedure_required(n_proc1239),keyword_procedure_allowed(n_proc1239),n_proc1239);} else {var if_res726 = M0.__rjs_quoted__.chaperone_struct(n_proc1239,keyword_procedure_proc,function(self1278, proc1279) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1197(proc1279,kw_chaperone1200);});}var if_res727 = M0.values(if_res726,keyword_procedure_proc);}var if_res728 = if_res727;}return if_res728;};var let_result729 = wrap1237(proc1187,n_proc1190);var new_proc1235 = let_result729.getAt(0);var chap_accessor1236 = let_result729.getAt(1);if (M0.null_p(props1189)!==false) {var if_res730 = new_proc1235;} else {var if_res730 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1235,chap_accessor1236,false,props1189);}var if_res731 = if_res730;}return if_res731;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1280, name1281, proc1282, wrap_proc1283, props1284) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1285 = normalize_proc(proc1282);var n_wrap_proc1286 = normalize_proc(wrap_proc1283);var or_part1287 = M0.not(keyword_procedure_p(n_proc1285));if (or_part1287!==false) {var if_res733 = or_part1287;} else {var or_part1288 = M0.not(M0.procedure_p(wrap_proc1283));if (or_part1288!==false) {var if_res732 = or_part1288;} else {var if_res732 = bad_props_p(props1284);}var if_res733 = if_res732;}if (if_res733!==false) {var if_res734 = M0.apply(unsafe_chaperone_procedure1280,proc1282,wrap_proc1283,props1284);} else {chaperone_arity_match_checking(false,name1281,proc1282,wrap_proc1283,props1284);var if_res734 = M0.apply(unsafe_chaperone_procedure1280,proc1282,wrap_proc1283,props1284);}return if_res734;};var bad_props_p = function(props1289) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1290 = function(props1291) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1291)!==false) {var if_res737 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1291))!==false) {var props1292 = M0.cdr(props1291);var or_part1293 = M0.null_p(props1292);if (or_part1293!==false) {var if_res735 = or_part1293;} else {var if_res735 = loop1290(M0.cdr(props1292));}var if_res736 = if_res735;} else {var if_res736 = true;}var if_res737 = if_res736;}return if_res737;};return loop1290(props1289);};var chaperone_arity_match_checking = function(self_arg_p1294, name1295, proc1296, wrap_proc1297, props1298) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1299 = M0.procedure_arity(proc1296);var b1300 = M0.procedure_arity(wrap_proc1297);if (self_arg_p1294!==false) {var if_res738 = 1;} else {var if_res738 = 0;}var d1301 = if_res738;var let_result739 = procedure_keywords(proc1296);var a_req1302 = let_result739.getAt(0);var a_allow1303 = let_result739.getAt(1);var let_result740 = procedure_keywords(wrap_proc1297);var b_req1304 = let_result740.getAt(0);var b_allow1305 = let_result740.getAt(1);var includes_p1306 = function(a1307, b1308) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1308)!==false) {if (M0.number_p(a1307)!==false) {var if_res742 = M0.__eq_(b1308,a1307+d1301);} else {if (M0.arity_at_least_p(a1307)!==false) {var if_res741 = M0.__gt__eq_(b1308,M0.arity_at_least_value(a1307)+d1301);} else {var if_res741 = M0.ormap(function(a1309) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1306(a1309,b1308);},a1307);}var if_res742 = if_res741;}var if_res746 = if_res742;} else {if (M0.arity_at_least_p(b1308)!==false) {if (M0.number_p(a1307)!==false) {var if_res744 = false;} else {if (M0.arity_at_least_p(a1307)!==false) {var if_res743 = M0.__gt__eq_(M0.arity_at_least_value(b1308),M0.arity_at_least_value(a1307)+d1301);} else {var if_res743 = M0.ormap(function(a1310) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1306(b1308,a1310);},a1307);}var if_res744 = if_res743;}var if_res745 = if_res744;} else {var if_res745 = M0.andmap(function(b1311) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1306(a1307,b1311);},b1308);}var if_res746 = if_res745;}return if_res746;};if (includes_p1306(b1300,a1299)!==false) {var if_res747 = M0.rvoid();} else {var if_res747 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1296,wrap_proc1297,props1298);}if_res747;if (subset_p(b_req1304,a_req1302)!==false) {var if_res748 = M0.rvoid();} else {var if_res748 = M0.raise_arguments_error(name1295,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1297,$rjs_core.UString.make("original procedure"),proc1296);}if_res748;var or_part1312 = M0.not(b_allow1305);if (or_part1312!==false) {var if_res750 = or_part1312;} else {if (a_allow1303!==false) {var if_res749 = subset_p(a_allow1303,b_allow1305);} else {var if_res749 = false;}var if_res750 = if_res749;}if (if_res750!==false) {var if_res751 = M0.rvoid();} else {var if_res751 = M0.raise_arguments_error(name1295,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1297,$rjs_core.UString.make("original procedure"),proc1296);}if_res751;return M0.rvoid();};var normalize_proc = function(proc1313) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1313)!==false) {var if_res759 = proc1313;} else {if (new_procedure_p(proc1313)!==false) {var let_result752 = procedure_keywords(proc1313);var req_kws1314 = let_result752.getAt(0);var allowed_kws1315 = let_result752.getAt(1);if (M0.null_p(allowed_kws1315)!==false) {var if_res757 = proc1313;} else {var if_res757 = make_optional_keyword_procedure(function(given_kws1316, given_argc1317) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1313,given_argc1317-2,true)!==false) {var or_part1318 = M0.not(allowed_kws1315);if (or_part1318!==false) {var if_res754 = or_part1318;} else {var if_res754 = subset_p(given_kws1316,allowed_kws1315);}if (if_res754!==false) {var if_res755 = subset_p(req_kws1314,given_kws1316);} else {var if_res755 = false;}var if_res756 = if_res755;} else {var if_res756 = false;}return if_res756;},$rjs_core.attachProcedureArity(function(kws1319, kw_args1320, ...vals1321753) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1321 = $rjs_core.Pair.listFromArray(vals1321753);return keyword_apply(proc1313,kws1319,kw_args1320,vals1321);}),req_kws1314,allowed_kws1315,proc1313);}var if_res758 = if_res757;} else {var if_res758 = proc1313;}var if_res759 = if_res758;}return if_res759;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };