import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result466 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result466.getAt(0);var keyword_impersonator_p = let_result466.getAt(1);var keyword_impersonator_ref = let_result466.getAt(2);var keyword_procedure_impersonator_of = function(v966) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v966)!==false) {var if_res467 = keyword_impersonator_ref(v966)(v966);} else {var if_res467 = false;}return if_res467;};var let_result468 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result468.getAt(0);var mk_kw_proc = let_result468.getAt(1);var keyword_procedure_p = let_result468.getAt(2);var keyword_procedure_ref = let_result468.getAt(3);var keyword_procedure_set_bang_ = let_result468.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result469 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result469.getAt(0);var make_km = let_result469.getAt(1);var keyword_method_p = let_result469.getAt(2);var km_ref = let_result469.getAt(3);var km_set_bang_ = let_result469.getAt(4);var generate_arity_string = function(proc967) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result470 = procedure_keywords(proc967);var req968 = let_result470.getAt(0);var allowed969 = let_result470.getAt(1);var a970 = M0.procedure_arity(proc967);var keywords_desc971 = function(opt973, req974) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp476 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req974))!==false) {var if_res475 = M0.format($rjs_core.UString.make("an ~aargument"),opt973);} else {var if_res475 = M0.format($rjs_core.UString.make("~aarguments"),opt973);}if (M0.null_p(M0.cdr(req974))!==false) {var if_res474 = $rjs_core.UString.make("");} else {var if_res474 = $rjs_core.UString.make("s");}var tmp975 = M0.length(req974);if (M0.equal_p(tmp975,1)!==false) {var if_res473 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req974));} else {if (M0.equal_p(tmp975,2)!==false) {var if_res472 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req974),M0.cadr(req974));} else {var loop976 = function(req977) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req977))!==false) {var if_res471 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req977));} else {var if_res471 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req977),loop976(M0.cdr(req977)));}return if_res471;};var if_res472 = loop976(req974);}var if_res473 = if_res472;}return M0.format(temp476,if_res475,if_res474,if_res473);};var method_adjust972 = function(a978) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part979 = okm_p(proc967);if (or_part979!==false) {var if_res477 = or_part979;} else {var if_res477 = keyword_method_p(proc967);}if (if_res477!==false) {if (M0.zero_p(a978)!==false) {var if_res478 = 0;} else {var if_res478 = M0.sub1(a978);}var if_res479 = if_res478;} else {var if_res479 = a978;}return if_res479;};if (M0.number_p(a970)!==false) {var a980 = method_adjust972(a970);var if_res486 = M0.format($rjs_core.UString.make("~a"),a980);} else {if (M0.arity_at_least_p(a970)!==false) {var a981 = method_adjust972(M0.arity_at_least_value(a970));var if_res485 = M0.format($rjs_core.UString.make("at least ~a"),a981);} else {var if_res485 = $rjs_core.UString.make("a different number");}var if_res486 = if_res485;}if (M0.null_p(req968)!==false) {var if_res484 = $rjs_core.UString.make("");} else {var if_res484 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc971($rjs_core.UString.make(""),req968));}if (allowed969!==false) {var loop983 = function(req984, allowed985) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req984)!==false) {var if_res481 = allowed985;} else {if (M0.eq_p(M0.car(req984),M0.car(allowed985))!==false) {var if_res480 = loop983(M0.cdr(req984),M0.cdr(allowed985));} else {var if_res480 = M0.cons(M0.car(allowed985),loop983(req984,M0.cdr(allowed985)));}var if_res481 = if_res480;}return if_res481;};var others982 = loop983(req968,allowed969);if (M0.null_p(others982)!==false) {var if_res482 = $rjs_core.UString.make("");} else {var if_res482 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc971($rjs_core.UString.make("optional "),others982));}var if_res483 = if_res482;} else {var if_res483 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res486,if_res484,if_res483);};var let_result487 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result487.getAt(0);var make_optional_keyword_procedure = let_result487.getAt(1);var okp_p = let_result487.getAt(2);var okp_ref = let_result487.getAt(3);var okp_set_bang_ = let_result487.getAt(4);var let_result488 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result488.getAt(0);var make_optional_keyword_method = let_result488.getAt(1);var okm_p = let_result488.getAt(2);var okm_ref = let_result488.getAt(3);var okm_set_bang_ = let_result488.getAt(4);var let_result489 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result489.getAt(0);var named_keyword_procedure_p = let_result489.getAt(1);var keyword_procedure_name_plus_fail = let_result489.getAt(2);var let_result491 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v986, info_l987) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v986)!==false) {var if_res490 = M0.make_struct_field_accessor(M0.list_ref(info_l987,3),v986);} else {var if_res490 = false;}return if_res490;});var prop_procedure_accessor = let_result491.getAt(0);var procedure_accessor_p = let_result491.getAt(1);var procedure_accessor_ref = let_result491.getAt(2);var let_result492 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result492.getAt(0);var new_procedure_p = let_result492.getAt(1);var new_procedure_ref = let_result492.getAt(2);var let_result493 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v988) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v988,0);})));var struct_keyword_procedure_impersonator = let_result493.getAt(0);var make_kpp = let_result493.getAt(1);var keyword_procedure_impersonator_p = let_result493.getAt(2);var kpp_ref = let_result493.getAt(3);var kpp_set_bang_ = let_result493.getAt(4);var let_result494 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v989) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v989,0);})));var struct_keyword_method_impersonator = let_result494.getAt(0);var make_kmp = let_result494.getAt(1);var keyword_method_impersonator_p = let_result494.getAt(2);var kmp_ref = let_result494.getAt(3);var kmp_set_bang_ = let_result494.getAt(4);var let_result495 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v990) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v990,0);})));var struct_okpp = let_result495.getAt(0);var make_optional_keyword_procedure_impersonator = let_result495.getAt(1);var okpp_p = let_result495.getAt(2);var okpp_ref = let_result495.getAt(3);var okpp_set_bang_ = let_result495.getAt(4);var let_result496 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v991) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v991,0);})));var struct_okmp = let_result496.getAt(0);var make_optional_keyword_method_impersonator = let_result496.getAt(1);var okmp_p = let_result496.getAt(2);var okmp_ref = let_result496.getAt(3);var okmp_set_bang_ = let_result496.getAt(4);var let_result497 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result497.getAt(0);var make_kp_by_ae = let_result497.getAt(1);var kp_by_ae_p = let_result497.getAt(2);var kp_by_ae_ref = let_result497.getAt(3);var kp_by_ae_set_bang_ = let_result497.getAt(4);var let_result498 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result498.getAt(0);var make_km_by_ae = let_result498.getAt(1);var km_by_ae_p = let_result498.getAt(2);var km_by_ae_ref = let_result498.getAt(3);var km_by_ae_set_bang_ = let_result498.getAt(4);var let_result499 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result499.getAt(0);var make_kpi_by_ae = let_result499.getAt(1);var kpi_by_ae_p = let_result499.getAt(2);var kpi_by_ae_ref = let_result499.getAt(3);var kpi_by_ae_set_bang_ = let_result499.getAt(4);var let_result500 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result500.getAt(0);var make_kmi_by_ae = let_result500.getAt(1);var kmi_by_ae_p = let_result500.getAt(2);var kmi_by_ae_ref = let_result500.getAt(3);var kmi_by_ae_set_bang_ = let_result500.getAt(4);var make_required = function(name992, fail_proc993, method_p994, impersonator_p995) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1001 = name992;if (or_part1001!==false) {var if_res504 = or_part1001;} else {var if_res504 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p995!==false) {if (method_p994!==false) {var if_res501 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res501 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res503 = if_res501;} else {if (method_p994!==false) {var if_res502 = struct_keyword_method_by_arity_error;} else {var if_res502 = struct_keyword_procedure_by_arity_error;}var if_res503 = if_res502;}var let_result505 = M0.make_struct_type(if_res504,if_res503,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name992,fail_proc993))),M0.current_inspector(),fail_proc993);var s_996 = let_result505.getAt(0);var mk997 = let_result505.getAt(1);var __p998 = let_result505.getAt(2);var __ref999 = let_result505.getAt(3);var __set_bang_1000 = let_result505.getAt(4);return mk997;};var cl506 = function(proc1002) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name1003 = M0.object_name(proc1002);var plain_proc1004 = $rjs_core.attachProcedureArity(function(...args1005509) {var args1005 = $rjs_core.Pair.listFromArray(args1005509);return M0.apply(proc1002,M0.rnull,M0.rnull,args1005);});if (M0.symbol_p(proc_name1003)!==false) {var if_res510 = M0.__rjs_quoted__.procedure_rename(plain_proc1004,proc_name1003);} else {var if_res510 = plain_proc1004;}return make_keyword_procedure(proc1002,if_res510);};var cl507 = function(proc1006, plain_proc1007) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1006)!==false) {var if_res511 = M0.procedure_arity_mask(proc1006);} else {var if_res511 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res511),proc1006,M0.rnull,false,plain_proc1007);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam508 = {'1':cl506,'2':cl507}[arguments.length];if (fixed_lam508!==undefined) {return fixed_lam508.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1008, kws1009, kw_vals1010, normal_args1011, ...normal_argss1012512) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1012 = $rjs_core.Pair.listFromArray(normal_argss1012512);var type_error1013 = function(what1014, which1015) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1014,which1015,proc1008,kws1009,kw_vals1010,normal_args1011,normal_argss1012);};if (M0.procedure_p(proc1008)!==false) {var if_res513 = M0.rvoid();} else {var if_res513 = type_error1013($rjs_core.UString.make("procedure?"),0);}if_res513;var loop1016 = function(ks1017) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1017)!==false) {var if_res520 = M0.rvoid();} else {var or_part1018 = M0.not(M0.pair_p(ks1017));if (or_part1018!==false) {var if_res514 = or_part1018;} else {var if_res514 = M0.not(M0.keyword_p(M0.car(ks1017)));}if (if_res514!==false) {var if_res519 = type_error1013($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1017))!==false) {var if_res518 = M0.rvoid();} else {var or_part1019 = M0.not(M0.pair_p(M0.cdr(ks1017)));if (or_part1019!==false) {var if_res515 = or_part1019;} else {var if_res515 = M0.not(M0.keyword_p(M0.cadr(ks1017)));}if (if_res515!==false) {var if_res517 = loop1016(M0.cdr(ks1017));} else {if (M0.keyword_lt__p(M0.car(ks1017),M0.cadr(ks1017))!==false) {var if_res516 = loop1016(M0.cdr(ks1017));} else {var if_res516 = type_error1013($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res517 = if_res516;}var if_res518 = if_res517;}var if_res519 = if_res518;}var if_res520 = if_res519;}return if_res520;};loop1016(kws1009);if (M0.list_p(kw_vals1010)!==false) {var if_res521 = M0.rvoid();} else {var if_res521 = type_error1013($rjs_core.UString.make("list?"),2);}if_res521;if (M0.__eq_(M0.length(kws1009),M0.length(kw_vals1010))!==false) {var if_res522 = M0.rvoid();} else {var if_res522 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1009),$rjs_core.UString.make("value list length"),M0.length(kw_vals1010),$rjs_core.UString.make("keyword list"),kws1009,$rjs_core.UString.make("value list"),kw_vals1010);}if_res522;var loop1021 = function(normal_argss1022, pos1023) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1022))!==false) {var l1024 = M0.car(normal_argss1022);if (M0.list_p(l1024)!==false) {var if_res523 = l1024;} else {var if_res523 = type_error1013($rjs_core.UString.make("list?"),pos1023);}var if_res524 = if_res523;} else {var if_res524 = M0.cons(M0.car(normal_argss1022),loop1021(M0.cdr(normal_argss1022),M0.add1(pos1023)));}return if_res524;};var normal_args1020 = loop1021(M0.cons(normal_args1011,normal_argss1012),3);if (M0.null_p(kws1009)!==false) {var if_res525 = M0.apply(proc1008,normal_args1020);} else {var if_res525 = M0.apply(keyword_procedure_extract_by_method(kws1009,2+M0.length(normal_args1020),proc1008,0),kws1009,kw_vals1010,normal_args1020);}return if_res525;});var procedure_keywords = function(p1025) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1025)!==false) {var if_res530 = M0.values(keyword_procedure_required(p1025),keyword_procedure_allowed(p1025));} else {if (M0.procedure_p(p1025)!==false) {if (new_procedure_p(p1025)!==false) {var v1026 = new_procedure_ref(p1025);if (M0.procedure_p(v1026)!==false) {var if_res527 = procedure_keywords(v1026);} else {var a1027 = procedure_accessor_ref(p1025);if (a1027!==false) {var if_res526 = procedure_keywords(a1027(p1025));} else {var if_res526 = M0.values(M0.rnull,M0.rnull);}var if_res527 = if_res526;}var if_res528 = if_res527;} else {var if_res528 = M0.values(M0.rnull,M0.rnull);}var if_res529 = if_res528;} else {var if_res529 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1025);}var if_res530 = if_res529;}return if_res530;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1028, ...args1029531) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1029 = $rjs_core.Pair.listFromArray(args1029531);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1028,0),M0.rnull,M0.rnull,args1029);});var check_kw_args = function(p1030, kws1031) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1032 = function(kws1033, required1034, allowed1035) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1033)!==false) {if (M0.null_p(required1034)!==false) {var if_res532 = M0.values(false,false);} else {var if_res532 = M0.values(M0.car(required1034),false);}var if_res541 = if_res532;} else {if (M0.pair_p(required1034)!==false) {var if_res533 = M0.eq_p(M0.car(required1034),M0.car(kws1033));} else {var if_res533 = false;}if (if_res533!==false) {var temp536 = M0.cdr(kws1033);var temp535 = M0.cdr(required1034);if (allowed1035!==false) {var if_res534 = M0.cdr(allowed1035);} else {var if_res534 = false;}var if_res540 = loop1032(temp536,temp535,if_res534);} else {if (M0.not(allowed1035)!==false) {var if_res539 = loop1032(M0.cdr(kws1033),required1034,false);} else {if (M0.pair_p(allowed1035)!==false) {if (M0.eq_p(M0.car(allowed1035),M0.car(kws1033))!==false) {var if_res537 = loop1032(M0.cdr(kws1033),required1034,M0.cdr(allowed1035));} else {var if_res537 = loop1032(kws1033,required1034,M0.cdr(allowed1035));}var if_res538 = if_res537;} else {var if_res538 = M0.values(false,M0.car(kws1033));}var if_res539 = if_res538;}var if_res540 = if_res539;}var if_res541 = if_res540;}return if_res541;};return loop1032(kws1031,keyword_procedure_required(p1030),keyword_procedure_allowed(p1030));};var make_keyword_checker = function(req_kws1036, allowed_kws1037, arity_mask1038) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1037)!==false) {if (M0.null_p(req_kws1036)!==false) {var if_res544 = function(kws1039, a1040) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res542 = M0.bitwise_bit_set_p(arity_mask1038,a1040);} else {var if_res542 = false;}return if_res542;};} else {var if_res544 = function(kws1041, a1042) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1036,kws1041)!==false) {var if_res543 = M0.bitwise_bit_set_p(arity_mask1038,a1042);} else {var if_res543 = false;}return if_res543;};}var if_res557 = if_res544;} else {if (M0.null_p(allowed_kws1037)!==false) {var if_res556 = function(kws1043, a1044) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1043)!==false) {var if_res545 = M0.bitwise_bit_set_p(arity_mask1038,a1044);} else {var if_res545 = false;}return if_res545;};} else {if (M0.null_p(req_kws1036)!==false) {var if_res555 = function(kws1045, a1046) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1045,allowed_kws1037)!==false) {var if_res546 = M0.bitwise_bit_set_p(arity_mask1038,a1046);} else {var if_res546 = false;}return if_res546;};} else {if (M0.list_p(req_kws1036)!==false) {if (M0.list_p(allowed_kws1037)!==false) {var if_res547 = M0.eq_p(M0.length(req_kws1036),M0.length(allowed_kws1037));} else {var if_res547 = false;}var if_res548 = if_res547;} else {var if_res548 = false;}if (if_res548!==false) {var if_res554 = function(kws1047, a1048) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1049 = function(kws1050, req_kws1051) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1051)!==false) {var if_res551 = M0.null_p(kws1050);} else {if (M0.null_p(kws1050)!==false) {var if_res550 = false;} else {if (M0.eq_p(M0.car(kws1050),M0.car(req_kws1051))!==false) {var if_res549 = loop1049(M0.cdr(kws1050),M0.cdr(req_kws1051));} else {var if_res549 = false;}var if_res550 = if_res549;}var if_res551 = if_res550;}return if_res551;};if (loop1049(kws1047,req_kws1036)!==false) {var if_res552 = M0.bitwise_bit_set_p(arity_mask1038,a1048);} else {var if_res552 = false;}return if_res552;};} else {var if_res554 = function(kws1052, a1053) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1036,kws1052,allowed_kws1037)!==false) {var if_res553 = M0.bitwise_bit_set_p(arity_mask1038,a1053);} else {var if_res553 = false;}return if_res553;};}var if_res555 = if_res554;}var if_res556 = if_res555;}var if_res557 = if_res556;}return if_res557;};var subset_p = function(l11054, l21055) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11054)!==false) {var if_res560 = true;} else {if (M0.null_p(l21055)!==false) {var if_res559 = false;} else {if (M0.eq_p(M0.car(l11054),M0.car(l21055))!==false) {var if_res558 = subset_p(M0.cdr(l11054),M0.cdr(l21055));} else {var if_res558 = subset_p(l11054,M0.cdr(l21055));}var if_res559 = if_res558;}var if_res560 = if_res559;}return if_res560;};var subsets_p = function(l11056, l21057, l31058) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11056)!==false) {var if_res565 = subset_p(l21057,l31058);} else {if (M0.null_p(l21057)!==false) {var if_res564 = false;} else {if (M0.null_p(l31058)!==false) {var if_res563 = false;} else {var v21059 = M0.car(l21057);if (M0.eq_p(M0.car(l11056),v21059)!==false) {var if_res562 = subsets_p(M0.cdr(l11056),M0.cdr(l21057),M0.cdr(l31058));} else {if (M0.eq_p(v21059,M0.car(l31058))!==false) {var if_res561 = subsets_p(l11056,M0.cdr(l21057),M0.cdr(l31058));} else {var if_res561 = subsets_p(l11056,l21057,M0.cdr(l31058));}var if_res562 = if_res561;}var if_res563 = if_res562;}var if_res564 = if_res563;}var if_res565 = if_res564;}return if_res565;};var keyword_procedure_extract_by_method = function(kws1060, n1061, p1062, method_n1063) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1062)!==false) {var if_res566 = keyword_procedure_checker(p1062)(kws1060,n1061);} else {var if_res566 = false;}if (if_res566!==false) {var if_res596 = keyword_procedure_proc(p1062);} else {if (M0.not(keyword_procedure_p(p1062))!==false) {if (M0.procedure_p(p1062)!==false) {if (new_procedure_p(p1062)!==false) {var a1066 = procedure_accessor_ref(p1062);if (a1066!==false) {var if_res567 = a1066(p1062);} else {var if_res567 = false;}var if_res568 = if_res567;} else {var if_res568 = false;}var or_part1065 = if_res568;if (or_part1065!==false) {var if_res571 = or_part1065;} else {var or_part1067 = M0.procedure_extract_target(p1062);if (or_part1067!==false) {var if_res570 = or_part1067;} else {if (new_procedure_p(p1062)!==false) {var if_res569 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res569 = false;}var if_res570 = if_res569;}var if_res571 = if_res570;}var if_res572 = if_res571;} else {var if_res572 = false;}var if_res573 = if_res572;} else {var if_res573 = false;}var p21064 = if_res573;if (p21064!==false) {if (M0.eq_p(p21064,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31068 = keyword_procedure_extract_by_method(kws1060,M0.add1(n1061),new_procedure_ref(p1062),M0.add1(method_n1063));var if_res575 = $rjs_core.attachProcedureArity(function(kws1069, kw_args1070, ...args1071574) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1071 = $rjs_core.Pair.listFromArray(args1071574);return M0.apply(p31068,kws1069,kw_args1070,M0.cons(p1062,args1071));});} else {var if_res575 = keyword_procedure_extract_by_method(kws1060,n1061,p21064,method_n1063);}var if_res595 = if_res575;} else {var if_res595 = $rjs_core.attachProcedureArity(function(kws1072, kw_args1073, ...args1074576) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1074 = $rjs_core.Pair.listFromArray(args1074576);if (keyword_procedure_p(p1062)!==false) {var if_res577 = check_kw_args(p1062,kws1072);} else {var if_res577 = M0.values(false,M0.car(kws1072));}var let_result578 = if_res577;var missing_kw1075 = let_result578.getAt(0);var extra_kw1076 = let_result578.getAt(1);var or_part1081 = keyword_method_p(p1062);if (or_part1081!==false) {var if_res579 = or_part1081;} else {var if_res579 = okm_p(p1062);}if (if_res579!==false) {var if_res580 = 1;} else {var if_res580 = 0;}var method_n1080 = method_n1063+if_res580;if (M0.__gt__eq_(n1061,method_n1080)!==false) {var if_res581 = n1061-method_n1080;} else {var if_res581 = n1061;}var n1077 = if_res581;if (M0.null_p(args1074)!==false) {var if_res582 = M0.null_p(kws1072);} else {var if_res582 = false;}if (if_res582!==false) {var if_res583 = $rjs_core.UString.make("");} else {var if_res583 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1082) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1082);},args1074),M0.map(function(kw1083, kw_arg1084) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1083,kw_arg1084);},kws1072,kw_args1073)));}var args_str1078 = if_res583;var proc_name1079 = function(p1085) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1085)!==false) {var if_res584 = M0.car(keyword_procedure_name_plus_fail(p1085));} else {var if_res584 = false;}var or_part1086 = if_res584;if (or_part1086!==false) {var if_res586 = or_part1086;} else {var or_part1087 = M0.object_name(p1085);if (or_part1087!==false) {var if_res585 = or_part1087;} else {var if_res585 = p1085;}var if_res586 = if_res585;}return if_res586;};var or_part1088 = extra_kw1076;if (or_part1088!==false) {var if_res593 = or_part1088;} else {var if_res593 = missing_kw1075;}if (if_res593!==false) {var if_res594 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res594 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1076!==false) {if (keyword_procedure_p(p1062)!==false) {var if_res588 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1079(p1062),extra_kw1076,args_str1078);} else {if (M0.procedure_p(p1062)!==false) {var if_res587 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1079(p1062),args_str1078);} else {var if_res587 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1062,args_str1078);}var if_res588 = if_res587;}var if_res592 = if_res588;} else {if (missing_kw1075!==false) {var if_res591 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1079(p1062),missing_kw1075,args_str1078);} else {var temp590 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1077-2)!==false) {var if_res589 = $rjs_core.UString.make("");} else {var if_res589 = $rjs_core.UString.make("s");}var if_res591 = M0.format(temp590,n1077-2,if_res589,proc_name1079(p1062),args_str1078);}var if_res592 = if_res591;}return M0.raise(if_res594(if_res592,M0.current_continuation_marks()));});}var if_res596 = if_res595;}return if_res596;};var keyword_procedure_extract = function(p1089, kws1090, n1091) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1090,n1091,p1089,0);};var cl597 = function(proc1092, arity1093, req_kw1094, allowed_kw1095, name1096) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1092,arity1093,false,name1096,req_kw1094,allowed_kw1095);};var cl598 = function(proc1097, arity1098, req_kw1099, allowed_kw1100) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1097,arity1098,false,false,req_kw1099,allowed_kw1100);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam599 = {'5':cl597,'4':cl598}[arguments.length];if (fixed_lam599!==undefined) {return fixed_lam599.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl600 = function(proc1101, mask1102, req_kw1103, allowed_kw1104, name1105) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1101,false,mask1102,name1105,req_kw1103,allowed_kw1104);};var cl601 = function(proc1106, mask1107, req_kw1108, allowed_kw1109) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1106,false,mask1107,false,req_kw1108,allowed_kw1109);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam602 = {'5':cl600,'4':cl601}[arguments.length];if (fixed_lam602!==undefined) {return fixed_lam602.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1110, proc1111, arity1112, mask1113, name1114, req_kw1115, allowed_kw1116) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1111)!==false) {var if_res603 = okp_ref(proc1111,0);} else {var if_res603 = proc1111;}var p1118 = if_res603;if (arity1112!==false) {var if_res604 = M0.__rjs_quoted__.procedure_reduce_arity(p1118,arity1112);} else {var if_res604 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1118,mask1113,name1114);}var plain_proc1117 = if_res604;var sorted_p1119 = function(kws1120) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1121 = function(kws1122) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1122)!==false) {var if_res607 = true;} else {if (M0.null_p(M0.cdr(kws1122))!==false) {var if_res606 = true;} else {if (M0.keyword_lt__p(M0.car(kws1122),M0.cadr(kws1122))!==false) {var if_res605 = loop1121(M0.cdr(kws1122));} else {var if_res605 = false;}var if_res606 = if_res605;}var if_res607 = if_res606;}return if_res607;};return loop1121(kws1120);};if (M0.list_p(req_kw1115)!==false) {if (M0.andmap(M0.keyword_p,req_kw1115)!==false) {var if_res608 = sorted_p1119(req_kw1115);} else {var if_res608 = false;}var if_res609 = if_res608;} else {var if_res609 = false;}if (if_res609!==false) {var if_res612 = M0.rvoid();} else {var temp611 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1123 = arity1112;if (or_part1123!==false) {var if_res610 = or_part1123;} else {var if_res610 = mask1113;}var if_res612 = M0.raise_argument_error(who1110,temp611,2,proc1111,if_res610,req_kw1115,allowed_kw1116);}if_res612;if (allowed_kw1116!==false) {if (M0.list_p(allowed_kw1116)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1116)!==false) {var if_res613 = sorted_p1119(allowed_kw1116);} else {var if_res613 = false;}var if_res614 = if_res613;} else {var if_res614 = false;}if (if_res614!==false) {var if_res617 = M0.rvoid();} else {var temp616 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1124 = arity1112;if (or_part1124!==false) {var if_res615 = or_part1124;} else {var if_res615 = mask1113;}var if_res617 = M0.raise_argument_error(who1110,temp616,3,proc1111,if_res615,req_kw1115,allowed_kw1116);}if_res617;if (subset_p(req_kw1115,allowed_kw1116)!==false) {var if_res618 = M0.rvoid();} else {var if_res618 = M0.raise_arguments_error(who1110,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1116,$rjs_core.UString.make("required keywords"),req_kw1115);}var if_res619 = if_res618;} else {var if_res619 = M0.rvoid();}if_res619;var let_result620 = procedure_keywords(proc1111);var old_req1125 = let_result620.getAt(0);var old_allowed1126 = let_result620.getAt(1);if (subset_p(old_req1125,req_kw1115)!==false) {var if_res621 = M0.rvoid();} else {var if_res621 = M0.raise_arguments_error(who1110,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1125,$rjs_core.UString.make("requested required keywords"),req_kw1115);}if_res621;if (old_allowed1126!==false) {if (subset_p(req_kw1115,old_allowed1126)!==false) {var if_res622 = M0.rvoid();} else {var if_res622 = M0.raise_arguments_error(who1110,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1126,$rjs_core.UString.make("requested required keywords"),req_kw1115);}if_res622;var or_part1127 = M0.not(allowed_kw1116);if (or_part1127!==false) {var if_res623 = or_part1127;} else {var if_res623 = subset_p(allowed_kw1116,old_allowed1126);}if (if_res623!==false) {var if_res624 = M0.rvoid();} else {var if_res624 = M0.raise_arguments_error(who1110,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1126,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1116);}var if_res625 = if_res624;} else {var if_res625 = M0.rvoid();}if_res625;if (M0.null_p(allowed_kw1116)!==false) {var if_res633 = plain_proc1117;} else {var or_part1129 = mask1113;if (or_part1129!==false) {var if_res626 = or_part1129;} else {var if_res626 = arity__gt_mask(arity1112);}var mask1128 = if_res626;var new_mask1130 = M0.arithmetic_shift(mask1128,2);var kw_checker1131 = make_keyword_checker(req_kw1115,allowed_kw1116,new_mask1130);var proc1132 = normalize_proc(proc1111);var new_kw_proc1133 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1132),new_mask1130);if (M0.null_p(req_kw1115)!==false) {if (okm_p(proc1132)!==false) {var if_res627 = make_optional_keyword_method;} else {var if_res627 = make_optional_keyword_procedure;}var if_res632 = if_res627(kw_checker1131,new_kw_proc1133,req_kw1115,allowed_kw1116,plain_proc1117);} else {if (named_keyword_procedure_p(proc1132)!==false) {var if_res630 = M0.car(keyword_procedure_name_plus_fail(proc1132));} else {var if_res630 = false;}var or_part1134 = if_res630;if (or_part1134!==false) {var if_res631 = or_part1134;} else {var if_res631 = M0.object_name(proc1132);}var temp629 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1128,1));var or_part1135 = okm_p(proc1132);if (or_part1135!==false) {var if_res628 = or_part1135;} else {var if_res628 = keyword_method_p(proc1132);}var if_res632 = make_required(if_res631,temp629,if_res628,false)(kw_checker1131,new_kw_proc1133,req_kw1115,allowed_kw1116);}var if_res633 = if_res632;}return if_res633;};var arity__gt_mask = function(a1136) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1136)!==false) {var if_res639 = M0.arithmetic_shift(1,a1136);} else {if (M0.arity_at_least_p(a1136)!==false) {var if_res638 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1136))));} else {if (M0.list_p(a1136)!==false) {var loop1137 = function(mask1138, l1139) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1139)!==false) {var if_res636 = mask1138;} else {var a1140 = M0.car(l1139);var or_part1141 = M0.exact_nonnegative_integer_p(a1140);if (or_part1141!==false) {var if_res634 = or_part1141;} else {var if_res634 = M0.arity_at_least_p(a1140);}if (if_res634!==false) {var if_res635 = loop1137(M0.bitwise_ior(mask1138,arity__gt_mask(a1140)),M0.cdr(l1139));} else {var if_res635 = false;}var if_res636 = if_res635;}return if_res636;};var if_res637 = loop1137(0,a1136);} else {var if_res637 = false;}var if_res638 = if_res637;}var if_res639 = if_res638;}return if_res639;};var cl640 = function(proc1143, arity1144, name1145) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1143)!==false) {var let_result643 = procedure_keywords(proc1143);var req1146 = let_result643.getAt(0);var allows1147 = let_result643.getAt(1);if (M0.pair_p(req1146)!==false) {var if_res644 = M0.not(M0.null_p(arity1144));} else {var if_res644 = false;}var if_res645 = if_res644;} else {var if_res645 = false;}if (if_res645!==false) {var if_res647 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1143);} else {if (okm_p(proc1143)!==false) {var if_res646 = M0.__rjs_quoted__.procedure__gt_method(proc1143);} else {var if_res646 = proc1143;}var if_res647 = M0.__rjs_quoted__.procedure_reduce_arity(if_res646,arity1144,name1145);}return if_res647;};var cl641 = function(proc1148, arity1149) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1148,arity1149,false);};var procedure_reduce_arity1142 = $rjs_core.attachProcedureArity(function() {var fixed_lam642 = {'3':cl640,'2':cl641}[arguments.length];if (fixed_lam642!==undefined) {return fixed_lam642.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1142;var cl648 = function(proc1151, mask1152, name1153) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1151)!==false) {var let_result651 = procedure_keywords(proc1151);var req1154 = let_result651.getAt(0);var allows1155 = let_result651.getAt(1);if (M0.pair_p(req1154)!==false) {var if_res652 = M0.not(M0.eqv_p(mask1152,0));} else {var if_res652 = false;}var if_res653 = if_res652;} else {var if_res653 = false;}if (if_res653!==false) {var if_res655 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1151);} else {if (okm_p(proc1151)!==false) {var if_res654 = M0.__rjs_quoted__.procedure__gt_method(proc1151);} else {var if_res654 = proc1151;}var if_res655 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res654,mask1152,name1153);}return if_res655;};var cl649 = function(proc1156, mask1157) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1156,mask1157,false);};var procedure_reduce_arity1150 = $rjs_core.attachProcedureArity(function() {var fixed_lam650 = {'3':cl648,'2':cl649}[arguments.length];if (fixed_lam650!==undefined) {return fixed_lam650.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1150;var procedure__gt_method1158 = function(proc1159) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1160 = normalize_proc(proc1159);if (keyword_procedure_p(proc1160)!==false) {if (okm_p(proc1160)!==false) {var if_res658 = proc1160;} else {if (keyword_method_p(proc1160)!==false) {var if_res657 = proc1160;} else {if (okp_p(proc1160)!==false) {var if_res656 = make_optional_keyword_method(keyword_procedure_checker(proc1160),keyword_procedure_proc(proc1160),keyword_procedure_required(proc1160),keyword_procedure_allowed(proc1160),okp_ref(proc1160,0));} else {var name_plus_fail1161 = keyword_procedure_name_plus_fail(proc1160);var mk1162 = make_required(M0.car(name_plus_fail1161),M0.cdr(name_plus_fail1161),true,false);var if_res656 = mk1162(keyword_procedure_checker(proc1160),keyword_procedure_proc(proc1160),keyword_procedure_required(proc1160),keyword_procedure_allowed(proc1160));}var if_res657 = if_res656;}var if_res658 = if_res657;}var if_res659 = if_res658;} else {var if_res659 = M0.__rjs_quoted__.procedure__gt_method(proc1160);}return if_res659;};var new_procedure__gt_method = procedure__gt_method1158;var procedure_rename1163 = function(proc1164, name1165) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1164)!==false) {var if_res660 = M0.symbol_p(name1165);} else {var if_res660 = false;}if (M0.not(if_res660)!==false) {var if_res663 = M0.__rjs_quoted__.procedure_rename(proc1164,name1165);} else {if (okp_p(proc1164)!==false) {if (okm_p(proc1164)!==false) {var if_res661 = make_optional_keyword_method;} else {var if_res661 = make_optional_keyword_procedure;}var if_res662 = if_res661(keyword_procedure_checker(proc1164),keyword_procedure_proc(proc1164),keyword_procedure_required(proc1164),keyword_procedure_allowed(proc1164),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1164,0),name1165));} else {var name_plus_fail1166 = keyword_procedure_name_plus_fail(proc1164);var mk1167 = make_required(name1165,M0.cdr(name_plus_fail1166),keyword_method_p(proc1164),false);var if_res662 = mk1167(keyword_procedure_checker(proc1164),keyword_procedure_proc(proc1164),keyword_procedure_required(proc1164),keyword_procedure_allowed(proc1164));}var if_res663 = if_res662;}return if_res663;};var new_procedure_rename = procedure_rename1163;var chaperone_procedure1168 = $rjs_core.attachProcedureArity(function(proc1169, wrap_proc1170, ...props1171664) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1171 = $rjs_core.Pair.listFromArray(props1171664);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1169,wrap_proc1170,props1171);});var new_chaperone_procedure = chaperone_procedure1168;var unsafe_chaperone_procedure1172 = $rjs_core.attachProcedureArity(function(proc1173, wrap_proc1174, ...props1175665) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1175 = $rjs_core.Pair.listFromArray(props1175665);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1173,wrap_proc1174,props1175);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1172;var impersonate_procedure1176 = $rjs_core.attachProcedureArity(function(proc1177, wrap_proc1178, ...props1179666) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1179 = $rjs_core.Pair.listFromArray(props1179666);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1177,wrap_proc1178,props1179);});var new_impersonate_procedure = impersonate_procedure1176;var unsafe_impersonate_procedure1180 = $rjs_core.attachProcedureArity(function(proc1181, wrap_proc1182, ...props1183667) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1183 = $rjs_core.Pair.listFromArray(props1183667);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1181,wrap_proc1182,props1183);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1180;var chaperone_procedure_times_1184 = $rjs_core.attachProcedureArity(function(proc1185, wrap_proc1186, ...props1187668) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1187 = $rjs_core.Pair.listFromArray(props1187668);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1185,wrap_proc1186,props1187);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1184;var impersonate_procedure_times_1188 = $rjs_core.attachProcedureArity(function(proc1189, wrap_proc1190, ...props1191669) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1191 = $rjs_core.Pair.listFromArray(props1191669);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1189,wrap_proc1190,props1191);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1188;var do_chaperone_procedure = function(is_impersonator_p1192, self_arg_p1193, chaperone_procedure1194, name1195, proc1196, wrap_proc1197, props1198) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1199 = normalize_proc(proc1196);var n_wrap_proc1200 = normalize_proc(wrap_proc1197);var or_part1201 = M0.not(keyword_procedure_p(n_proc1199));if (or_part1201!==false) {var if_res671 = or_part1201;} else {var or_part1202 = M0.not(M0.procedure_p(wrap_proc1197));if (or_part1202!==false) {var if_res670 = or_part1202;} else {var if_res670 = bad_props_p(props1198);}var if_res671 = if_res670;}if (if_res671!==false) {var if_res738 = M0.apply(chaperone_procedure1194,proc1196,wrap_proc1197,props1198);} else {chaperone_arity_match_checking(self_arg_p1193,name1195,proc1196,wrap_proc1197,props1198);var loop1204 = function(props1205) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1205)!==false) {var if_res673 = false;} else {if (M0.eq_p(M0.car(props1205),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res672 = M0.cadr(props1205);} else {var if_res672 = loop1204(M0.cddr(props1205));}var if_res673 = if_res672;}return if_res673;};var mark_prop1203 = loop1204(props1198);var chaperone_procedure_by_add_mark1206 = function(proc1207, wrap_proc1208) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1203!==false) {var if_res674 = chaperone_procedure1194(proc1207,wrap_proc1208,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1203);} else {var if_res674 = chaperone_procedure1194(proc1207,wrap_proc1208);}return if_res674;};var p1210 = keyword_procedure_proc(n_wrap_proc1200);if (self_arg_p1193!==false) {var cl675 = $rjs_core.attachProcedureArity(function(self_proc1211, kws1212, args1213, ...rest1214680) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1214 = $rjs_core.Pair.listFromArray(rest1214680);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1210,kws1212,args1213,self_proc1211,rest1214);},$rjs_core.attachProcedureArity(function(...results1215681) {var results1215 = $rjs_core.Pair.listFromArray(results1215681);var len1216 = M0.length(results1215);var alen1217 = M0.length(rest1214);if (M0.__lt_(len1216,alen1217+1)!==false) {var if_res682 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1217+1,$rjs_core.UString.make("received number of results"),len1216,$rjs_core.UString.make("wrapper procedure"),wrap_proc1197);} else {var if_res682 = M0.rvoid();}if_res682;var num_extra1218 = len1216-(alen1217+1);var new_args1219 = M0.list_ref(results1215,num_extra1218);if (M0.list_p(new_args1219)!==false) {var if_res683 = M0.__eq_(M0.length(new_args1219),M0.length(args1213));} else {var if_res683 = false;}if (if_res683!==false) {var if_res687 = M0.rvoid();} else {var temp686 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp685 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1216,alen1217)!==false) {var if_res684 = $rjs_core.UString.make("");} else {var if_res684 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res687 = M0.raise_arguments_error(temp686,M0.format(temp685,if_res684),$rjs_core.UString.make("first result"),new_args1219,$rjs_core.UString.make("wrapper procedure"),wrap_proc1197);}if_res687;M0.for_each(function(kw1220, new_arg1221, arg1222) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1192!==false) {var if_res689 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1221,arg1222)!==false) {var if_res688 = M0.rvoid();} else {var if_res688 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1220),$rjs_core.UString.make("result"),new_arg1221,$rjs_core.UString.make("wrapper procedure"),wrap_proc1197);}var if_res689 = if_res688;}return if_res689;},kws1212,new_args1219,args1213);var tmp1223 = num_extra1218;if (M0.equal_p(tmp1223,0)!==false) {var if_res692 = M0.apply(M0.values,kws1212,results1215);} else {if (M0.equal_p(tmp1223,1)!==false) {var if_res691 = M0.apply(M0.values,M0.car(results1215),kws1212,M0.cdr(results1215));} else {var loop1224 = function(results1225, c1226) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1226)!==false) {var if_res690 = M0.cons(kws1212,results1225);} else {var if_res690 = M0.cons(M0.car(results1225),loop1224(M0.cdr(results1225),M0.sub1(c1226)));}return if_res690;};var if_res691 = M0.apply(M0.values,loop1224(results1215,num_extra1218));}var if_res692 = if_res691;}return if_res692;}));});var cl676 = $rjs_core.attachProcedureArity(function(...other1227693) {var other1227 = $rjs_core.Pair.listFromArray(other1227693);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res713 = $rjs_core.attachProcedureArity(function() {var fixed_lam677 = {}[arguments.length];if (fixed_lam677!==undefined) {return fixed_lam677.apply(null,arguments);} else {if (M0.__gt__eq_(cl675.length,1)!==false) {var if_res679 = cl675.apply(null,arguments);} else {if (true!==false) {var if_res678 = cl676.apply(null,arguments);} else {var if_res678 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res679 = if_res678;}return if_res679;}},[M0.make_arity_at_least(0)]);} else {var cl694 = $rjs_core.attachProcedureArity(function(kws1228, args1229, ...rest1230699) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1230 = $rjs_core.Pair.listFromArray(rest1230699);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1210,kws1228,args1229,rest1230);},$rjs_core.attachProcedureArity(function(...results1231700) {var results1231 = $rjs_core.Pair.listFromArray(results1231700);var len1232 = M0.length(results1231);var alen1233 = M0.length(rest1230);if (M0.__lt_(len1232,alen1233+1)!==false) {var if_res701 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1233+1,$rjs_core.UString.make("received number of results"),len1232,$rjs_core.UString.make("wrapper procedure"),wrap_proc1197);} else {var if_res701 = M0.rvoid();}if_res701;var num_extra1234 = len1232-(alen1233+1);var new_args1235 = M0.list_ref(results1231,num_extra1234);if (M0.list_p(new_args1235)!==false) {var if_res702 = M0.__eq_(M0.length(new_args1235),M0.length(args1229));} else {var if_res702 = false;}if (if_res702!==false) {var if_res706 = M0.rvoid();} else {var temp705 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp704 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1232,alen1233)!==false) {var if_res703 = $rjs_core.UString.make("");} else {var if_res703 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res706 = M0.raise_arguments_error(temp705,M0.format(temp704,if_res703),$rjs_core.UString.make("first result"),new_args1235,$rjs_core.UString.make("wrapper procedure"),wrap_proc1197);}if_res706;M0.for_each(function(kw1236, new_arg1237, arg1238) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1192!==false) {var if_res708 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1237,arg1238)!==false) {var if_res707 = M0.rvoid();} else {var if_res707 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1236),$rjs_core.UString.make("result"),new_arg1237,$rjs_core.UString.make("wrapper procedure"),wrap_proc1197);}var if_res708 = if_res707;}return if_res708;},kws1228,new_args1235,args1229);var tmp1239 = num_extra1234;if (M0.equal_p(tmp1239,0)!==false) {var if_res711 = M0.apply(M0.values,kws1228,results1231);} else {if (M0.equal_p(tmp1239,1)!==false) {var if_res710 = M0.apply(M0.values,M0.car(results1231),kws1228,M0.cdr(results1231));} else {var loop1240 = function(results1241, c1242) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1242)!==false) {var if_res709 = M0.cons(kws1228,results1241);} else {var if_res709 = M0.cons(M0.car(results1241),loop1240(M0.cdr(results1241),M0.sub1(c1242)));}return if_res709;};var if_res710 = M0.apply(M0.values,loop1240(results1231,num_extra1234));}var if_res711 = if_res710;}return if_res711;}));});var cl695 = $rjs_core.attachProcedureArity(function(...other1243712) {var other1243 = $rjs_core.Pair.listFromArray(other1243712);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res713 = $rjs_core.attachProcedureArity(function() {var fixed_lam696 = {}[arguments.length];if (fixed_lam696!==undefined) {return fixed_lam696.apply(null,arguments);} else {if (M0.__gt__eq_(cl694.length,1)!==false) {var if_res698 = cl694.apply(null,arguments);} else {if (true!==false) {var if_res697 = cl695.apply(null,arguments);} else {var if_res697 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res698 = if_res697;}return if_res698;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1209 = if_res713;var wrap1246 = function(proc1247, n_proc1248) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1248,proc1247))!==false) {var if_res714 = new_procedure_p(proc1247);} else {var if_res714 = false;}if (if_res714!==false) {var v1249 = new_procedure_ref(proc1247);if (M0.exact_integer_p(v1249)!==false) {var acc1250 = procedure_accessor_ref(proc1247);var if_res730 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1247,acc1250,function(self1251, sub_proc1252) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result715 = wrap1246(sub_proc1252,normalize_proc(sub_proc1252));var f1253 = let_result715.getAt(0);var acc1254 = let_result715.getAt(1);return f1253;}),acc1250);} else {if (is_impersonator_p1192!==false) {var if_res729 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res729 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1248)!==false) {var if_res728 = chaperone_procedure_by_add_mark1206(proc1247,wrap_proc1197);} else {var if_res728 = proc1247;}var new_kw_proc1255 = if_res729(if_res728,new_procedure_ref,function(self1256, proc1257) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1192!==false) {var if_res727 = new_impersonate_procedure;} else {var if_res727 = new_chaperone_procedure;}if (self_arg_p1193!==false) {var if_res726 = $rjs_core.attachProcedureArity(function(proc_self1258, kws1259, kw_args1260, self1261, ...args1262716) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1262 = $rjs_core.Pair.listFromArray(args1262716);var len1263 = M0.length(args1262);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1209,proc_self1258,kws1259,kw_args1260,args1262);},$rjs_core.attachProcedureArity(function(...results1264717) {var results1264 = $rjs_core.Pair.listFromArray(results1264717);var r_len1265 = M0.length(results1264);var list_take1266 = function(l1267, n1268) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1268)!==false) {var if_res718 = M0.rnull;} else {var if_res718 = M0.cons(M0.car(l1267),list_take1266(M0.cdr(l1267),M0.sub1(n1268)));}return if_res718;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res719 = M0.__eq_(r_len1265,2+len1263);} else {var if_res719 = false;}if (if_res719!==false) {var if_res720 = M0.apply(M0.values,M0.cadr(results1264),self1261,M0.cddr(results1264));} else {var skip1269 = r_len1265-len1263;var if_res720 = M0.apply(M0.values,M0.append(list_take1266(results1264,skip1269-2),M0.list(M0.list_ref(results1264,M0.sub1(skip1269)),self1261),M0.__rjs_quoted__.list_tail(results1264,skip1269)));}return if_res720;}));});} else {var if_res726 = $rjs_core.attachProcedureArity(function(kws1270, kw_args1271, self1272, ...args1273721) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1273 = $rjs_core.Pair.listFromArray(args1273721);var len1274 = M0.length(args1273);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1209,kws1270,kw_args1271,args1273);},$rjs_core.attachProcedureArity(function(...results1275722) {var results1275 = $rjs_core.Pair.listFromArray(results1275722);var r_len1276 = M0.length(results1275);var list_take1277 = function(l1278, n1279) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1279)!==false) {var if_res723 = M0.rnull;} else {var if_res723 = M0.cons(M0.car(l1278),list_take1277(M0.cdr(l1278),M0.sub1(n1279)));}return if_res723;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res724 = M0.__eq_(r_len1276,2+len1274);} else {var if_res724 = false;}if (if_res724!==false) {var if_res725 = M0.apply(M0.values,M0.cadr(results1275),self1272,M0.cddr(results1275));} else {var skip1280 = r_len1276-len1274;var if_res725 = M0.apply(M0.values,M0.append(list_take1277(results1275,skip1280-2),M0.list(M0.list_ref(results1275,M0.sub1(skip1280)),self1272),M0.__rjs_quoted__.list_tail(results1275,skip1280)));}return if_res725;}));});}return if_res727(proc1257,make_keyword_procedure(if_res726));});var if_res730 = M0.values(new_kw_proc1255,new_procedure_ref);}var if_res735 = if_res730;} else {if (okp_p(n_proc1248)!==false) {if (is_impersonator_p1192!==false) {if (okm_p(n_proc1248)!==false) {var if_res731 = make_optional_keyword_method_impersonator;} else {var if_res731 = make_optional_keyword_procedure_impersonator;}var if_res732 = if_res731(keyword_procedure_checker(n_proc1248),chaperone_procedure_by_add_mark1206(keyword_procedure_proc(n_proc1248),kw_chaperone1209),keyword_procedure_required(n_proc1248),keyword_procedure_allowed(n_proc1248),chaperone_procedure_by_add_mark1206(okp_ref(n_proc1248,0),okp_ref(n_wrap_proc1200,0)),n_proc1248);} else {var if_res732 = M0.__rjs_quoted__.chaperone_struct(proc1247,keyword_procedure_proc,function(self1281, proc1282) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1206(proc1282,kw_chaperone1209);},M0.make_struct_field_accessor(okp_ref,0),function(self1283, proc1284) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1206(proc1284,okp_ref(n_wrap_proc1200,0));});}var if_res734 = M0.values(if_res732,keyword_procedure_proc);} else {if (is_impersonator_p1192!==false) {var name_plus_fail1285 = keyword_procedure_name_plus_fail(n_proc1248);var mk1286 = make_required(M0.car(name_plus_fail1285),M0.cdr(name_plus_fail1285),keyword_method_p(n_proc1248),true);var if_res733 = mk1286(keyword_procedure_checker(n_proc1248),chaperone_procedure_by_add_mark1206(keyword_procedure_proc(n_proc1248),kw_chaperone1209),keyword_procedure_required(n_proc1248),keyword_procedure_allowed(n_proc1248),n_proc1248);} else {var if_res733 = M0.__rjs_quoted__.chaperone_struct(n_proc1248,keyword_procedure_proc,function(self1287, proc1288) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1206(proc1288,kw_chaperone1209);});}var if_res734 = M0.values(if_res733,keyword_procedure_proc);}var if_res735 = if_res734;}return if_res735;};var let_result736 = wrap1246(proc1196,n_proc1199);var new_proc1244 = let_result736.getAt(0);var chap_accessor1245 = let_result736.getAt(1);if (M0.null_p(props1198)!==false) {var if_res737 = new_proc1244;} else {var if_res737 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1244,chap_accessor1245,false,props1198);}var if_res738 = if_res737;}return if_res738;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1289, name1290, proc1291, wrap_proc1292, props1293) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1294 = normalize_proc(proc1291);var n_wrap_proc1295 = normalize_proc(wrap_proc1292);var or_part1296 = M0.not(keyword_procedure_p(n_proc1294));if (or_part1296!==false) {var if_res740 = or_part1296;} else {var or_part1297 = M0.not(M0.procedure_p(wrap_proc1292));if (or_part1297!==false) {var if_res739 = or_part1297;} else {var if_res739 = bad_props_p(props1293);}var if_res740 = if_res739;}if (if_res740!==false) {var if_res741 = M0.apply(unsafe_chaperone_procedure1289,proc1291,wrap_proc1292,props1293);} else {chaperone_arity_match_checking(false,name1290,proc1291,wrap_proc1292,props1293);var if_res741 = M0.apply(unsafe_chaperone_procedure1289,proc1291,wrap_proc1292,props1293);}return if_res741;};var bad_props_p = function(props1298) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1299 = function(props1300) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1300)!==false) {var if_res744 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1300))!==false) {var props1301 = M0.cdr(props1300);var or_part1302 = M0.null_p(props1301);if (or_part1302!==false) {var if_res742 = or_part1302;} else {var if_res742 = loop1299(M0.cdr(props1301));}var if_res743 = if_res742;} else {var if_res743 = true;}var if_res744 = if_res743;}return if_res744;};return loop1299(props1298);};var chaperone_arity_match_checking = function(self_arg_p1303, name1304, proc1305, wrap_proc1306, props1307) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1308 = M0.procedure_arity(proc1305);var b1309 = M0.procedure_arity(wrap_proc1306);if (self_arg_p1303!==false) {var if_res745 = 1;} else {var if_res745 = 0;}var d1310 = if_res745;var let_result746 = procedure_keywords(proc1305);var a_req1311 = let_result746.getAt(0);var a_allow1312 = let_result746.getAt(1);var let_result747 = procedure_keywords(wrap_proc1306);var b_req1313 = let_result747.getAt(0);var b_allow1314 = let_result747.getAt(1);var includes_p1315 = function(a1316, b1317) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1317)!==false) {if (M0.number_p(a1316)!==false) {var if_res749 = M0.__eq_(b1317,a1316+d1310);} else {if (M0.arity_at_least_p(a1316)!==false) {var if_res748 = M0.__gt__eq_(b1317,M0.arity_at_least_value(a1316)+d1310);} else {var if_res748 = M0.ormap(function(a1318) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1315(a1318,b1317);},a1316);}var if_res749 = if_res748;}var if_res753 = if_res749;} else {if (M0.arity_at_least_p(b1317)!==false) {if (M0.number_p(a1316)!==false) {var if_res751 = false;} else {if (M0.arity_at_least_p(a1316)!==false) {var if_res750 = M0.__gt__eq_(M0.arity_at_least_value(b1317),M0.arity_at_least_value(a1316)+d1310);} else {var if_res750 = M0.ormap(function(a1319) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1315(b1317,a1319);},a1316);}var if_res751 = if_res750;}var if_res752 = if_res751;} else {var if_res752 = M0.andmap(function(b1320) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1315(a1316,b1320);},b1317);}var if_res753 = if_res752;}return if_res753;};if (includes_p1315(b1309,a1308)!==false) {var if_res754 = M0.rvoid();} else {var if_res754 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1305,wrap_proc1306,props1307);}if_res754;if (subset_p(b_req1313,a_req1311)!==false) {var if_res755 = M0.rvoid();} else {var if_res755 = M0.raise_arguments_error(name1304,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1306,$rjs_core.UString.make("original procedure"),proc1305);}if_res755;var or_part1321 = M0.not(b_allow1314);if (or_part1321!==false) {var if_res757 = or_part1321;} else {if (a_allow1312!==false) {var if_res756 = subset_p(a_allow1312,b_allow1314);} else {var if_res756 = false;}var if_res757 = if_res756;}if (if_res757!==false) {var if_res758 = M0.rvoid();} else {var if_res758 = M0.raise_arguments_error(name1304,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1306,$rjs_core.UString.make("original procedure"),proc1305);}if_res758;return M0.rvoid();};var normalize_proc = function(proc1322) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1322)!==false) {var if_res766 = proc1322;} else {if (new_procedure_p(proc1322)!==false) {var let_result759 = procedure_keywords(proc1322);var req_kws1323 = let_result759.getAt(0);var allowed_kws1324 = let_result759.getAt(1);if (M0.null_p(allowed_kws1324)!==false) {var if_res764 = proc1322;} else {var if_res764 = make_optional_keyword_procedure(function(given_kws1325, given_argc1326) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1322,given_argc1326-2,true)!==false) {var or_part1327 = M0.not(allowed_kws1324);if (or_part1327!==false) {var if_res761 = or_part1327;} else {var if_res761 = subset_p(given_kws1325,allowed_kws1324);}if (if_res761!==false) {var if_res762 = subset_p(req_kws1323,given_kws1325);} else {var if_res762 = false;}var if_res763 = if_res762;} else {var if_res763 = false;}return if_res763;},$rjs_core.attachProcedureArity(function(kws1328, kw_args1329, ...vals1330760) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1330 = $rjs_core.Pair.listFromArray(vals1330760);return keyword_apply(proc1322,kws1328,kw_args1329,vals1330);}),req_kws1323,allowed_kws1324,proc1322);}var if_res765 = if_res764;} else {var if_res765 = proc1322;}var if_res766 = if_res765;}return if_res766;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };