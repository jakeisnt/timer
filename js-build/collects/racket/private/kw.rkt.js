import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result465 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result465.getAt(0);var keyword_impersonator_p = let_result465.getAt(1);var keyword_impersonator_ref = let_result465.getAt(2);var keyword_procedure_impersonator_of = function(v962) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v962)!==false) {var if_res466 = keyword_impersonator_ref(v962)(v962);} else {var if_res466 = false;}return if_res466;};var let_result467 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result467.getAt(0);var mk_kw_proc = let_result467.getAt(1);var keyword_procedure_p = let_result467.getAt(2);var keyword_procedure_ref = let_result467.getAt(3);var keyword_procedure_set_bang_ = let_result467.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result468 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result468.getAt(0);var make_km = let_result468.getAt(1);var keyword_method_p = let_result468.getAt(2);var km_ref = let_result468.getAt(3);var km_set_bang_ = let_result468.getAt(4);var generate_arity_string = function(proc963) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result469 = procedure_keywords(proc963);var req964 = let_result469.getAt(0);var allowed965 = let_result469.getAt(1);var a966 = M0.procedure_arity(proc963);var keywords_desc967 = function(opt969, req970) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp475 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req970))!==false) {var if_res474 = M0.format($rjs_core.UString.make("an ~aargument"),opt969);} else {var if_res474 = M0.format($rjs_core.UString.make("~aarguments"),opt969);}if (M0.null_p(M0.cdr(req970))!==false) {var if_res473 = $rjs_core.UString.make("");} else {var if_res473 = $rjs_core.UString.make("s");}var tmp971 = M0.length(req970);if (M0.equal_p(tmp971,1)!==false) {var if_res472 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req970));} else {if (M0.equal_p(tmp971,2)!==false) {var if_res471 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req970),M0.cadr(req970));} else {var loop972 = function(req973) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req973))!==false) {var if_res470 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req973));} else {var if_res470 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req973),loop972(M0.cdr(req973)));}return if_res470;};var if_res471 = loop972(req970);}var if_res472 = if_res471;}return M0.format(temp475,if_res474,if_res473,if_res472);};var method_adjust968 = function(a974) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part975 = okm_p(proc963);if (or_part975!==false) {var if_res476 = or_part975;} else {var if_res476 = keyword_method_p(proc963);}if (if_res476!==false) {if (M0.zero_p(a974)!==false) {var if_res477 = 0;} else {var if_res477 = M0.sub1(a974);}var if_res478 = if_res477;} else {var if_res478 = a974;}return if_res478;};if (M0.number_p(a966)!==false) {var a976 = method_adjust968(a966);var if_res485 = M0.format($rjs_core.UString.make("~a"),a976);} else {if (M0.arity_at_least_p(a966)!==false) {var a977 = method_adjust968(M0.arity_at_least_value(a966));var if_res484 = M0.format($rjs_core.UString.make("at least ~a"),a977);} else {var if_res484 = $rjs_core.UString.make("a different number");}var if_res485 = if_res484;}if (M0.null_p(req964)!==false) {var if_res483 = $rjs_core.UString.make("");} else {var if_res483 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc967($rjs_core.UString.make(""),req964));}if (allowed965!==false) {var loop979 = function(req980, allowed981) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req980)!==false) {var if_res480 = allowed981;} else {if (M0.eq_p(M0.car(req980),M0.car(allowed981))!==false) {var if_res479 = loop979(M0.cdr(req980),M0.cdr(allowed981));} else {var if_res479 = M0.cons(M0.car(allowed981),loop979(req980,M0.cdr(allowed981)));}var if_res480 = if_res479;}return if_res480;};var others978 = loop979(req964,allowed965);if (M0.null_p(others978)!==false) {var if_res481 = $rjs_core.UString.make("");} else {var if_res481 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc967($rjs_core.UString.make("optional "),others978));}var if_res482 = if_res481;} else {var if_res482 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res485,if_res483,if_res482);};var let_result486 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result486.getAt(0);var make_optional_keyword_procedure = let_result486.getAt(1);var okp_p = let_result486.getAt(2);var okp_ref = let_result486.getAt(3);var okp_set_bang_ = let_result486.getAt(4);var let_result487 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result487.getAt(0);var make_optional_keyword_method = let_result487.getAt(1);var okm_p = let_result487.getAt(2);var okm_ref = let_result487.getAt(3);var okm_set_bang_ = let_result487.getAt(4);var let_result488 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result488.getAt(0);var named_keyword_procedure_p = let_result488.getAt(1);var keyword_procedure_name_plus_fail = let_result488.getAt(2);var let_result490 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v982, info_l983) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v982)!==false) {var if_res489 = M0.make_struct_field_accessor(M0.list_ref(info_l983,3),v982);} else {var if_res489 = false;}return if_res489;});var prop_procedure_accessor = let_result490.getAt(0);var procedure_accessor_p = let_result490.getAt(1);var procedure_accessor_ref = let_result490.getAt(2);var let_result491 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result491.getAt(0);var new_procedure_p = let_result491.getAt(1);var new_procedure_ref = let_result491.getAt(2);var let_result492 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v984) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v984,0);})));var struct_keyword_procedure_impersonator = let_result492.getAt(0);var make_kpp = let_result492.getAt(1);var keyword_procedure_impersonator_p = let_result492.getAt(2);var kpp_ref = let_result492.getAt(3);var kpp_set_bang_ = let_result492.getAt(4);var let_result493 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v985) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v985,0);})));var struct_keyword_method_impersonator = let_result493.getAt(0);var make_kmp = let_result493.getAt(1);var keyword_method_impersonator_p = let_result493.getAt(2);var kmp_ref = let_result493.getAt(3);var kmp_set_bang_ = let_result493.getAt(4);var let_result494 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v986) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v986,0);})));var struct_okpp = let_result494.getAt(0);var make_optional_keyword_procedure_impersonator = let_result494.getAt(1);var okpp_p = let_result494.getAt(2);var okpp_ref = let_result494.getAt(3);var okpp_set_bang_ = let_result494.getAt(4);var let_result495 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v987) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v987,0);})));var struct_okmp = let_result495.getAt(0);var make_optional_keyword_method_impersonator = let_result495.getAt(1);var okmp_p = let_result495.getAt(2);var okmp_ref = let_result495.getAt(3);var okmp_set_bang_ = let_result495.getAt(4);var let_result496 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result496.getAt(0);var make_kp_by_ae = let_result496.getAt(1);var kp_by_ae_p = let_result496.getAt(2);var kp_by_ae_ref = let_result496.getAt(3);var kp_by_ae_set_bang_ = let_result496.getAt(4);var let_result497 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result497.getAt(0);var make_km_by_ae = let_result497.getAt(1);var km_by_ae_p = let_result497.getAt(2);var km_by_ae_ref = let_result497.getAt(3);var km_by_ae_set_bang_ = let_result497.getAt(4);var let_result498 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result498.getAt(0);var make_kpi_by_ae = let_result498.getAt(1);var kpi_by_ae_p = let_result498.getAt(2);var kpi_by_ae_ref = let_result498.getAt(3);var kpi_by_ae_set_bang_ = let_result498.getAt(4);var let_result499 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result499.getAt(0);var make_kmi_by_ae = let_result499.getAt(1);var kmi_by_ae_p = let_result499.getAt(2);var kmi_by_ae_ref = let_result499.getAt(3);var kmi_by_ae_set_bang_ = let_result499.getAt(4);var make_required = function(name988, fail_proc989, method_p990, impersonator_p991) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part997 = name988;if (or_part997!==false) {var if_res503 = or_part997;} else {var if_res503 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p991!==false) {if (method_p990!==false) {var if_res500 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res500 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res502 = if_res500;} else {if (method_p990!==false) {var if_res501 = struct_keyword_method_by_arity_error;} else {var if_res501 = struct_keyword_procedure_by_arity_error;}var if_res502 = if_res501;}var let_result504 = M0.make_struct_type(if_res503,if_res502,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name988,fail_proc989))),M0.current_inspector(),fail_proc989);var s_992 = let_result504.getAt(0);var mk993 = let_result504.getAt(1);var __p994 = let_result504.getAt(2);var __ref995 = let_result504.getAt(3);var __set_bang_996 = let_result504.getAt(4);return mk993;};var cl505 = function(proc998) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name999 = M0.object_name(proc998);var plain_proc1000 = $rjs_core.attachProcedureArity(function(...args1001508) {var args1001 = $rjs_core.Pair.listFromArray(args1001508);return M0.apply(proc998,M0.rnull,M0.rnull,args1001);});if (M0.symbol_p(proc_name999)!==false) {var if_res509 = M0.__rjs_quoted__.procedure_rename(plain_proc1000,proc_name999);} else {var if_res509 = plain_proc1000;}return make_keyword_procedure(proc998,if_res509);};var cl506 = function(proc1002, plain_proc1003) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1002)!==false) {var if_res510 = M0.procedure_arity_mask(proc1002);} else {var if_res510 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res510),proc1002,M0.rnull,false,plain_proc1003);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam507 = {'1':cl505,'2':cl506}[arguments.length];if (fixed_lam507!==undefined) {return fixed_lam507.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1004, kws1005, kw_vals1006, normal_args1007, ...normal_argss1008511) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1008 = $rjs_core.Pair.listFromArray(normal_argss1008511);var type_error1009 = function(what1010, which1011) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1010,which1011,proc1004,kws1005,kw_vals1006,normal_args1007,normal_argss1008);};if (M0.procedure_p(proc1004)!==false) {var if_res512 = M0.rvoid();} else {var if_res512 = type_error1009($rjs_core.UString.make("procedure?"),0);}if_res512;var loop1012 = function(ks1013) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1013)!==false) {var if_res519 = M0.rvoid();} else {var or_part1014 = M0.not(M0.pair_p(ks1013));if (or_part1014!==false) {var if_res513 = or_part1014;} else {var if_res513 = M0.not(M0.keyword_p(M0.car(ks1013)));}if (if_res513!==false) {var if_res518 = type_error1009($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1013))!==false) {var if_res517 = M0.rvoid();} else {var or_part1015 = M0.not(M0.pair_p(M0.cdr(ks1013)));if (or_part1015!==false) {var if_res514 = or_part1015;} else {var if_res514 = M0.not(M0.keyword_p(M0.cadr(ks1013)));}if (if_res514!==false) {var if_res516 = loop1012(M0.cdr(ks1013));} else {if (M0.keyword_lt__p(M0.car(ks1013),M0.cadr(ks1013))!==false) {var if_res515 = loop1012(M0.cdr(ks1013));} else {var if_res515 = type_error1009($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res516 = if_res515;}var if_res517 = if_res516;}var if_res518 = if_res517;}var if_res519 = if_res518;}return if_res519;};loop1012(kws1005);if (M0.list_p(kw_vals1006)!==false) {var if_res520 = M0.rvoid();} else {var if_res520 = type_error1009($rjs_core.UString.make("list?"),2);}if_res520;if (M0.__eq_(M0.length(kws1005),M0.length(kw_vals1006))!==false) {var if_res521 = M0.rvoid();} else {var if_res521 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1005),$rjs_core.UString.make("value list length"),M0.length(kw_vals1006),$rjs_core.UString.make("keyword list"),kws1005,$rjs_core.UString.make("value list"),kw_vals1006);}if_res521;var loop1017 = function(normal_argss1018, pos1019) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1018))!==false) {var l1020 = M0.car(normal_argss1018);if (M0.list_p(l1020)!==false) {var if_res522 = l1020;} else {var if_res522 = type_error1009($rjs_core.UString.make("list?"),pos1019);}var if_res523 = if_res522;} else {var if_res523 = M0.cons(M0.car(normal_argss1018),loop1017(M0.cdr(normal_argss1018),M0.add1(pos1019)));}return if_res523;};var normal_args1016 = loop1017(M0.cons(normal_args1007,normal_argss1008),3);if (M0.null_p(kws1005)!==false) {var if_res524 = M0.apply(proc1004,normal_args1016);} else {var if_res524 = M0.apply(keyword_procedure_extract_by_method(kws1005,2+M0.length(normal_args1016),proc1004,0),kws1005,kw_vals1006,normal_args1016);}return if_res524;});var procedure_keywords = function(p1021) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1021)!==false) {var if_res529 = M0.values(keyword_procedure_required(p1021),keyword_procedure_allowed(p1021));} else {if (M0.procedure_p(p1021)!==false) {if (new_procedure_p(p1021)!==false) {var v1022 = new_procedure_ref(p1021);if (M0.procedure_p(v1022)!==false) {var if_res526 = procedure_keywords(v1022);} else {var a1023 = procedure_accessor_ref(p1021);if (a1023!==false) {var if_res525 = procedure_keywords(a1023(p1021));} else {var if_res525 = M0.values(M0.rnull,M0.rnull);}var if_res526 = if_res525;}var if_res527 = if_res526;} else {var if_res527 = M0.values(M0.rnull,M0.rnull);}var if_res528 = if_res527;} else {var if_res528 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1021);}var if_res529 = if_res528;}return if_res529;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1024, ...args1025530) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1025 = $rjs_core.Pair.listFromArray(args1025530);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1024,0),M0.rnull,M0.rnull,args1025);});var check_kw_args = function(p1026, kws1027) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1028 = function(kws1029, required1030, allowed1031) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1029)!==false) {if (M0.null_p(required1030)!==false) {var if_res531 = M0.values(false,false);} else {var if_res531 = M0.values(M0.car(required1030),false);}var if_res540 = if_res531;} else {if (M0.pair_p(required1030)!==false) {var if_res532 = M0.eq_p(M0.car(required1030),M0.car(kws1029));} else {var if_res532 = false;}if (if_res532!==false) {var temp535 = M0.cdr(kws1029);var temp534 = M0.cdr(required1030);if (allowed1031!==false) {var if_res533 = M0.cdr(allowed1031);} else {var if_res533 = false;}var if_res539 = loop1028(temp535,temp534,if_res533);} else {if (M0.not(allowed1031)!==false) {var if_res538 = loop1028(M0.cdr(kws1029),required1030,false);} else {if (M0.pair_p(allowed1031)!==false) {if (M0.eq_p(M0.car(allowed1031),M0.car(kws1029))!==false) {var if_res536 = loop1028(M0.cdr(kws1029),required1030,M0.cdr(allowed1031));} else {var if_res536 = loop1028(kws1029,required1030,M0.cdr(allowed1031));}var if_res537 = if_res536;} else {var if_res537 = M0.values(false,M0.car(kws1029));}var if_res538 = if_res537;}var if_res539 = if_res538;}var if_res540 = if_res539;}return if_res540;};return loop1028(kws1027,keyword_procedure_required(p1026),keyword_procedure_allowed(p1026));};var make_keyword_checker = function(req_kws1032, allowed_kws1033, arity_mask1034) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1033)!==false) {if (M0.null_p(req_kws1032)!==false) {var if_res543 = function(kws1035, a1036) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res541 = M0.bitwise_bit_set_p(arity_mask1034,a1036);} else {var if_res541 = false;}return if_res541;};} else {var if_res543 = function(kws1037, a1038) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1032,kws1037)!==false) {var if_res542 = M0.bitwise_bit_set_p(arity_mask1034,a1038);} else {var if_res542 = false;}return if_res542;};}var if_res556 = if_res543;} else {if (M0.null_p(allowed_kws1033)!==false) {var if_res555 = function(kws1039, a1040) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1039)!==false) {var if_res544 = M0.bitwise_bit_set_p(arity_mask1034,a1040);} else {var if_res544 = false;}return if_res544;};} else {if (M0.null_p(req_kws1032)!==false) {var if_res554 = function(kws1041, a1042) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1041,allowed_kws1033)!==false) {var if_res545 = M0.bitwise_bit_set_p(arity_mask1034,a1042);} else {var if_res545 = false;}return if_res545;};} else {if (M0.list_p(req_kws1032)!==false) {if (M0.list_p(allowed_kws1033)!==false) {var if_res546 = M0.eq_p(M0.length(req_kws1032),M0.length(allowed_kws1033));} else {var if_res546 = false;}var if_res547 = if_res546;} else {var if_res547 = false;}if (if_res547!==false) {var if_res553 = function(kws1043, a1044) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1045 = function(kws1046, req_kws1047) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1047)!==false) {var if_res550 = M0.null_p(kws1046);} else {if (M0.null_p(kws1046)!==false) {var if_res549 = false;} else {if (M0.eq_p(M0.car(kws1046),M0.car(req_kws1047))!==false) {var if_res548 = loop1045(M0.cdr(kws1046),M0.cdr(req_kws1047));} else {var if_res548 = false;}var if_res549 = if_res548;}var if_res550 = if_res549;}return if_res550;};if (loop1045(kws1043,req_kws1032)!==false) {var if_res551 = M0.bitwise_bit_set_p(arity_mask1034,a1044);} else {var if_res551 = false;}return if_res551;};} else {var if_res553 = function(kws1048, a1049) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1032,kws1048,allowed_kws1033)!==false) {var if_res552 = M0.bitwise_bit_set_p(arity_mask1034,a1049);} else {var if_res552 = false;}return if_res552;};}var if_res554 = if_res553;}var if_res555 = if_res554;}var if_res556 = if_res555;}return if_res556;};var subset_p = function(l11050, l21051) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11050)!==false) {var if_res559 = true;} else {if (M0.null_p(l21051)!==false) {var if_res558 = false;} else {if (M0.eq_p(M0.car(l11050),M0.car(l21051))!==false) {var if_res557 = subset_p(M0.cdr(l11050),M0.cdr(l21051));} else {var if_res557 = subset_p(l11050,M0.cdr(l21051));}var if_res558 = if_res557;}var if_res559 = if_res558;}return if_res559;};var subsets_p = function(l11052, l21053, l31054) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11052)!==false) {var if_res564 = subset_p(l21053,l31054);} else {if (M0.null_p(l21053)!==false) {var if_res563 = false;} else {if (M0.null_p(l31054)!==false) {var if_res562 = false;} else {var v21055 = M0.car(l21053);if (M0.eq_p(M0.car(l11052),v21055)!==false) {var if_res561 = subsets_p(M0.cdr(l11052),M0.cdr(l21053),M0.cdr(l31054));} else {if (M0.eq_p(v21055,M0.car(l31054))!==false) {var if_res560 = subsets_p(l11052,M0.cdr(l21053),M0.cdr(l31054));} else {var if_res560 = subsets_p(l11052,l21053,M0.cdr(l31054));}var if_res561 = if_res560;}var if_res562 = if_res561;}var if_res563 = if_res562;}var if_res564 = if_res563;}return if_res564;};var keyword_procedure_extract_by_method = function(kws1056, n1057, p1058, method_n1059) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1058)!==false) {var if_res565 = keyword_procedure_checker(p1058)(kws1056,n1057);} else {var if_res565 = false;}if (if_res565!==false) {var if_res595 = keyword_procedure_proc(p1058);} else {if (M0.not(keyword_procedure_p(p1058))!==false) {if (M0.procedure_p(p1058)!==false) {if (new_procedure_p(p1058)!==false) {var a1062 = procedure_accessor_ref(p1058);if (a1062!==false) {var if_res566 = a1062(p1058);} else {var if_res566 = false;}var if_res567 = if_res566;} else {var if_res567 = false;}var or_part1061 = if_res567;if (or_part1061!==false) {var if_res570 = or_part1061;} else {var or_part1063 = M0.procedure_extract_target(p1058);if (or_part1063!==false) {var if_res569 = or_part1063;} else {if (new_procedure_p(p1058)!==false) {var if_res568 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res568 = false;}var if_res569 = if_res568;}var if_res570 = if_res569;}var if_res571 = if_res570;} else {var if_res571 = false;}var if_res572 = if_res571;} else {var if_res572 = false;}var p21060 = if_res572;if (p21060!==false) {if (M0.eq_p(p21060,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31064 = keyword_procedure_extract_by_method(kws1056,M0.add1(n1057),new_procedure_ref(p1058),M0.add1(method_n1059));var if_res574 = $rjs_core.attachProcedureArity(function(kws1065, kw_args1066, ...args1067573) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1067 = $rjs_core.Pair.listFromArray(args1067573);return M0.apply(p31064,kws1065,kw_args1066,M0.cons(p1058,args1067));});} else {var if_res574 = keyword_procedure_extract_by_method(kws1056,n1057,p21060,method_n1059);}var if_res594 = if_res574;} else {var if_res594 = $rjs_core.attachProcedureArity(function(kws1068, kw_args1069, ...args1070575) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1070 = $rjs_core.Pair.listFromArray(args1070575);if (keyword_procedure_p(p1058)!==false) {var if_res576 = check_kw_args(p1058,kws1068);} else {var if_res576 = M0.values(false,M0.car(kws1068));}var let_result577 = if_res576;var missing_kw1071 = let_result577.getAt(0);var extra_kw1072 = let_result577.getAt(1);var or_part1077 = keyword_method_p(p1058);if (or_part1077!==false) {var if_res578 = or_part1077;} else {var if_res578 = okm_p(p1058);}if (if_res578!==false) {var if_res579 = 1;} else {var if_res579 = 0;}var method_n1076 = method_n1059+if_res579;if (M0.__gt__eq_(n1057,method_n1076)!==false) {var if_res580 = n1057-method_n1076;} else {var if_res580 = n1057;}var n1073 = if_res580;if (M0.null_p(args1070)!==false) {var if_res581 = M0.null_p(kws1068);} else {var if_res581 = false;}if (if_res581!==false) {var if_res582 = $rjs_core.UString.make("");} else {var if_res582 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1078) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1078);},args1070),M0.map(function(kw1079, kw_arg1080) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1079,kw_arg1080);},kws1068,kw_args1069)));}var args_str1074 = if_res582;var proc_name1075 = function(p1081) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1081)!==false) {var if_res583 = M0.car(keyword_procedure_name_plus_fail(p1081));} else {var if_res583 = false;}var or_part1082 = if_res583;if (or_part1082!==false) {var if_res585 = or_part1082;} else {var or_part1083 = M0.object_name(p1081);if (or_part1083!==false) {var if_res584 = or_part1083;} else {var if_res584 = p1081;}var if_res585 = if_res584;}return if_res585;};var or_part1084 = extra_kw1072;if (or_part1084!==false) {var if_res592 = or_part1084;} else {var if_res592 = missing_kw1071;}if (if_res592!==false) {var if_res593 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res593 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1072!==false) {if (keyword_procedure_p(p1058)!==false) {var if_res587 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1075(p1058),extra_kw1072,args_str1074);} else {if (M0.procedure_p(p1058)!==false) {var if_res586 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1075(p1058),args_str1074);} else {var if_res586 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1058,args_str1074);}var if_res587 = if_res586;}var if_res591 = if_res587;} else {if (missing_kw1071!==false) {var if_res590 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1075(p1058),missing_kw1071,args_str1074);} else {var temp589 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1073-2)!==false) {var if_res588 = $rjs_core.UString.make("");} else {var if_res588 = $rjs_core.UString.make("s");}var if_res590 = M0.format(temp589,n1073-2,if_res588,proc_name1075(p1058),args_str1074);}var if_res591 = if_res590;}return M0.raise(if_res593(if_res591,M0.current_continuation_marks()));});}var if_res595 = if_res594;}return if_res595;};var keyword_procedure_extract = function(p1085, kws1086, n1087) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1086,n1087,p1085,0);};var cl596 = function(proc1088, arity1089, req_kw1090, allowed_kw1091, name1092) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1088,arity1089,false,name1092,req_kw1090,allowed_kw1091);};var cl597 = function(proc1093, arity1094, req_kw1095, allowed_kw1096) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1093,arity1094,false,false,req_kw1095,allowed_kw1096);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam598 = {'5':cl596,'4':cl597}[arguments.length];if (fixed_lam598!==undefined) {return fixed_lam598.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl599 = function(proc1097, mask1098, req_kw1099, allowed_kw1100, name1101) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1097,false,mask1098,name1101,req_kw1099,allowed_kw1100);};var cl600 = function(proc1102, mask1103, req_kw1104, allowed_kw1105) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1102,false,mask1103,false,req_kw1104,allowed_kw1105);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam601 = {'5':cl599,'4':cl600}[arguments.length];if (fixed_lam601!==undefined) {return fixed_lam601.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1106, proc1107, arity1108, mask1109, name1110, req_kw1111, allowed_kw1112) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1107)!==false) {var if_res602 = okp_ref(proc1107,0);} else {var if_res602 = proc1107;}var p1114 = if_res602;if (arity1108!==false) {var if_res603 = M0.__rjs_quoted__.procedure_reduce_arity(p1114,arity1108);} else {var if_res603 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1114,mask1109,name1110);}var plain_proc1113 = if_res603;var sorted_p1115 = function(kws1116) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1117 = function(kws1118) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1118)!==false) {var if_res606 = true;} else {if (M0.null_p(M0.cdr(kws1118))!==false) {var if_res605 = true;} else {if (M0.keyword_lt__p(M0.car(kws1118),M0.cadr(kws1118))!==false) {var if_res604 = loop1117(M0.cdr(kws1118));} else {var if_res604 = false;}var if_res605 = if_res604;}var if_res606 = if_res605;}return if_res606;};return loop1117(kws1116);};if (M0.list_p(req_kw1111)!==false) {if (M0.andmap(M0.keyword_p,req_kw1111)!==false) {var if_res607 = sorted_p1115(req_kw1111);} else {var if_res607 = false;}var if_res608 = if_res607;} else {var if_res608 = false;}if (if_res608!==false) {var if_res611 = M0.rvoid();} else {var temp610 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1119 = arity1108;if (or_part1119!==false) {var if_res609 = or_part1119;} else {var if_res609 = mask1109;}var if_res611 = M0.raise_argument_error(who1106,temp610,2,proc1107,if_res609,req_kw1111,allowed_kw1112);}if_res611;if (allowed_kw1112!==false) {if (M0.list_p(allowed_kw1112)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1112)!==false) {var if_res612 = sorted_p1115(allowed_kw1112);} else {var if_res612 = false;}var if_res613 = if_res612;} else {var if_res613 = false;}if (if_res613!==false) {var if_res616 = M0.rvoid();} else {var temp615 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1120 = arity1108;if (or_part1120!==false) {var if_res614 = or_part1120;} else {var if_res614 = mask1109;}var if_res616 = M0.raise_argument_error(who1106,temp615,3,proc1107,if_res614,req_kw1111,allowed_kw1112);}if_res616;if (subset_p(req_kw1111,allowed_kw1112)!==false) {var if_res617 = M0.rvoid();} else {var if_res617 = M0.raise_arguments_error(who1106,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1112,$rjs_core.UString.make("required keywords"),req_kw1111);}var if_res618 = if_res617;} else {var if_res618 = M0.rvoid();}if_res618;var let_result619 = procedure_keywords(proc1107);var old_req1121 = let_result619.getAt(0);var old_allowed1122 = let_result619.getAt(1);if (subset_p(old_req1121,req_kw1111)!==false) {var if_res620 = M0.rvoid();} else {var if_res620 = M0.raise_arguments_error(who1106,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1121,$rjs_core.UString.make("requested required keywords"),req_kw1111);}if_res620;if (old_allowed1122!==false) {if (subset_p(req_kw1111,old_allowed1122)!==false) {var if_res621 = M0.rvoid();} else {var if_res621 = M0.raise_arguments_error(who1106,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1122,$rjs_core.UString.make("requested required keywords"),req_kw1111);}if_res621;var or_part1123 = M0.not(allowed_kw1112);if (or_part1123!==false) {var if_res622 = or_part1123;} else {var if_res622 = subset_p(allowed_kw1112,old_allowed1122);}if (if_res622!==false) {var if_res623 = M0.rvoid();} else {var if_res623 = M0.raise_arguments_error(who1106,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1122,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1112);}var if_res624 = if_res623;} else {var if_res624 = M0.rvoid();}if_res624;if (M0.null_p(allowed_kw1112)!==false) {var if_res632 = plain_proc1113;} else {var or_part1125 = mask1109;if (or_part1125!==false) {var if_res625 = or_part1125;} else {var if_res625 = arity__gt_mask(arity1108);}var mask1124 = if_res625;var new_mask1126 = M0.arithmetic_shift(mask1124,2);var kw_checker1127 = make_keyword_checker(req_kw1111,allowed_kw1112,new_mask1126);var proc1128 = normalize_proc(proc1107);var new_kw_proc1129 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1128),new_mask1126);if (M0.null_p(req_kw1111)!==false) {if (okm_p(proc1128)!==false) {var if_res626 = make_optional_keyword_method;} else {var if_res626 = make_optional_keyword_procedure;}var if_res631 = if_res626(kw_checker1127,new_kw_proc1129,req_kw1111,allowed_kw1112,plain_proc1113);} else {if (named_keyword_procedure_p(proc1128)!==false) {var if_res629 = M0.car(keyword_procedure_name_plus_fail(proc1128));} else {var if_res629 = false;}var or_part1130 = if_res629;if (or_part1130!==false) {var if_res630 = or_part1130;} else {var if_res630 = M0.object_name(proc1128);}var temp628 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1124,1));var or_part1131 = okm_p(proc1128);if (or_part1131!==false) {var if_res627 = or_part1131;} else {var if_res627 = keyword_method_p(proc1128);}var if_res631 = make_required(if_res630,temp628,if_res627,false)(kw_checker1127,new_kw_proc1129,req_kw1111,allowed_kw1112);}var if_res632 = if_res631;}return if_res632;};var arity__gt_mask = function(a1132) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1132)!==false) {var if_res638 = M0.arithmetic_shift(1,a1132);} else {if (M0.arity_at_least_p(a1132)!==false) {var if_res637 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1132))));} else {if (M0.list_p(a1132)!==false) {var loop1133 = function(mask1134, l1135) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1135)!==false) {var if_res635 = mask1134;} else {var a1136 = M0.car(l1135);var or_part1137 = M0.exact_nonnegative_integer_p(a1136);if (or_part1137!==false) {var if_res633 = or_part1137;} else {var if_res633 = M0.arity_at_least_p(a1136);}if (if_res633!==false) {var if_res634 = loop1133(M0.bitwise_ior(mask1134,arity__gt_mask(a1136)),M0.cdr(l1135));} else {var if_res634 = false;}var if_res635 = if_res634;}return if_res635;};var if_res636 = loop1133(0,a1132);} else {var if_res636 = false;}var if_res637 = if_res636;}var if_res638 = if_res637;}return if_res638;};var cl639 = function(proc1139, arity1140, name1141) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1139)!==false) {var let_result642 = procedure_keywords(proc1139);var req1142 = let_result642.getAt(0);var allows1143 = let_result642.getAt(1);if (M0.pair_p(req1142)!==false) {var if_res643 = M0.not(M0.null_p(arity1140));} else {var if_res643 = false;}var if_res644 = if_res643;} else {var if_res644 = false;}if (if_res644!==false) {var if_res646 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1139);} else {if (okm_p(proc1139)!==false) {var if_res645 = M0.__rjs_quoted__.procedure__gt_method(proc1139);} else {var if_res645 = proc1139;}var if_res646 = M0.__rjs_quoted__.procedure_reduce_arity(if_res645,arity1140,name1141);}return if_res646;};var cl640 = function(proc1144, arity1145) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1144,arity1145,false);};var procedure_reduce_arity1138 = $rjs_core.attachProcedureArity(function() {var fixed_lam641 = {'3':cl639,'2':cl640}[arguments.length];if (fixed_lam641!==undefined) {return fixed_lam641.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1138;var cl647 = function(proc1147, mask1148, name1149) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1147)!==false) {var let_result650 = procedure_keywords(proc1147);var req1150 = let_result650.getAt(0);var allows1151 = let_result650.getAt(1);if (M0.pair_p(req1150)!==false) {var if_res651 = M0.not(M0.eqv_p(mask1148,0));} else {var if_res651 = false;}var if_res652 = if_res651;} else {var if_res652 = false;}if (if_res652!==false) {var if_res654 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1147);} else {if (okm_p(proc1147)!==false) {var if_res653 = M0.__rjs_quoted__.procedure__gt_method(proc1147);} else {var if_res653 = proc1147;}var if_res654 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res653,mask1148,name1149);}return if_res654;};var cl648 = function(proc1152, mask1153) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1152,mask1153,false);};var procedure_reduce_arity1146 = $rjs_core.attachProcedureArity(function() {var fixed_lam649 = {'3':cl647,'2':cl648}[arguments.length];if (fixed_lam649!==undefined) {return fixed_lam649.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1146;var procedure__gt_method1154 = function(proc1155) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1156 = normalize_proc(proc1155);if (keyword_procedure_p(proc1156)!==false) {if (okm_p(proc1156)!==false) {var if_res657 = proc1156;} else {if (keyword_method_p(proc1156)!==false) {var if_res656 = proc1156;} else {if (okp_p(proc1156)!==false) {var if_res655 = make_optional_keyword_method(keyword_procedure_checker(proc1156),keyword_procedure_proc(proc1156),keyword_procedure_required(proc1156),keyword_procedure_allowed(proc1156),okp_ref(proc1156,0));} else {var name_plus_fail1157 = keyword_procedure_name_plus_fail(proc1156);var mk1158 = make_required(M0.car(name_plus_fail1157),M0.cdr(name_plus_fail1157),true,false);var if_res655 = mk1158(keyword_procedure_checker(proc1156),keyword_procedure_proc(proc1156),keyword_procedure_required(proc1156),keyword_procedure_allowed(proc1156));}var if_res656 = if_res655;}var if_res657 = if_res656;}var if_res658 = if_res657;} else {var if_res658 = M0.__rjs_quoted__.procedure__gt_method(proc1156);}return if_res658;};var new_procedure__gt_method = procedure__gt_method1154;var procedure_rename1159 = function(proc1160, name1161) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1160)!==false) {var if_res659 = M0.symbol_p(name1161);} else {var if_res659 = false;}if (M0.not(if_res659)!==false) {var if_res662 = M0.__rjs_quoted__.procedure_rename(proc1160,name1161);} else {if (okp_p(proc1160)!==false) {if (okm_p(proc1160)!==false) {var if_res660 = make_optional_keyword_method;} else {var if_res660 = make_optional_keyword_procedure;}var if_res661 = if_res660(keyword_procedure_checker(proc1160),keyword_procedure_proc(proc1160),keyword_procedure_required(proc1160),keyword_procedure_allowed(proc1160),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1160,0),name1161));} else {var name_plus_fail1162 = keyword_procedure_name_plus_fail(proc1160);var mk1163 = make_required(name1161,M0.cdr(name_plus_fail1162),keyword_method_p(proc1160),false);var if_res661 = mk1163(keyword_procedure_checker(proc1160),keyword_procedure_proc(proc1160),keyword_procedure_required(proc1160),keyword_procedure_allowed(proc1160));}var if_res662 = if_res661;}return if_res662;};var new_procedure_rename = procedure_rename1159;var chaperone_procedure1164 = $rjs_core.attachProcedureArity(function(proc1165, wrap_proc1166, ...props1167663) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1167 = $rjs_core.Pair.listFromArray(props1167663);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1165,wrap_proc1166,props1167);});var new_chaperone_procedure = chaperone_procedure1164;var unsafe_chaperone_procedure1168 = $rjs_core.attachProcedureArity(function(proc1169, wrap_proc1170, ...props1171664) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1171 = $rjs_core.Pair.listFromArray(props1171664);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1169,wrap_proc1170,props1171);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1168;var impersonate_procedure1172 = $rjs_core.attachProcedureArity(function(proc1173, wrap_proc1174, ...props1175665) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1175 = $rjs_core.Pair.listFromArray(props1175665);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1173,wrap_proc1174,props1175);});var new_impersonate_procedure = impersonate_procedure1172;var unsafe_impersonate_procedure1176 = $rjs_core.attachProcedureArity(function(proc1177, wrap_proc1178, ...props1179666) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1179 = $rjs_core.Pair.listFromArray(props1179666);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1177,wrap_proc1178,props1179);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1176;var chaperone_procedure_times_1180 = $rjs_core.attachProcedureArity(function(proc1181, wrap_proc1182, ...props1183667) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1183 = $rjs_core.Pair.listFromArray(props1183667);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1181,wrap_proc1182,props1183);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1180;var impersonate_procedure_times_1184 = $rjs_core.attachProcedureArity(function(proc1185, wrap_proc1186, ...props1187668) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1187 = $rjs_core.Pair.listFromArray(props1187668);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1185,wrap_proc1186,props1187);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1184;var do_chaperone_procedure = function(is_impersonator_p1188, self_arg_p1189, chaperone_procedure1190, name1191, proc1192, wrap_proc1193, props1194) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1195 = normalize_proc(proc1192);var n_wrap_proc1196 = normalize_proc(wrap_proc1193);var or_part1197 = M0.not(keyword_procedure_p(n_proc1195));if (or_part1197!==false) {var if_res670 = or_part1197;} else {var or_part1198 = M0.not(M0.procedure_p(wrap_proc1193));if (or_part1198!==false) {var if_res669 = or_part1198;} else {var if_res669 = bad_props_p(props1194);}var if_res670 = if_res669;}if (if_res670!==false) {var if_res737 = M0.apply(chaperone_procedure1190,proc1192,wrap_proc1193,props1194);} else {chaperone_arity_match_checking(self_arg_p1189,name1191,proc1192,wrap_proc1193,props1194);var loop1200 = function(props1201) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1201)!==false) {var if_res672 = false;} else {if (M0.eq_p(M0.car(props1201),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res671 = M0.cadr(props1201);} else {var if_res671 = loop1200(M0.cddr(props1201));}var if_res672 = if_res671;}return if_res672;};var mark_prop1199 = loop1200(props1194);var chaperone_procedure_by_add_mark1202 = function(proc1203, wrap_proc1204) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1199!==false) {var if_res673 = chaperone_procedure1190(proc1203,wrap_proc1204,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1199);} else {var if_res673 = chaperone_procedure1190(proc1203,wrap_proc1204);}return if_res673;};var p1206 = keyword_procedure_proc(n_wrap_proc1196);if (self_arg_p1189!==false) {var cl674 = $rjs_core.attachProcedureArity(function(self_proc1207, kws1208, args1209, ...rest1210679) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1210 = $rjs_core.Pair.listFromArray(rest1210679);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1206,kws1208,args1209,self_proc1207,rest1210);},$rjs_core.attachProcedureArity(function(...results1211680) {var results1211 = $rjs_core.Pair.listFromArray(results1211680);var len1212 = M0.length(results1211);var alen1213 = M0.length(rest1210);if (M0.__lt_(len1212,alen1213+1)!==false) {var if_res681 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1213+1,$rjs_core.UString.make("received number of results"),len1212,$rjs_core.UString.make("wrapper procedure"),wrap_proc1193);} else {var if_res681 = M0.rvoid();}if_res681;var num_extra1214 = len1212-(alen1213+1);var new_args1215 = M0.list_ref(results1211,num_extra1214);if (M0.list_p(new_args1215)!==false) {var if_res682 = M0.__eq_(M0.length(new_args1215),M0.length(args1209));} else {var if_res682 = false;}if (if_res682!==false) {var if_res686 = M0.rvoid();} else {var temp685 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp684 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1212,alen1213)!==false) {var if_res683 = $rjs_core.UString.make("");} else {var if_res683 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res686 = M0.raise_arguments_error(temp685,M0.format(temp684,if_res683),$rjs_core.UString.make("first result"),new_args1215,$rjs_core.UString.make("wrapper procedure"),wrap_proc1193);}if_res686;M0.for_each(function(kw1216, new_arg1217, arg1218) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1188!==false) {var if_res688 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1217,arg1218)!==false) {var if_res687 = M0.rvoid();} else {var if_res687 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1216),$rjs_core.UString.make("result"),new_arg1217,$rjs_core.UString.make("wrapper procedure"),wrap_proc1193);}var if_res688 = if_res687;}return if_res688;},kws1208,new_args1215,args1209);var tmp1219 = num_extra1214;if (M0.equal_p(tmp1219,0)!==false) {var if_res691 = M0.apply(M0.values,kws1208,results1211);} else {if (M0.equal_p(tmp1219,1)!==false) {var if_res690 = M0.apply(M0.values,M0.car(results1211),kws1208,M0.cdr(results1211));} else {var loop1220 = function(results1221, c1222) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1222)!==false) {var if_res689 = M0.cons(kws1208,results1221);} else {var if_res689 = M0.cons(M0.car(results1221),loop1220(M0.cdr(results1221),M0.sub1(c1222)));}return if_res689;};var if_res690 = M0.apply(M0.values,loop1220(results1211,num_extra1214));}var if_res691 = if_res690;}return if_res691;}));});var cl675 = $rjs_core.attachProcedureArity(function(...other1223692) {var other1223 = $rjs_core.Pair.listFromArray(other1223692);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res712 = $rjs_core.attachProcedureArity(function() {var fixed_lam676 = {}[arguments.length];if (fixed_lam676!==undefined) {return fixed_lam676.apply(null,arguments);} else {if (M0.__gt__eq_(cl674.length,1)!==false) {var if_res678 = cl674.apply(null,arguments);} else {if (true!==false) {var if_res677 = cl675.apply(null,arguments);} else {var if_res677 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res678 = if_res677;}return if_res678;}},[M0.make_arity_at_least(0)]);} else {var cl693 = $rjs_core.attachProcedureArity(function(kws1224, args1225, ...rest1226698) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1226 = $rjs_core.Pair.listFromArray(rest1226698);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1206,kws1224,args1225,rest1226);},$rjs_core.attachProcedureArity(function(...results1227699) {var results1227 = $rjs_core.Pair.listFromArray(results1227699);var len1228 = M0.length(results1227);var alen1229 = M0.length(rest1226);if (M0.__lt_(len1228,alen1229+1)!==false) {var if_res700 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1229+1,$rjs_core.UString.make("received number of results"),len1228,$rjs_core.UString.make("wrapper procedure"),wrap_proc1193);} else {var if_res700 = M0.rvoid();}if_res700;var num_extra1230 = len1228-(alen1229+1);var new_args1231 = M0.list_ref(results1227,num_extra1230);if (M0.list_p(new_args1231)!==false) {var if_res701 = M0.__eq_(M0.length(new_args1231),M0.length(args1225));} else {var if_res701 = false;}if (if_res701!==false) {var if_res705 = M0.rvoid();} else {var temp704 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp703 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1228,alen1229)!==false) {var if_res702 = $rjs_core.UString.make("");} else {var if_res702 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res705 = M0.raise_arguments_error(temp704,M0.format(temp703,if_res702),$rjs_core.UString.make("first result"),new_args1231,$rjs_core.UString.make("wrapper procedure"),wrap_proc1193);}if_res705;M0.for_each(function(kw1232, new_arg1233, arg1234) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1188!==false) {var if_res707 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1233,arg1234)!==false) {var if_res706 = M0.rvoid();} else {var if_res706 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1232),$rjs_core.UString.make("result"),new_arg1233,$rjs_core.UString.make("wrapper procedure"),wrap_proc1193);}var if_res707 = if_res706;}return if_res707;},kws1224,new_args1231,args1225);var tmp1235 = num_extra1230;if (M0.equal_p(tmp1235,0)!==false) {var if_res710 = M0.apply(M0.values,kws1224,results1227);} else {if (M0.equal_p(tmp1235,1)!==false) {var if_res709 = M0.apply(M0.values,M0.car(results1227),kws1224,M0.cdr(results1227));} else {var loop1236 = function(results1237, c1238) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1238)!==false) {var if_res708 = M0.cons(kws1224,results1237);} else {var if_res708 = M0.cons(M0.car(results1237),loop1236(M0.cdr(results1237),M0.sub1(c1238)));}return if_res708;};var if_res709 = M0.apply(M0.values,loop1236(results1227,num_extra1230));}var if_res710 = if_res709;}return if_res710;}));});var cl694 = $rjs_core.attachProcedureArity(function(...other1239711) {var other1239 = $rjs_core.Pair.listFromArray(other1239711);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res712 = $rjs_core.attachProcedureArity(function() {var fixed_lam695 = {}[arguments.length];if (fixed_lam695!==undefined) {return fixed_lam695.apply(null,arguments);} else {if (M0.__gt__eq_(cl693.length,1)!==false) {var if_res697 = cl693.apply(null,arguments);} else {if (true!==false) {var if_res696 = cl694.apply(null,arguments);} else {var if_res696 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res697 = if_res696;}return if_res697;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1205 = if_res712;var wrap1242 = function(proc1243, n_proc1244) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1244,proc1243))!==false) {var if_res713 = new_procedure_p(proc1243);} else {var if_res713 = false;}if (if_res713!==false) {var v1245 = new_procedure_ref(proc1243);if (M0.exact_integer_p(v1245)!==false) {var acc1246 = procedure_accessor_ref(proc1243);var if_res729 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1243,acc1246,function(self1247, sub_proc1248) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result714 = wrap1242(sub_proc1248,normalize_proc(sub_proc1248));var f1249 = let_result714.getAt(0);var acc1250 = let_result714.getAt(1);return f1249;}),acc1246);} else {if (is_impersonator_p1188!==false) {var if_res728 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res728 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1244)!==false) {var if_res727 = chaperone_procedure_by_add_mark1202(proc1243,wrap_proc1193);} else {var if_res727 = proc1243;}var new_kw_proc1251 = if_res728(if_res727,new_procedure_ref,function(self1252, proc1253) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1188!==false) {var if_res726 = new_impersonate_procedure;} else {var if_res726 = new_chaperone_procedure;}if (self_arg_p1189!==false) {var if_res725 = $rjs_core.attachProcedureArity(function(proc_self1254, kws1255, kw_args1256, self1257, ...args1258715) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1258 = $rjs_core.Pair.listFromArray(args1258715);var len1259 = M0.length(args1258);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1205,proc_self1254,kws1255,kw_args1256,args1258);},$rjs_core.attachProcedureArity(function(...results1260716) {var results1260 = $rjs_core.Pair.listFromArray(results1260716);var r_len1261 = M0.length(results1260);var list_take1262 = function(l1263, n1264) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1264)!==false) {var if_res717 = M0.rnull;} else {var if_res717 = M0.cons(M0.car(l1263),list_take1262(M0.cdr(l1263),M0.sub1(n1264)));}return if_res717;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res718 = M0.__eq_(r_len1261,2+len1259);} else {var if_res718 = false;}if (if_res718!==false) {var if_res719 = M0.apply(M0.values,M0.cadr(results1260),self1257,M0.cddr(results1260));} else {var skip1265 = r_len1261-len1259;var if_res719 = M0.apply(M0.values,M0.append(list_take1262(results1260,skip1265-2),M0.list(M0.list_ref(results1260,M0.sub1(skip1265)),self1257),M0.__rjs_quoted__.list_tail(results1260,skip1265)));}return if_res719;}));});} else {var if_res725 = $rjs_core.attachProcedureArity(function(kws1266, kw_args1267, self1268, ...args1269720) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1269 = $rjs_core.Pair.listFromArray(args1269720);var len1270 = M0.length(args1269);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1205,kws1266,kw_args1267,args1269);},$rjs_core.attachProcedureArity(function(...results1271721) {var results1271 = $rjs_core.Pair.listFromArray(results1271721);var r_len1272 = M0.length(results1271);var list_take1273 = function(l1274, n1275) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1275)!==false) {var if_res722 = M0.rnull;} else {var if_res722 = M0.cons(M0.car(l1274),list_take1273(M0.cdr(l1274),M0.sub1(n1275)));}return if_res722;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res723 = M0.__eq_(r_len1272,2+len1270);} else {var if_res723 = false;}if (if_res723!==false) {var if_res724 = M0.apply(M0.values,M0.cadr(results1271),self1268,M0.cddr(results1271));} else {var skip1276 = r_len1272-len1270;var if_res724 = M0.apply(M0.values,M0.append(list_take1273(results1271,skip1276-2),M0.list(M0.list_ref(results1271,M0.sub1(skip1276)),self1268),M0.__rjs_quoted__.list_tail(results1271,skip1276)));}return if_res724;}));});}return if_res726(proc1253,make_keyword_procedure(if_res725));});var if_res729 = M0.values(new_kw_proc1251,new_procedure_ref);}var if_res734 = if_res729;} else {if (okp_p(n_proc1244)!==false) {if (is_impersonator_p1188!==false) {if (okm_p(n_proc1244)!==false) {var if_res730 = make_optional_keyword_method_impersonator;} else {var if_res730 = make_optional_keyword_procedure_impersonator;}var if_res731 = if_res730(keyword_procedure_checker(n_proc1244),chaperone_procedure_by_add_mark1202(keyword_procedure_proc(n_proc1244),kw_chaperone1205),keyword_procedure_required(n_proc1244),keyword_procedure_allowed(n_proc1244),chaperone_procedure_by_add_mark1202(okp_ref(n_proc1244,0),okp_ref(n_wrap_proc1196,0)),n_proc1244);} else {var if_res731 = M0.__rjs_quoted__.chaperone_struct(proc1243,keyword_procedure_proc,function(self1277, proc1278) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1202(proc1278,kw_chaperone1205);},M0.make_struct_field_accessor(okp_ref,0),function(self1279, proc1280) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1202(proc1280,okp_ref(n_wrap_proc1196,0));});}var if_res733 = M0.values(if_res731,keyword_procedure_proc);} else {if (is_impersonator_p1188!==false) {var name_plus_fail1281 = keyword_procedure_name_plus_fail(n_proc1244);var mk1282 = make_required(M0.car(name_plus_fail1281),M0.cdr(name_plus_fail1281),keyword_method_p(n_proc1244),true);var if_res732 = mk1282(keyword_procedure_checker(n_proc1244),chaperone_procedure_by_add_mark1202(keyword_procedure_proc(n_proc1244),kw_chaperone1205),keyword_procedure_required(n_proc1244),keyword_procedure_allowed(n_proc1244),n_proc1244);} else {var if_res732 = M0.__rjs_quoted__.chaperone_struct(n_proc1244,keyword_procedure_proc,function(self1283, proc1284) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1202(proc1284,kw_chaperone1205);});}var if_res733 = M0.values(if_res732,keyword_procedure_proc);}var if_res734 = if_res733;}return if_res734;};var let_result735 = wrap1242(proc1192,n_proc1195);var new_proc1240 = let_result735.getAt(0);var chap_accessor1241 = let_result735.getAt(1);if (M0.null_p(props1194)!==false) {var if_res736 = new_proc1240;} else {var if_res736 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1240,chap_accessor1241,false,props1194);}var if_res737 = if_res736;}return if_res737;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1285, name1286, proc1287, wrap_proc1288, props1289) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1290 = normalize_proc(proc1287);var n_wrap_proc1291 = normalize_proc(wrap_proc1288);var or_part1292 = M0.not(keyword_procedure_p(n_proc1290));if (or_part1292!==false) {var if_res739 = or_part1292;} else {var or_part1293 = M0.not(M0.procedure_p(wrap_proc1288));if (or_part1293!==false) {var if_res738 = or_part1293;} else {var if_res738 = bad_props_p(props1289);}var if_res739 = if_res738;}if (if_res739!==false) {var if_res740 = M0.apply(unsafe_chaperone_procedure1285,proc1287,wrap_proc1288,props1289);} else {chaperone_arity_match_checking(false,name1286,proc1287,wrap_proc1288,props1289);var if_res740 = M0.apply(unsafe_chaperone_procedure1285,proc1287,wrap_proc1288,props1289);}return if_res740;};var bad_props_p = function(props1294) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1295 = function(props1296) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1296)!==false) {var if_res743 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1296))!==false) {var props1297 = M0.cdr(props1296);var or_part1298 = M0.null_p(props1297);if (or_part1298!==false) {var if_res741 = or_part1298;} else {var if_res741 = loop1295(M0.cdr(props1297));}var if_res742 = if_res741;} else {var if_res742 = true;}var if_res743 = if_res742;}return if_res743;};return loop1295(props1294);};var chaperone_arity_match_checking = function(self_arg_p1299, name1300, proc1301, wrap_proc1302, props1303) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1304 = M0.procedure_arity(proc1301);var b1305 = M0.procedure_arity(wrap_proc1302);if (self_arg_p1299!==false) {var if_res744 = 1;} else {var if_res744 = 0;}var d1306 = if_res744;var let_result745 = procedure_keywords(proc1301);var a_req1307 = let_result745.getAt(0);var a_allow1308 = let_result745.getAt(1);var let_result746 = procedure_keywords(wrap_proc1302);var b_req1309 = let_result746.getAt(0);var b_allow1310 = let_result746.getAt(1);var includes_p1311 = function(a1312, b1313) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1313)!==false) {if (M0.number_p(a1312)!==false) {var if_res748 = M0.__eq_(b1313,a1312+d1306);} else {if (M0.arity_at_least_p(a1312)!==false) {var if_res747 = M0.__gt__eq_(b1313,M0.arity_at_least_value(a1312)+d1306);} else {var if_res747 = M0.ormap(function(a1314) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1311(a1314,b1313);},a1312);}var if_res748 = if_res747;}var if_res752 = if_res748;} else {if (M0.arity_at_least_p(b1313)!==false) {if (M0.number_p(a1312)!==false) {var if_res750 = false;} else {if (M0.arity_at_least_p(a1312)!==false) {var if_res749 = M0.__gt__eq_(M0.arity_at_least_value(b1313),M0.arity_at_least_value(a1312)+d1306);} else {var if_res749 = M0.ormap(function(a1315) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1311(b1313,a1315);},a1312);}var if_res750 = if_res749;}var if_res751 = if_res750;} else {var if_res751 = M0.andmap(function(b1316) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1311(a1312,b1316);},b1313);}var if_res752 = if_res751;}return if_res752;};if (includes_p1311(b1305,a1304)!==false) {var if_res753 = M0.rvoid();} else {var if_res753 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1301,wrap_proc1302,props1303);}if_res753;if (subset_p(b_req1309,a_req1307)!==false) {var if_res754 = M0.rvoid();} else {var if_res754 = M0.raise_arguments_error(name1300,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1302,$rjs_core.UString.make("original procedure"),proc1301);}if_res754;var or_part1317 = M0.not(b_allow1310);if (or_part1317!==false) {var if_res756 = or_part1317;} else {if (a_allow1308!==false) {var if_res755 = subset_p(a_allow1308,b_allow1310);} else {var if_res755 = false;}var if_res756 = if_res755;}if (if_res756!==false) {var if_res757 = M0.rvoid();} else {var if_res757 = M0.raise_arguments_error(name1300,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1302,$rjs_core.UString.make("original procedure"),proc1301);}if_res757;return M0.rvoid();};var normalize_proc = function(proc1318) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1318)!==false) {var if_res765 = proc1318;} else {if (new_procedure_p(proc1318)!==false) {var let_result758 = procedure_keywords(proc1318);var req_kws1319 = let_result758.getAt(0);var allowed_kws1320 = let_result758.getAt(1);if (M0.null_p(allowed_kws1320)!==false) {var if_res763 = proc1318;} else {var if_res763 = make_optional_keyword_procedure(function(given_kws1321, given_argc1322) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1318,given_argc1322-2,true)!==false) {var or_part1323 = M0.not(allowed_kws1320);if (or_part1323!==false) {var if_res760 = or_part1323;} else {var if_res760 = subset_p(given_kws1321,allowed_kws1320);}if (if_res760!==false) {var if_res761 = subset_p(req_kws1319,given_kws1321);} else {var if_res761 = false;}var if_res762 = if_res761;} else {var if_res762 = false;}return if_res762;},$rjs_core.attachProcedureArity(function(kws1324, kw_args1325, ...vals1326759) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1326 = $rjs_core.Pair.listFromArray(vals1326759);return keyword_apply(proc1318,kws1324,kw_args1325,vals1326);}),req_kws1319,allowed_kws1320,proc1318);}var if_res764 = if_res763;} else {var if_res764 = proc1318;}var if_res765 = if_res764;}return if_res765;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };