import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result589 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result589.getAt(0);var keyword_impersonator_p = let_result589.getAt(1);var keyword_impersonator_ref = let_result589.getAt(2);var keyword_procedure_impersonator_of = function(v1092) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v1092)!==false) {var if_res590 = keyword_impersonator_ref(v1092)(v1092);} else {var if_res590 = false;}return if_res590;};var let_result591 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result591.getAt(0);var mk_kw_proc = let_result591.getAt(1);var keyword_procedure_p = let_result591.getAt(2);var keyword_procedure_ref = let_result591.getAt(3);var keyword_procedure_set_bang_ = let_result591.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result592 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result592.getAt(0);var make_km = let_result592.getAt(1);var keyword_method_p = let_result592.getAt(2);var km_ref = let_result592.getAt(3);var km_set_bang_ = let_result592.getAt(4);var generate_arity_string = function(proc1093) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result593 = procedure_keywords(proc1093);var req1094 = let_result593.getAt(0);var allowed1095 = let_result593.getAt(1);var a1096 = M0.procedure_arity(proc1093);var keywords_desc1097 = function(opt1099, req1100) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp599 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req1100))!==false) {var if_res598 = M0.format($rjs_core.UString.make("an ~aargument"),opt1099);} else {var if_res598 = M0.format($rjs_core.UString.make("~aarguments"),opt1099);}if (M0.null_p(M0.cdr(req1100))!==false) {var if_res597 = $rjs_core.UString.make("");} else {var if_res597 = $rjs_core.UString.make("s");}var tmp1101 = M0.length(req1100);if (M0.equal_p(tmp1101,1)!==false) {var if_res596 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req1100));} else {if (M0.equal_p(tmp1101,2)!==false) {var if_res595 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req1100),M0.cadr(req1100));} else {var loop1102 = function(req1103) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req1103))!==false) {var if_res594 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req1103));} else {var if_res594 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req1103),loop1102(M0.cdr(req1103)));}return if_res594;};var if_res595 = loop1102(req1100);}var if_res596 = if_res595;}return M0.format(temp599,if_res598,if_res597,if_res596);};var method_adjust1098 = function(a1104) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1105 = okm_p(proc1093);if (or_part1105!==false) {var if_res600 = or_part1105;} else {var if_res600 = keyword_method_p(proc1093);}if (if_res600!==false) {if (M0.zero_p(a1104)!==false) {var if_res601 = 0;} else {var if_res601 = M0.sub1(a1104);}var if_res602 = if_res601;} else {var if_res602 = a1104;}return if_res602;};if (M0.number_p(a1096)!==false) {var a1106 = method_adjust1098(a1096);var if_res609 = M0.format($rjs_core.UString.make("~a"),a1106);} else {if (M0.arity_at_least_p(a1096)!==false) {var a1107 = method_adjust1098(M0.arity_at_least_value(a1096));var if_res608 = M0.format($rjs_core.UString.make("at least ~a"),a1107);} else {var if_res608 = $rjs_core.UString.make("a different number");}var if_res609 = if_res608;}if (M0.null_p(req1094)!==false) {var if_res607 = $rjs_core.UString.make("");} else {var if_res607 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc1097($rjs_core.UString.make(""),req1094));}if (allowed1095!==false) {var loop1109 = function(req1110, allowed1111) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req1110)!==false) {var if_res604 = allowed1111;} else {if (M0.eq_p(M0.car(req1110),M0.car(allowed1111))!==false) {var if_res603 = loop1109(M0.cdr(req1110),M0.cdr(allowed1111));} else {var if_res603 = M0.cons(M0.car(allowed1111),loop1109(req1110,M0.cdr(allowed1111)));}var if_res604 = if_res603;}return if_res604;};var others1108 = loop1109(req1094,allowed1095);if (M0.null_p(others1108)!==false) {var if_res605 = $rjs_core.UString.make("");} else {var if_res605 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc1097($rjs_core.UString.make("optional "),others1108));}var if_res606 = if_res605;} else {var if_res606 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res609,if_res607,if_res606);};var let_result610 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result610.getAt(0);var make_optional_keyword_procedure = let_result610.getAt(1);var okp_p = let_result610.getAt(2);var okp_ref = let_result610.getAt(3);var okp_set_bang_ = let_result610.getAt(4);var let_result611 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result611.getAt(0);var make_optional_keyword_method = let_result611.getAt(1);var okm_p = let_result611.getAt(2);var okm_ref = let_result611.getAt(3);var okm_set_bang_ = let_result611.getAt(4);var let_result612 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result612.getAt(0);var named_keyword_procedure_p = let_result612.getAt(1);var keyword_procedure_name_plus_fail = let_result612.getAt(2);var let_result614 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v1112, info_l1113) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v1112)!==false) {var if_res613 = M0.make_struct_field_accessor(M0.list_ref(info_l1113,3),v1112);} else {var if_res613 = false;}return if_res613;});var prop_procedure_accessor = let_result614.getAt(0);var procedure_accessor_p = let_result614.getAt(1);var procedure_accessor_ref = let_result614.getAt(2);var let_result615 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result615.getAt(0);var new_procedure_p = let_result615.getAt(1);var new_procedure_ref = let_result615.getAt(2);var let_result616 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1114) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v1114,0);})));var struct_keyword_procedure_impersonator = let_result616.getAt(0);var make_kpp = let_result616.getAt(1);var keyword_procedure_impersonator_p = let_result616.getAt(2);var kpp_ref = let_result616.getAt(3);var kpp_set_bang_ = let_result616.getAt(4);var let_result617 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1115) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v1115,0);})));var struct_keyword_method_impersonator = let_result617.getAt(0);var make_kmp = let_result617.getAt(1);var keyword_method_impersonator_p = let_result617.getAt(2);var kmp_ref = let_result617.getAt(3);var kmp_set_bang_ = let_result617.getAt(4);var let_result618 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1116) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v1116,0);})));var struct_okpp = let_result618.getAt(0);var make_optional_keyword_procedure_impersonator = let_result618.getAt(1);var okpp_p = let_result618.getAt(2);var okpp_ref = let_result618.getAt(3);var okpp_set_bang_ = let_result618.getAt(4);var let_result619 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1117) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v1117,0);})));var struct_okmp = let_result619.getAt(0);var make_optional_keyword_method_impersonator = let_result619.getAt(1);var okmp_p = let_result619.getAt(2);var okmp_ref = let_result619.getAt(3);var okmp_set_bang_ = let_result619.getAt(4);var let_result620 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result620.getAt(0);var make_kp_by_ae = let_result620.getAt(1);var kp_by_ae_p = let_result620.getAt(2);var kp_by_ae_ref = let_result620.getAt(3);var kp_by_ae_set_bang_ = let_result620.getAt(4);var let_result621 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result621.getAt(0);var make_km_by_ae = let_result621.getAt(1);var km_by_ae_p = let_result621.getAt(2);var km_by_ae_ref = let_result621.getAt(3);var km_by_ae_set_bang_ = let_result621.getAt(4);var let_result622 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result622.getAt(0);var make_kpi_by_ae = let_result622.getAt(1);var kpi_by_ae_p = let_result622.getAt(2);var kpi_by_ae_ref = let_result622.getAt(3);var kpi_by_ae_set_bang_ = let_result622.getAt(4);var let_result623 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result623.getAt(0);var make_kmi_by_ae = let_result623.getAt(1);var kmi_by_ae_p = let_result623.getAt(2);var kmi_by_ae_ref = let_result623.getAt(3);var kmi_by_ae_set_bang_ = let_result623.getAt(4);var make_required = function(name1118, fail_proc1119, method_p1120, impersonator_p1121) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1127 = name1118;if (or_part1127!==false) {var if_res627 = or_part1127;} else {var if_res627 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p1121!==false) {if (method_p1120!==false) {var if_res624 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res624 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res626 = if_res624;} else {if (method_p1120!==false) {var if_res625 = struct_keyword_method_by_arity_error;} else {var if_res625 = struct_keyword_procedure_by_arity_error;}var if_res626 = if_res625;}var let_result628 = M0.make_struct_type(if_res627,if_res626,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name1118,fail_proc1119))),M0.current_inspector(),fail_proc1119);var s_1122 = let_result628.getAt(0);var mk1123 = let_result628.getAt(1);var __p1124 = let_result628.getAt(2);var __ref1125 = let_result628.getAt(3);var __set_bang_1126 = let_result628.getAt(4);return mk1123;};var cl629 = function(proc1128) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name1129 = M0.object_name(proc1128);var plain_proc1130 = $rjs_core.attachProcedureArity(function(...args1131632) {var args1131 = $rjs_core.Pair.listFromArray(args1131632);return M0.apply(proc1128,M0.rnull,M0.rnull,args1131);});if (M0.symbol_p(proc_name1129)!==false) {var if_res633 = M0.__rjs_quoted__.procedure_rename(plain_proc1130,proc_name1129);} else {var if_res633 = plain_proc1130;}return make_keyword_procedure(proc1128,if_res633);};var cl630 = function(proc1132, plain_proc1133) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1132)!==false) {var if_res634 = M0.procedure_arity_mask(proc1132);} else {var if_res634 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res634),proc1132,M0.rnull,false,plain_proc1133);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam631 = {'1':cl629,'2':cl630}[arguments.length];if (fixed_lam631!==undefined) {return fixed_lam631.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1134, kws1135, kw_vals1136, normal_args1137, ...normal_argss1138635) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1138 = $rjs_core.Pair.listFromArray(normal_argss1138635);var type_error1139 = function(what1140, which1141) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1140,which1141,proc1134,kws1135,kw_vals1136,normal_args1137,normal_argss1138);};if (M0.procedure_p(proc1134)!==false) {var if_res636 = M0.rvoid();} else {var if_res636 = type_error1139($rjs_core.UString.make("procedure?"),0);}if_res636;var loop1142 = function(ks1143) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1143)!==false) {var if_res643 = M0.rvoid();} else {var or_part1144 = M0.not(M0.pair_p(ks1143));if (or_part1144!==false) {var if_res637 = or_part1144;} else {var if_res637 = M0.not(M0.keyword_p(M0.car(ks1143)));}if (if_res637!==false) {var if_res642 = type_error1139($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1143))!==false) {var if_res641 = M0.rvoid();} else {var or_part1145 = M0.not(M0.pair_p(M0.cdr(ks1143)));if (or_part1145!==false) {var if_res638 = or_part1145;} else {var if_res638 = M0.not(M0.keyword_p(M0.cadr(ks1143)));}if (if_res638!==false) {var if_res640 = loop1142(M0.cdr(ks1143));} else {if (M0.keyword_lt__p(M0.car(ks1143),M0.cadr(ks1143))!==false) {var if_res639 = loop1142(M0.cdr(ks1143));} else {var if_res639 = type_error1139($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res640 = if_res639;}var if_res641 = if_res640;}var if_res642 = if_res641;}var if_res643 = if_res642;}return if_res643;};loop1142(kws1135);if (M0.list_p(kw_vals1136)!==false) {var if_res644 = M0.rvoid();} else {var if_res644 = type_error1139($rjs_core.UString.make("list?"),2);}if_res644;if (M0.__eq_(M0.length(kws1135),M0.length(kw_vals1136))!==false) {var if_res645 = M0.rvoid();} else {var if_res645 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1135),$rjs_core.UString.make("value list length"),M0.length(kw_vals1136),$rjs_core.UString.make("keyword list"),kws1135,$rjs_core.UString.make("value list"),kw_vals1136);}if_res645;var loop1147 = function(normal_argss1148, pos1149) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1148))!==false) {var l1150 = M0.car(normal_argss1148);if (M0.list_p(l1150)!==false) {var if_res646 = l1150;} else {var if_res646 = type_error1139($rjs_core.UString.make("list?"),pos1149);}var if_res647 = if_res646;} else {var if_res647 = M0.cons(M0.car(normal_argss1148),loop1147(M0.cdr(normal_argss1148),M0.add1(pos1149)));}return if_res647;};var normal_args1146 = loop1147(M0.cons(normal_args1137,normal_argss1138),3);if (M0.null_p(kws1135)!==false) {var if_res648 = M0.apply(proc1134,normal_args1146);} else {var if_res648 = M0.apply(keyword_procedure_extract_by_method(kws1135,2+M0.length(normal_args1146),proc1134,0),kws1135,kw_vals1136,normal_args1146);}return if_res648;});var procedure_keywords = function(p1151) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1151)!==false) {var if_res653 = M0.values(keyword_procedure_required(p1151),keyword_procedure_allowed(p1151));} else {if (M0.procedure_p(p1151)!==false) {if (new_procedure_p(p1151)!==false) {var v1152 = new_procedure_ref(p1151);if (M0.procedure_p(v1152)!==false) {var if_res650 = procedure_keywords(v1152);} else {var a1153 = procedure_accessor_ref(p1151);if (a1153!==false) {var if_res649 = procedure_keywords(a1153(p1151));} else {var if_res649 = M0.values(M0.rnull,M0.rnull);}var if_res650 = if_res649;}var if_res651 = if_res650;} else {var if_res651 = M0.values(M0.rnull,M0.rnull);}var if_res652 = if_res651;} else {var if_res652 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1151);}var if_res653 = if_res652;}return if_res653;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1154, ...args1155654) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1155 = $rjs_core.Pair.listFromArray(args1155654);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1154,0),M0.rnull,M0.rnull,args1155);});var check_kw_args = function(p1156, kws1157) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1158 = function(kws1159, required1160, allowed1161) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1159)!==false) {if (M0.null_p(required1160)!==false) {var if_res655 = M0.values(false,false);} else {var if_res655 = M0.values(M0.car(required1160),false);}var if_res664 = if_res655;} else {if (M0.pair_p(required1160)!==false) {var if_res656 = M0.eq_p(M0.car(required1160),M0.car(kws1159));} else {var if_res656 = false;}if (if_res656!==false) {var temp659 = M0.cdr(kws1159);var temp658 = M0.cdr(required1160);if (allowed1161!==false) {var if_res657 = M0.cdr(allowed1161);} else {var if_res657 = false;}var if_res663 = loop1158(temp659,temp658,if_res657);} else {if (M0.not(allowed1161)!==false) {var if_res662 = loop1158(M0.cdr(kws1159),required1160,false);} else {if (M0.pair_p(allowed1161)!==false) {if (M0.eq_p(M0.car(allowed1161),M0.car(kws1159))!==false) {var if_res660 = loop1158(M0.cdr(kws1159),required1160,M0.cdr(allowed1161));} else {var if_res660 = loop1158(kws1159,required1160,M0.cdr(allowed1161));}var if_res661 = if_res660;} else {var if_res661 = M0.values(false,M0.car(kws1159));}var if_res662 = if_res661;}var if_res663 = if_res662;}var if_res664 = if_res663;}return if_res664;};return loop1158(kws1157,keyword_procedure_required(p1156),keyword_procedure_allowed(p1156));};var make_keyword_checker = function(req_kws1162, allowed_kws1163, arity_mask1164) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1163)!==false) {if (M0.null_p(req_kws1162)!==false) {var if_res667 = function(kws1165, a1166) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res665 = M0.bitwise_bit_set_p(arity_mask1164,a1166);} else {var if_res665 = false;}return if_res665;};} else {var if_res667 = function(kws1167, a1168) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1162,kws1167)!==false) {var if_res666 = M0.bitwise_bit_set_p(arity_mask1164,a1168);} else {var if_res666 = false;}return if_res666;};}var if_res680 = if_res667;} else {if (M0.null_p(allowed_kws1163)!==false) {var if_res679 = function(kws1169, a1170) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1169)!==false) {var if_res668 = M0.bitwise_bit_set_p(arity_mask1164,a1170);} else {var if_res668 = false;}return if_res668;};} else {if (M0.null_p(req_kws1162)!==false) {var if_res678 = function(kws1171, a1172) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1171,allowed_kws1163)!==false) {var if_res669 = M0.bitwise_bit_set_p(arity_mask1164,a1172);} else {var if_res669 = false;}return if_res669;};} else {if (M0.list_p(req_kws1162)!==false) {if (M0.list_p(allowed_kws1163)!==false) {var if_res670 = M0.eq_p(M0.length(req_kws1162),M0.length(allowed_kws1163));} else {var if_res670 = false;}var if_res671 = if_res670;} else {var if_res671 = false;}if (if_res671!==false) {var if_res677 = function(kws1173, a1174) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1175 = function(kws1176, req_kws1177) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1177)!==false) {var if_res674 = M0.null_p(kws1176);} else {if (M0.null_p(kws1176)!==false) {var if_res673 = false;} else {if (M0.eq_p(M0.car(kws1176),M0.car(req_kws1177))!==false) {var if_res672 = loop1175(M0.cdr(kws1176),M0.cdr(req_kws1177));} else {var if_res672 = false;}var if_res673 = if_res672;}var if_res674 = if_res673;}return if_res674;};if (loop1175(kws1173,req_kws1162)!==false) {var if_res675 = M0.bitwise_bit_set_p(arity_mask1164,a1174);} else {var if_res675 = false;}return if_res675;};} else {var if_res677 = function(kws1178, a1179) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1162,kws1178,allowed_kws1163)!==false) {var if_res676 = M0.bitwise_bit_set_p(arity_mask1164,a1179);} else {var if_res676 = false;}return if_res676;};}var if_res678 = if_res677;}var if_res679 = if_res678;}var if_res680 = if_res679;}return if_res680;};var subset_p = function(l11180, l21181) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11180)!==false) {var if_res683 = true;} else {if (M0.null_p(l21181)!==false) {var if_res682 = false;} else {if (M0.eq_p(M0.car(l11180),M0.car(l21181))!==false) {var if_res681 = subset_p(M0.cdr(l11180),M0.cdr(l21181));} else {var if_res681 = subset_p(l11180,M0.cdr(l21181));}var if_res682 = if_res681;}var if_res683 = if_res682;}return if_res683;};var subsets_p = function(l11182, l21183, l31184) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11182)!==false) {var if_res688 = subset_p(l21183,l31184);} else {if (M0.null_p(l21183)!==false) {var if_res687 = false;} else {if (M0.null_p(l31184)!==false) {var if_res686 = false;} else {var v21185 = M0.car(l21183);if (M0.eq_p(M0.car(l11182),v21185)!==false) {var if_res685 = subsets_p(M0.cdr(l11182),M0.cdr(l21183),M0.cdr(l31184));} else {if (M0.eq_p(v21185,M0.car(l31184))!==false) {var if_res684 = subsets_p(l11182,M0.cdr(l21183),M0.cdr(l31184));} else {var if_res684 = subsets_p(l11182,l21183,M0.cdr(l31184));}var if_res685 = if_res684;}var if_res686 = if_res685;}var if_res687 = if_res686;}var if_res688 = if_res687;}return if_res688;};var keyword_procedure_extract_by_method = function(kws1186, n1187, p1188, method_n1189) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1188)!==false) {var if_res689 = keyword_procedure_checker(p1188)(kws1186,n1187);} else {var if_res689 = false;}if (if_res689!==false) {var if_res719 = keyword_procedure_proc(p1188);} else {if (M0.not(keyword_procedure_p(p1188))!==false) {if (M0.procedure_p(p1188)!==false) {if (new_procedure_p(p1188)!==false) {var a1192 = procedure_accessor_ref(p1188);if (a1192!==false) {var if_res690 = a1192(p1188);} else {var if_res690 = false;}var if_res691 = if_res690;} else {var if_res691 = false;}var or_part1191 = if_res691;if (or_part1191!==false) {var if_res694 = or_part1191;} else {var or_part1193 = M0.procedure_extract_target(p1188);if (or_part1193!==false) {var if_res693 = or_part1193;} else {if (new_procedure_p(p1188)!==false) {var if_res692 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res692 = false;}var if_res693 = if_res692;}var if_res694 = if_res693;}var if_res695 = if_res694;} else {var if_res695 = false;}var if_res696 = if_res695;} else {var if_res696 = false;}var p21190 = if_res696;if (p21190!==false) {if (M0.eq_p(p21190,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31194 = keyword_procedure_extract_by_method(kws1186,M0.add1(n1187),new_procedure_ref(p1188),M0.add1(method_n1189));var if_res698 = $rjs_core.attachProcedureArity(function(kws1195, kw_args1196, ...args1197697) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1197 = $rjs_core.Pair.listFromArray(args1197697);return M0.apply(p31194,kws1195,kw_args1196,M0.cons(p1188,args1197));});} else {var if_res698 = keyword_procedure_extract_by_method(kws1186,n1187,p21190,method_n1189);}var if_res718 = if_res698;} else {var if_res718 = $rjs_core.attachProcedureArity(function(kws1198, kw_args1199, ...args1200699) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1200 = $rjs_core.Pair.listFromArray(args1200699);if (keyword_procedure_p(p1188)!==false) {var if_res700 = check_kw_args(p1188,kws1198);} else {var if_res700 = M0.values(false,M0.car(kws1198));}var let_result701 = if_res700;var missing_kw1201 = let_result701.getAt(0);var extra_kw1202 = let_result701.getAt(1);var or_part1207 = keyword_method_p(p1188);if (or_part1207!==false) {var if_res702 = or_part1207;} else {var if_res702 = okm_p(p1188);}if (if_res702!==false) {var if_res703 = 1;} else {var if_res703 = 0;}var method_n1206 = method_n1189+if_res703;if (M0.__gt__eq_(n1187,method_n1206)!==false) {var if_res704 = n1187-method_n1206;} else {var if_res704 = n1187;}var n1203 = if_res704;if (M0.null_p(args1200)!==false) {var if_res705 = M0.null_p(kws1198);} else {var if_res705 = false;}if (if_res705!==false) {var if_res706 = $rjs_core.UString.make("");} else {var if_res706 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1208) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1208);},args1200),M0.map(function(kw1209, kw_arg1210) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1209,kw_arg1210);},kws1198,kw_args1199)));}var args_str1204 = if_res706;var proc_name1205 = function(p1211) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1211)!==false) {var if_res707 = M0.car(keyword_procedure_name_plus_fail(p1211));} else {var if_res707 = false;}var or_part1212 = if_res707;if (or_part1212!==false) {var if_res709 = or_part1212;} else {var or_part1213 = M0.object_name(p1211);if (or_part1213!==false) {var if_res708 = or_part1213;} else {var if_res708 = p1211;}var if_res709 = if_res708;}return if_res709;};var or_part1214 = extra_kw1202;if (or_part1214!==false) {var if_res716 = or_part1214;} else {var if_res716 = missing_kw1201;}if (if_res716!==false) {var if_res717 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res717 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1202!==false) {if (keyword_procedure_p(p1188)!==false) {var if_res711 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1205(p1188),extra_kw1202,args_str1204);} else {if (M0.procedure_p(p1188)!==false) {var if_res710 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1205(p1188),args_str1204);} else {var if_res710 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1188,args_str1204);}var if_res711 = if_res710;}var if_res715 = if_res711;} else {if (missing_kw1201!==false) {var if_res714 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1205(p1188),missing_kw1201,args_str1204);} else {var temp713 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1203-2)!==false) {var if_res712 = $rjs_core.UString.make("");} else {var if_res712 = $rjs_core.UString.make("s");}var if_res714 = M0.format(temp713,n1203-2,if_res712,proc_name1205(p1188),args_str1204);}var if_res715 = if_res714;}return M0.raise(if_res717(if_res715,M0.current_continuation_marks()));});}var if_res719 = if_res718;}return if_res719;};var keyword_procedure_extract = function(p1215, kws1216, n1217) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1216,n1217,p1215,0);};var cl720 = function(proc1218, arity1219, req_kw1220, allowed_kw1221, name1222) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1218,arity1219,false,name1222,req_kw1220,allowed_kw1221);};var cl721 = function(proc1223, arity1224, req_kw1225, allowed_kw1226) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1223,arity1224,false,false,req_kw1225,allowed_kw1226);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam722 = {'5':cl720,'4':cl721}[arguments.length];if (fixed_lam722!==undefined) {return fixed_lam722.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl723 = function(proc1227, mask1228, req_kw1229, allowed_kw1230, name1231) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1227,false,mask1228,name1231,req_kw1229,allowed_kw1230);};var cl724 = function(proc1232, mask1233, req_kw1234, allowed_kw1235) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1232,false,mask1233,false,req_kw1234,allowed_kw1235);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam725 = {'5':cl723,'4':cl724}[arguments.length];if (fixed_lam725!==undefined) {return fixed_lam725.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1236, proc1237, arity1238, mask1239, name1240, req_kw1241, allowed_kw1242) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1237)!==false) {var if_res726 = okp_ref(proc1237,0);} else {var if_res726 = proc1237;}var p1244 = if_res726;if (arity1238!==false) {var if_res727 = M0.__rjs_quoted__.procedure_reduce_arity(p1244,arity1238);} else {var if_res727 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1244,mask1239,name1240);}var plain_proc1243 = if_res727;var sorted_p1245 = function(kws1246) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1247 = function(kws1248) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1248)!==false) {var if_res730 = true;} else {if (M0.null_p(M0.cdr(kws1248))!==false) {var if_res729 = true;} else {if (M0.keyword_lt__p(M0.car(kws1248),M0.cadr(kws1248))!==false) {var if_res728 = loop1247(M0.cdr(kws1248));} else {var if_res728 = false;}var if_res729 = if_res728;}var if_res730 = if_res729;}return if_res730;};return loop1247(kws1246);};if (M0.list_p(req_kw1241)!==false) {if (M0.andmap(M0.keyword_p,req_kw1241)!==false) {var if_res731 = sorted_p1245(req_kw1241);} else {var if_res731 = false;}var if_res732 = if_res731;} else {var if_res732 = false;}if (if_res732!==false) {var if_res735 = M0.rvoid();} else {var temp734 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1249 = arity1238;if (or_part1249!==false) {var if_res733 = or_part1249;} else {var if_res733 = mask1239;}var if_res735 = M0.raise_argument_error(who1236,temp734,2,proc1237,if_res733,req_kw1241,allowed_kw1242);}if_res735;if (allowed_kw1242!==false) {if (M0.list_p(allowed_kw1242)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1242)!==false) {var if_res736 = sorted_p1245(allowed_kw1242);} else {var if_res736 = false;}var if_res737 = if_res736;} else {var if_res737 = false;}if (if_res737!==false) {var if_res740 = M0.rvoid();} else {var temp739 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1250 = arity1238;if (or_part1250!==false) {var if_res738 = or_part1250;} else {var if_res738 = mask1239;}var if_res740 = M0.raise_argument_error(who1236,temp739,3,proc1237,if_res738,req_kw1241,allowed_kw1242);}if_res740;if (subset_p(req_kw1241,allowed_kw1242)!==false) {var if_res741 = M0.rvoid();} else {var if_res741 = M0.raise_arguments_error(who1236,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1242,$rjs_core.UString.make("required keywords"),req_kw1241);}var if_res742 = if_res741;} else {var if_res742 = M0.rvoid();}if_res742;var let_result743 = procedure_keywords(proc1237);var old_req1251 = let_result743.getAt(0);var old_allowed1252 = let_result743.getAt(1);if (subset_p(old_req1251,req_kw1241)!==false) {var if_res744 = M0.rvoid();} else {var if_res744 = M0.raise_arguments_error(who1236,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1251,$rjs_core.UString.make("requested required keywords"),req_kw1241);}if_res744;if (old_allowed1252!==false) {if (subset_p(req_kw1241,old_allowed1252)!==false) {var if_res745 = M0.rvoid();} else {var if_res745 = M0.raise_arguments_error(who1236,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1252,$rjs_core.UString.make("requested required keywords"),req_kw1241);}if_res745;var or_part1253 = M0.not(allowed_kw1242);if (or_part1253!==false) {var if_res746 = or_part1253;} else {var if_res746 = subset_p(allowed_kw1242,old_allowed1252);}if (if_res746!==false) {var if_res747 = M0.rvoid();} else {var if_res747 = M0.raise_arguments_error(who1236,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1252,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1242);}var if_res748 = if_res747;} else {var if_res748 = M0.rvoid();}if_res748;if (M0.null_p(allowed_kw1242)!==false) {var if_res756 = plain_proc1243;} else {var or_part1255 = mask1239;if (or_part1255!==false) {var if_res749 = or_part1255;} else {var if_res749 = arity__gt_mask(arity1238);}var mask1254 = if_res749;var new_mask1256 = M0.arithmetic_shift(mask1254,2);var kw_checker1257 = make_keyword_checker(req_kw1241,allowed_kw1242,new_mask1256);var proc1258 = normalize_proc(proc1237);var new_kw_proc1259 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1258),new_mask1256);if (M0.null_p(req_kw1241)!==false) {if (okm_p(proc1258)!==false) {var if_res750 = make_optional_keyword_method;} else {var if_res750 = make_optional_keyword_procedure;}var if_res755 = if_res750(kw_checker1257,new_kw_proc1259,req_kw1241,allowed_kw1242,plain_proc1243);} else {if (named_keyword_procedure_p(proc1258)!==false) {var if_res753 = M0.car(keyword_procedure_name_plus_fail(proc1258));} else {var if_res753 = false;}var or_part1260 = if_res753;if (or_part1260!==false) {var if_res754 = or_part1260;} else {var if_res754 = M0.object_name(proc1258);}var temp752 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1254,1));var or_part1261 = okm_p(proc1258);if (or_part1261!==false) {var if_res751 = or_part1261;} else {var if_res751 = keyword_method_p(proc1258);}var if_res755 = make_required(if_res754,temp752,if_res751,false)(kw_checker1257,new_kw_proc1259,req_kw1241,allowed_kw1242);}var if_res756 = if_res755;}return if_res756;};var arity__gt_mask = function(a1262) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1262)!==false) {var if_res762 = M0.arithmetic_shift(1,a1262);} else {if (M0.arity_at_least_p(a1262)!==false) {var if_res761 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1262))));} else {if (M0.list_p(a1262)!==false) {var loop1263 = function(mask1264, l1265) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1265)!==false) {var if_res759 = mask1264;} else {var a1266 = M0.car(l1265);var or_part1267 = M0.exact_nonnegative_integer_p(a1266);if (or_part1267!==false) {var if_res757 = or_part1267;} else {var if_res757 = M0.arity_at_least_p(a1266);}if (if_res757!==false) {var if_res758 = loop1263(M0.bitwise_ior(mask1264,arity__gt_mask(a1266)),M0.cdr(l1265));} else {var if_res758 = false;}var if_res759 = if_res758;}return if_res759;};var if_res760 = loop1263(0,a1262);} else {var if_res760 = false;}var if_res761 = if_res760;}var if_res762 = if_res761;}return if_res762;};var cl763 = function(proc1269, arity1270, name1271) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1269)!==false) {var let_result766 = procedure_keywords(proc1269);var req1272 = let_result766.getAt(0);var allows1273 = let_result766.getAt(1);if (M0.pair_p(req1272)!==false) {var if_res767 = M0.not(M0.null_p(arity1270));} else {var if_res767 = false;}var if_res768 = if_res767;} else {var if_res768 = false;}if (if_res768!==false) {var if_res770 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1269);} else {if (okm_p(proc1269)!==false) {var if_res769 = M0.__rjs_quoted__.procedure__gt_method(proc1269);} else {var if_res769 = proc1269;}var if_res770 = M0.__rjs_quoted__.procedure_reduce_arity(if_res769,arity1270,name1271);}return if_res770;};var cl764 = function(proc1274, arity1275) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1274,arity1275,false);};var procedure_reduce_arity1268 = $rjs_core.attachProcedureArity(function() {var fixed_lam765 = {'3':cl763,'2':cl764}[arguments.length];if (fixed_lam765!==undefined) {return fixed_lam765.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1268;var cl771 = function(proc1277, mask1278, name1279) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1277)!==false) {var let_result774 = procedure_keywords(proc1277);var req1280 = let_result774.getAt(0);var allows1281 = let_result774.getAt(1);if (M0.pair_p(req1280)!==false) {var if_res775 = M0.not(M0.eqv_p(mask1278,0));} else {var if_res775 = false;}var if_res776 = if_res775;} else {var if_res776 = false;}if (if_res776!==false) {var if_res778 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1277);} else {if (okm_p(proc1277)!==false) {var if_res777 = M0.__rjs_quoted__.procedure__gt_method(proc1277);} else {var if_res777 = proc1277;}var if_res778 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res777,mask1278,name1279);}return if_res778;};var cl772 = function(proc1282, mask1283) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1282,mask1283,false);};var procedure_reduce_arity1276 = $rjs_core.attachProcedureArity(function() {var fixed_lam773 = {'3':cl771,'2':cl772}[arguments.length];if (fixed_lam773!==undefined) {return fixed_lam773.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1276;var procedure__gt_method1284 = function(proc1285) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1286 = normalize_proc(proc1285);if (keyword_procedure_p(proc1286)!==false) {if (okm_p(proc1286)!==false) {var if_res781 = proc1286;} else {if (keyword_method_p(proc1286)!==false) {var if_res780 = proc1286;} else {if (okp_p(proc1286)!==false) {var if_res779 = make_optional_keyword_method(keyword_procedure_checker(proc1286),keyword_procedure_proc(proc1286),keyword_procedure_required(proc1286),keyword_procedure_allowed(proc1286),okp_ref(proc1286,0));} else {var name_plus_fail1287 = keyword_procedure_name_plus_fail(proc1286);var mk1288 = make_required(M0.car(name_plus_fail1287),M0.cdr(name_plus_fail1287),true,false);var if_res779 = mk1288(keyword_procedure_checker(proc1286),keyword_procedure_proc(proc1286),keyword_procedure_required(proc1286),keyword_procedure_allowed(proc1286));}var if_res780 = if_res779;}var if_res781 = if_res780;}var if_res782 = if_res781;} else {var if_res782 = M0.__rjs_quoted__.procedure__gt_method(proc1286);}return if_res782;};var new_procedure__gt_method = procedure__gt_method1284;var procedure_rename1289 = function(proc1290, name1291) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1290)!==false) {var if_res783 = M0.symbol_p(name1291);} else {var if_res783 = false;}if (M0.not(if_res783)!==false) {var if_res786 = M0.__rjs_quoted__.procedure_rename(proc1290,name1291);} else {if (okp_p(proc1290)!==false) {if (okm_p(proc1290)!==false) {var if_res784 = make_optional_keyword_method;} else {var if_res784 = make_optional_keyword_procedure;}var if_res785 = if_res784(keyword_procedure_checker(proc1290),keyword_procedure_proc(proc1290),keyword_procedure_required(proc1290),keyword_procedure_allowed(proc1290),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1290,0),name1291));} else {var name_plus_fail1292 = keyword_procedure_name_plus_fail(proc1290);var mk1293 = make_required(name1291,M0.cdr(name_plus_fail1292),keyword_method_p(proc1290),false);var if_res785 = mk1293(keyword_procedure_checker(proc1290),keyword_procedure_proc(proc1290),keyword_procedure_required(proc1290),keyword_procedure_allowed(proc1290));}var if_res786 = if_res785;}return if_res786;};var new_procedure_rename = procedure_rename1289;var chaperone_procedure1294 = $rjs_core.attachProcedureArity(function(proc1295, wrap_proc1296, ...props1297787) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1297 = $rjs_core.Pair.listFromArray(props1297787);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1295,wrap_proc1296,props1297);});var new_chaperone_procedure = chaperone_procedure1294;var unsafe_chaperone_procedure1298 = $rjs_core.attachProcedureArity(function(proc1299, wrap_proc1300, ...props1301788) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1301 = $rjs_core.Pair.listFromArray(props1301788);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1299,wrap_proc1300,props1301);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1298;var impersonate_procedure1302 = $rjs_core.attachProcedureArity(function(proc1303, wrap_proc1304, ...props1305789) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1305 = $rjs_core.Pair.listFromArray(props1305789);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1303,wrap_proc1304,props1305);});var new_impersonate_procedure = impersonate_procedure1302;var unsafe_impersonate_procedure1306 = $rjs_core.attachProcedureArity(function(proc1307, wrap_proc1308, ...props1309790) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1309 = $rjs_core.Pair.listFromArray(props1309790);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1307,wrap_proc1308,props1309);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1306;var chaperone_procedure_times_1310 = $rjs_core.attachProcedureArity(function(proc1311, wrap_proc1312, ...props1313791) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1313 = $rjs_core.Pair.listFromArray(props1313791);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1311,wrap_proc1312,props1313);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1310;var impersonate_procedure_times_1314 = $rjs_core.attachProcedureArity(function(proc1315, wrap_proc1316, ...props1317792) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1317 = $rjs_core.Pair.listFromArray(props1317792);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1315,wrap_proc1316,props1317);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1314;var do_chaperone_procedure = function(is_impersonator_p1318, self_arg_p1319, chaperone_procedure1320, name1321, proc1322, wrap_proc1323, props1324) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1325 = normalize_proc(proc1322);var n_wrap_proc1326 = normalize_proc(wrap_proc1323);var or_part1327 = M0.not(keyword_procedure_p(n_proc1325));if (or_part1327!==false) {var if_res794 = or_part1327;} else {var or_part1328 = M0.not(M0.procedure_p(wrap_proc1323));if (or_part1328!==false) {var if_res793 = or_part1328;} else {var if_res793 = bad_props_p(props1324);}var if_res794 = if_res793;}if (if_res794!==false) {var if_res861 = M0.apply(chaperone_procedure1320,proc1322,wrap_proc1323,props1324);} else {chaperone_arity_match_checking(self_arg_p1319,name1321,proc1322,wrap_proc1323,props1324);var loop1330 = function(props1331) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1331)!==false) {var if_res796 = false;} else {if (M0.eq_p(M0.car(props1331),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res795 = M0.cadr(props1331);} else {var if_res795 = loop1330(M0.cddr(props1331));}var if_res796 = if_res795;}return if_res796;};var mark_prop1329 = loop1330(props1324);var chaperone_procedure_by_add_mark1332 = function(proc1333, wrap_proc1334) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1329!==false) {var if_res797 = chaperone_procedure1320(proc1333,wrap_proc1334,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1329);} else {var if_res797 = chaperone_procedure1320(proc1333,wrap_proc1334);}return if_res797;};var p1336 = keyword_procedure_proc(n_wrap_proc1326);if (self_arg_p1319!==false) {var cl798 = $rjs_core.attachProcedureArity(function(self_proc1337, kws1338, args1339, ...rest1340803) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1340 = $rjs_core.Pair.listFromArray(rest1340803);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1336,kws1338,args1339,self_proc1337,rest1340);},$rjs_core.attachProcedureArity(function(...results1341804) {var results1341 = $rjs_core.Pair.listFromArray(results1341804);var len1342 = M0.length(results1341);var alen1343 = M0.length(rest1340);if (M0.__lt_(len1342,alen1343+1)!==false) {var if_res805 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1343+1,$rjs_core.UString.make("received number of results"),len1342,$rjs_core.UString.make("wrapper procedure"),wrap_proc1323);} else {var if_res805 = M0.rvoid();}if_res805;var num_extra1344 = len1342-(alen1343+1);var new_args1345 = M0.list_ref(results1341,num_extra1344);if (M0.list_p(new_args1345)!==false) {var if_res806 = M0.__eq_(M0.length(new_args1345),M0.length(args1339));} else {var if_res806 = false;}if (if_res806!==false) {var if_res810 = M0.rvoid();} else {var temp809 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp808 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1342,alen1343)!==false) {var if_res807 = $rjs_core.UString.make("");} else {var if_res807 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res810 = M0.raise_arguments_error(temp809,M0.format(temp808,if_res807),$rjs_core.UString.make("first result"),new_args1345,$rjs_core.UString.make("wrapper procedure"),wrap_proc1323);}if_res810;M0.for_each(function(kw1346, new_arg1347, arg1348) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1318!==false) {var if_res812 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1347,arg1348)!==false) {var if_res811 = M0.rvoid();} else {var if_res811 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1346),$rjs_core.UString.make("result"),new_arg1347,$rjs_core.UString.make("wrapper procedure"),wrap_proc1323);}var if_res812 = if_res811;}return if_res812;},kws1338,new_args1345,args1339);var tmp1349 = num_extra1344;if (M0.equal_p(tmp1349,0)!==false) {var if_res815 = M0.apply(M0.values,kws1338,results1341);} else {if (M0.equal_p(tmp1349,1)!==false) {var if_res814 = M0.apply(M0.values,M0.car(results1341),kws1338,M0.cdr(results1341));} else {var loop1350 = function(results1351, c1352) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1352)!==false) {var if_res813 = M0.cons(kws1338,results1351);} else {var if_res813 = M0.cons(M0.car(results1351),loop1350(M0.cdr(results1351),M0.sub1(c1352)));}return if_res813;};var if_res814 = M0.apply(M0.values,loop1350(results1341,num_extra1344));}var if_res815 = if_res814;}return if_res815;}));});var cl799 = $rjs_core.attachProcedureArity(function(...other1353816) {var other1353 = $rjs_core.Pair.listFromArray(other1353816);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res836 = $rjs_core.attachProcedureArity(function() {var fixed_lam800 = {}[arguments.length];if (fixed_lam800!==undefined) {return fixed_lam800.apply(null,arguments);} else {if (M0.__gt__eq_(cl798.length,1)!==false) {var if_res802 = cl798.apply(null,arguments);} else {if (true!==false) {var if_res801 = cl799.apply(null,arguments);} else {var if_res801 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res802 = if_res801;}return if_res802;}},[M0.make_arity_at_least(0)]);} else {var cl817 = $rjs_core.attachProcedureArity(function(kws1354, args1355, ...rest1356822) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1356 = $rjs_core.Pair.listFromArray(rest1356822);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1336,kws1354,args1355,rest1356);},$rjs_core.attachProcedureArity(function(...results1357823) {var results1357 = $rjs_core.Pair.listFromArray(results1357823);var len1358 = M0.length(results1357);var alen1359 = M0.length(rest1356);if (M0.__lt_(len1358,alen1359+1)!==false) {var if_res824 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1359+1,$rjs_core.UString.make("received number of results"),len1358,$rjs_core.UString.make("wrapper procedure"),wrap_proc1323);} else {var if_res824 = M0.rvoid();}if_res824;var num_extra1360 = len1358-(alen1359+1);var new_args1361 = M0.list_ref(results1357,num_extra1360);if (M0.list_p(new_args1361)!==false) {var if_res825 = M0.__eq_(M0.length(new_args1361),M0.length(args1355));} else {var if_res825 = false;}if (if_res825!==false) {var if_res829 = M0.rvoid();} else {var temp828 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp827 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1358,alen1359)!==false) {var if_res826 = $rjs_core.UString.make("");} else {var if_res826 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res829 = M0.raise_arguments_error(temp828,M0.format(temp827,if_res826),$rjs_core.UString.make("first result"),new_args1361,$rjs_core.UString.make("wrapper procedure"),wrap_proc1323);}if_res829;M0.for_each(function(kw1362, new_arg1363, arg1364) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1318!==false) {var if_res831 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1363,arg1364)!==false) {var if_res830 = M0.rvoid();} else {var if_res830 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1362),$rjs_core.UString.make("result"),new_arg1363,$rjs_core.UString.make("wrapper procedure"),wrap_proc1323);}var if_res831 = if_res830;}return if_res831;},kws1354,new_args1361,args1355);var tmp1365 = num_extra1360;if (M0.equal_p(tmp1365,0)!==false) {var if_res834 = M0.apply(M0.values,kws1354,results1357);} else {if (M0.equal_p(tmp1365,1)!==false) {var if_res833 = M0.apply(M0.values,M0.car(results1357),kws1354,M0.cdr(results1357));} else {var loop1366 = function(results1367, c1368) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1368)!==false) {var if_res832 = M0.cons(kws1354,results1367);} else {var if_res832 = M0.cons(M0.car(results1367),loop1366(M0.cdr(results1367),M0.sub1(c1368)));}return if_res832;};var if_res833 = M0.apply(M0.values,loop1366(results1357,num_extra1360));}var if_res834 = if_res833;}return if_res834;}));});var cl818 = $rjs_core.attachProcedureArity(function(...other1369835) {var other1369 = $rjs_core.Pair.listFromArray(other1369835);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res836 = $rjs_core.attachProcedureArity(function() {var fixed_lam819 = {}[arguments.length];if (fixed_lam819!==undefined) {return fixed_lam819.apply(null,arguments);} else {if (M0.__gt__eq_(cl817.length,1)!==false) {var if_res821 = cl817.apply(null,arguments);} else {if (true!==false) {var if_res820 = cl818.apply(null,arguments);} else {var if_res820 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res821 = if_res820;}return if_res821;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1335 = if_res836;var wrap1372 = function(proc1373, n_proc1374) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1374,proc1373))!==false) {var if_res837 = new_procedure_p(proc1373);} else {var if_res837 = false;}if (if_res837!==false) {var v1375 = new_procedure_ref(proc1373);if (M0.exact_integer_p(v1375)!==false) {var acc1376 = procedure_accessor_ref(proc1373);var if_res853 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1373,acc1376,function(self1377, sub_proc1378) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result838 = wrap1372(sub_proc1378,normalize_proc(sub_proc1378));var f1379 = let_result838.getAt(0);var acc1380 = let_result838.getAt(1);return f1379;}),acc1376);} else {if (is_impersonator_p1318!==false) {var if_res852 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res852 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1374)!==false) {var if_res851 = chaperone_procedure_by_add_mark1332(proc1373,wrap_proc1323);} else {var if_res851 = proc1373;}var new_kw_proc1381 = if_res852(if_res851,new_procedure_ref,function(self1382, proc1383) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1318!==false) {var if_res850 = new_impersonate_procedure;} else {var if_res850 = new_chaperone_procedure;}if (self_arg_p1319!==false) {var if_res849 = $rjs_core.attachProcedureArity(function(proc_self1384, kws1385, kw_args1386, self1387, ...args1388839) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1388 = $rjs_core.Pair.listFromArray(args1388839);var len1389 = M0.length(args1388);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1335,proc_self1384,kws1385,kw_args1386,args1388);},$rjs_core.attachProcedureArity(function(...results1390840) {var results1390 = $rjs_core.Pair.listFromArray(results1390840);var r_len1391 = M0.length(results1390);var list_take1392 = function(l1393, n1394) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1394)!==false) {var if_res841 = M0.rnull;} else {var if_res841 = M0.cons(M0.car(l1393),list_take1392(M0.cdr(l1393),M0.sub1(n1394)));}return if_res841;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res842 = M0.__eq_(r_len1391,2+len1389);} else {var if_res842 = false;}if (if_res842!==false) {var if_res843 = M0.apply(M0.values,M0.cadr(results1390),self1387,M0.cddr(results1390));} else {var skip1395 = r_len1391-len1389;var if_res843 = M0.apply(M0.values,M0.append(list_take1392(results1390,skip1395-2),M0.list(M0.list_ref(results1390,M0.sub1(skip1395)),self1387),M0.__rjs_quoted__.list_tail(results1390,skip1395)));}return if_res843;}));});} else {var if_res849 = $rjs_core.attachProcedureArity(function(kws1396, kw_args1397, self1398, ...args1399844) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1399 = $rjs_core.Pair.listFromArray(args1399844);var len1400 = M0.length(args1399);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1335,kws1396,kw_args1397,args1399);},$rjs_core.attachProcedureArity(function(...results1401845) {var results1401 = $rjs_core.Pair.listFromArray(results1401845);var r_len1402 = M0.length(results1401);var list_take1403 = function(l1404, n1405) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1405)!==false) {var if_res846 = M0.rnull;} else {var if_res846 = M0.cons(M0.car(l1404),list_take1403(M0.cdr(l1404),M0.sub1(n1405)));}return if_res846;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res847 = M0.__eq_(r_len1402,2+len1400);} else {var if_res847 = false;}if (if_res847!==false) {var if_res848 = M0.apply(M0.values,M0.cadr(results1401),self1398,M0.cddr(results1401));} else {var skip1406 = r_len1402-len1400;var if_res848 = M0.apply(M0.values,M0.append(list_take1403(results1401,skip1406-2),M0.list(M0.list_ref(results1401,M0.sub1(skip1406)),self1398),M0.__rjs_quoted__.list_tail(results1401,skip1406)));}return if_res848;}));});}return if_res850(proc1383,make_keyword_procedure(if_res849));});var if_res853 = M0.values(new_kw_proc1381,new_procedure_ref);}var if_res858 = if_res853;} else {if (okp_p(n_proc1374)!==false) {if (is_impersonator_p1318!==false) {if (okm_p(n_proc1374)!==false) {var if_res854 = make_optional_keyword_method_impersonator;} else {var if_res854 = make_optional_keyword_procedure_impersonator;}var if_res855 = if_res854(keyword_procedure_checker(n_proc1374),chaperone_procedure_by_add_mark1332(keyword_procedure_proc(n_proc1374),kw_chaperone1335),keyword_procedure_required(n_proc1374),keyword_procedure_allowed(n_proc1374),chaperone_procedure_by_add_mark1332(okp_ref(n_proc1374,0),okp_ref(n_wrap_proc1326,0)),n_proc1374);} else {var if_res855 = M0.__rjs_quoted__.chaperone_struct(proc1373,keyword_procedure_proc,function(self1407, proc1408) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1332(proc1408,kw_chaperone1335);},M0.make_struct_field_accessor(okp_ref,0),function(self1409, proc1410) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1332(proc1410,okp_ref(n_wrap_proc1326,0));});}var if_res857 = M0.values(if_res855,keyword_procedure_proc);} else {if (is_impersonator_p1318!==false) {var name_plus_fail1411 = keyword_procedure_name_plus_fail(n_proc1374);var mk1412 = make_required(M0.car(name_plus_fail1411),M0.cdr(name_plus_fail1411),keyword_method_p(n_proc1374),true);var if_res856 = mk1412(keyword_procedure_checker(n_proc1374),chaperone_procedure_by_add_mark1332(keyword_procedure_proc(n_proc1374),kw_chaperone1335),keyword_procedure_required(n_proc1374),keyword_procedure_allowed(n_proc1374),n_proc1374);} else {var if_res856 = M0.__rjs_quoted__.chaperone_struct(n_proc1374,keyword_procedure_proc,function(self1413, proc1414) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1332(proc1414,kw_chaperone1335);});}var if_res857 = M0.values(if_res856,keyword_procedure_proc);}var if_res858 = if_res857;}return if_res858;};var let_result859 = wrap1372(proc1322,n_proc1325);var new_proc1370 = let_result859.getAt(0);var chap_accessor1371 = let_result859.getAt(1);if (M0.null_p(props1324)!==false) {var if_res860 = new_proc1370;} else {var if_res860 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1370,chap_accessor1371,false,props1324);}var if_res861 = if_res860;}return if_res861;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1415, name1416, proc1417, wrap_proc1418, props1419) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1420 = normalize_proc(proc1417);var n_wrap_proc1421 = normalize_proc(wrap_proc1418);var or_part1422 = M0.not(keyword_procedure_p(n_proc1420));if (or_part1422!==false) {var if_res863 = or_part1422;} else {var or_part1423 = M0.not(M0.procedure_p(wrap_proc1418));if (or_part1423!==false) {var if_res862 = or_part1423;} else {var if_res862 = bad_props_p(props1419);}var if_res863 = if_res862;}if (if_res863!==false) {var if_res864 = M0.apply(unsafe_chaperone_procedure1415,proc1417,wrap_proc1418,props1419);} else {chaperone_arity_match_checking(false,name1416,proc1417,wrap_proc1418,props1419);var if_res864 = M0.apply(unsafe_chaperone_procedure1415,proc1417,wrap_proc1418,props1419);}return if_res864;};var bad_props_p = function(props1424) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1425 = function(props1426) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1426)!==false) {var if_res867 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1426))!==false) {var props1427 = M0.cdr(props1426);var or_part1428 = M0.null_p(props1427);if (or_part1428!==false) {var if_res865 = or_part1428;} else {var if_res865 = loop1425(M0.cdr(props1427));}var if_res866 = if_res865;} else {var if_res866 = true;}var if_res867 = if_res866;}return if_res867;};return loop1425(props1424);};var chaperone_arity_match_checking = function(self_arg_p1429, name1430, proc1431, wrap_proc1432, props1433) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1434 = M0.procedure_arity(proc1431);var b1435 = M0.procedure_arity(wrap_proc1432);if (self_arg_p1429!==false) {var if_res868 = 1;} else {var if_res868 = 0;}var d1436 = if_res868;var let_result869 = procedure_keywords(proc1431);var a_req1437 = let_result869.getAt(0);var a_allow1438 = let_result869.getAt(1);var let_result870 = procedure_keywords(wrap_proc1432);var b_req1439 = let_result870.getAt(0);var b_allow1440 = let_result870.getAt(1);var includes_p1441 = function(a1442, b1443) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1443)!==false) {if (M0.number_p(a1442)!==false) {var if_res872 = M0.__eq_(b1443,a1442+d1436);} else {if (M0.arity_at_least_p(a1442)!==false) {var if_res871 = M0.__gt__eq_(b1443,M0.arity_at_least_value(a1442)+d1436);} else {var if_res871 = M0.ormap(function(a1444) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1441(a1444,b1443);},a1442);}var if_res872 = if_res871;}var if_res876 = if_res872;} else {if (M0.arity_at_least_p(b1443)!==false) {if (M0.number_p(a1442)!==false) {var if_res874 = false;} else {if (M0.arity_at_least_p(a1442)!==false) {var if_res873 = M0.__gt__eq_(M0.arity_at_least_value(b1443),M0.arity_at_least_value(a1442)+d1436);} else {var if_res873 = M0.ormap(function(a1445) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1441(b1443,a1445);},a1442);}var if_res874 = if_res873;}var if_res875 = if_res874;} else {var if_res875 = M0.andmap(function(b1446) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1441(a1442,b1446);},b1443);}var if_res876 = if_res875;}return if_res876;};if (includes_p1441(b1435,a1434)!==false) {var if_res877 = M0.rvoid();} else {var if_res877 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1431,wrap_proc1432,props1433);}if_res877;if (subset_p(b_req1439,a_req1437)!==false) {var if_res878 = M0.rvoid();} else {var if_res878 = M0.raise_arguments_error(name1430,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1432,$rjs_core.UString.make("original procedure"),proc1431);}if_res878;var or_part1447 = M0.not(b_allow1440);if (or_part1447!==false) {var if_res880 = or_part1447;} else {if (a_allow1438!==false) {var if_res879 = subset_p(a_allow1438,b_allow1440);} else {var if_res879 = false;}var if_res880 = if_res879;}if (if_res880!==false) {var if_res881 = M0.rvoid();} else {var if_res881 = M0.raise_arguments_error(name1430,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1432,$rjs_core.UString.make("original procedure"),proc1431);}if_res881;return M0.rvoid();};var normalize_proc = function(proc1448) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1448)!==false) {var if_res889 = proc1448;} else {if (new_procedure_p(proc1448)!==false) {var let_result882 = procedure_keywords(proc1448);var req_kws1449 = let_result882.getAt(0);var allowed_kws1450 = let_result882.getAt(1);if (M0.null_p(allowed_kws1450)!==false) {var if_res887 = proc1448;} else {var if_res887 = make_optional_keyword_procedure(function(given_kws1451, given_argc1452) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1448,given_argc1452-2,true)!==false) {var or_part1453 = M0.not(allowed_kws1450);if (or_part1453!==false) {var if_res884 = or_part1453;} else {var if_res884 = subset_p(given_kws1451,allowed_kws1450);}if (if_res884!==false) {var if_res885 = subset_p(req_kws1449,given_kws1451);} else {var if_res885 = false;}var if_res886 = if_res885;} else {var if_res886 = false;}return if_res886;},$rjs_core.attachProcedureArity(function(kws1454, kw_args1455, ...vals1456883) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1456 = $rjs_core.Pair.listFromArray(vals1456883);return keyword_apply(proc1448,kws1454,kw_args1455,vals1456);}),req_kws1449,allowed_kws1450,proc1448);}var if_res888 = if_res887;} else {var if_res888 = proc1448;}var if_res889 = if_res888;}return if_res889;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };