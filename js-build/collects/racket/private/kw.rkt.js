import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result461 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result461.getAt(0);var keyword_impersonator_p = let_result461.getAt(1);var keyword_impersonator_ref = let_result461.getAt(2);var keyword_procedure_impersonator_of = function(v960) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v960)!==false) {var if_res462 = keyword_impersonator_ref(v960)(v960);} else {var if_res462 = false;}return if_res462;};var let_result463 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result463.getAt(0);var mk_kw_proc = let_result463.getAt(1);var keyword_procedure_p = let_result463.getAt(2);var keyword_procedure_ref = let_result463.getAt(3);var keyword_procedure_set_bang_ = let_result463.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result464 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result464.getAt(0);var make_km = let_result464.getAt(1);var keyword_method_p = let_result464.getAt(2);var km_ref = let_result464.getAt(3);var km_set_bang_ = let_result464.getAt(4);var generate_arity_string = function(proc961) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result465 = procedure_keywords(proc961);var req962 = let_result465.getAt(0);var allowed963 = let_result465.getAt(1);var a964 = M0.procedure_arity(proc961);var keywords_desc965 = function(opt967, req968) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp471 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req968))!==false) {var if_res470 = M0.format($rjs_core.UString.make("an ~aargument"),opt967);} else {var if_res470 = M0.format($rjs_core.UString.make("~aarguments"),opt967);}if (M0.null_p(M0.cdr(req968))!==false) {var if_res469 = $rjs_core.UString.make("");} else {var if_res469 = $rjs_core.UString.make("s");}var tmp969 = M0.length(req968);if (M0.equal_p(tmp969,1)!==false) {var if_res468 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req968));} else {if (M0.equal_p(tmp969,2)!==false) {var if_res467 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req968),M0.cadr(req968));} else {var loop970 = function(req971) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req971))!==false) {var if_res466 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req971));} else {var if_res466 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req971),loop970(M0.cdr(req971)));}return if_res466;};var if_res467 = loop970(req968);}var if_res468 = if_res467;}return M0.format(temp471,if_res470,if_res469,if_res468);};var method_adjust966 = function(a972) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part973 = okm_p(proc961);if (or_part973!==false) {var if_res472 = or_part973;} else {var if_res472 = keyword_method_p(proc961);}if (if_res472!==false) {if (M0.zero_p(a972)!==false) {var if_res473 = 0;} else {var if_res473 = M0.sub1(a972);}var if_res474 = if_res473;} else {var if_res474 = a972;}return if_res474;};if (M0.number_p(a964)!==false) {var a974 = method_adjust966(a964);var if_res481 = M0.format($rjs_core.UString.make("~a"),a974);} else {if (M0.arity_at_least_p(a964)!==false) {var a975 = method_adjust966(M0.arity_at_least_value(a964));var if_res480 = M0.format($rjs_core.UString.make("at least ~a"),a975);} else {var if_res480 = $rjs_core.UString.make("a different number");}var if_res481 = if_res480;}if (M0.null_p(req962)!==false) {var if_res479 = $rjs_core.UString.make("");} else {var if_res479 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc965($rjs_core.UString.make(""),req962));}if (allowed963!==false) {var loop977 = function(req978, allowed979) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req978)!==false) {var if_res476 = allowed979;} else {if (M0.eq_p(M0.car(req978),M0.car(allowed979))!==false) {var if_res475 = loop977(M0.cdr(req978),M0.cdr(allowed979));} else {var if_res475 = M0.cons(M0.car(allowed979),loop977(req978,M0.cdr(allowed979)));}var if_res476 = if_res475;}return if_res476;};var others976 = loop977(req962,allowed963);if (M0.null_p(others976)!==false) {var if_res477 = $rjs_core.UString.make("");} else {var if_res477 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc965($rjs_core.UString.make("optional "),others976));}var if_res478 = if_res477;} else {var if_res478 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res481,if_res479,if_res478);};var let_result482 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result482.getAt(0);var make_optional_keyword_procedure = let_result482.getAt(1);var okp_p = let_result482.getAt(2);var okp_ref = let_result482.getAt(3);var okp_set_bang_ = let_result482.getAt(4);var let_result483 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result483.getAt(0);var make_optional_keyword_method = let_result483.getAt(1);var okm_p = let_result483.getAt(2);var okm_ref = let_result483.getAt(3);var okm_set_bang_ = let_result483.getAt(4);var let_result484 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result484.getAt(0);var named_keyword_procedure_p = let_result484.getAt(1);var keyword_procedure_name_plus_fail = let_result484.getAt(2);var let_result486 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v980, info_l981) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v980)!==false) {var if_res485 = M0.make_struct_field_accessor(M0.list_ref(info_l981,3),v980);} else {var if_res485 = false;}return if_res485;});var prop_procedure_accessor = let_result486.getAt(0);var procedure_accessor_p = let_result486.getAt(1);var procedure_accessor_ref = let_result486.getAt(2);var let_result487 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result487.getAt(0);var new_procedure_p = let_result487.getAt(1);var new_procedure_ref = let_result487.getAt(2);var let_result488 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v982) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v982,0);})));var struct_keyword_procedure_impersonator = let_result488.getAt(0);var make_kpp = let_result488.getAt(1);var keyword_procedure_impersonator_p = let_result488.getAt(2);var kpp_ref = let_result488.getAt(3);var kpp_set_bang_ = let_result488.getAt(4);var let_result489 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v983) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v983,0);})));var struct_keyword_method_impersonator = let_result489.getAt(0);var make_kmp = let_result489.getAt(1);var keyword_method_impersonator_p = let_result489.getAt(2);var kmp_ref = let_result489.getAt(3);var kmp_set_bang_ = let_result489.getAt(4);var let_result490 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v984) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v984,0);})));var struct_okpp = let_result490.getAt(0);var make_optional_keyword_procedure_impersonator = let_result490.getAt(1);var okpp_p = let_result490.getAt(2);var okpp_ref = let_result490.getAt(3);var okpp_set_bang_ = let_result490.getAt(4);var let_result491 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v985) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v985,0);})));var struct_okmp = let_result491.getAt(0);var make_optional_keyword_method_impersonator = let_result491.getAt(1);var okmp_p = let_result491.getAt(2);var okmp_ref = let_result491.getAt(3);var okmp_set_bang_ = let_result491.getAt(4);var let_result492 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result492.getAt(0);var make_kp_by_ae = let_result492.getAt(1);var kp_by_ae_p = let_result492.getAt(2);var kp_by_ae_ref = let_result492.getAt(3);var kp_by_ae_set_bang_ = let_result492.getAt(4);var let_result493 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result493.getAt(0);var make_km_by_ae = let_result493.getAt(1);var km_by_ae_p = let_result493.getAt(2);var km_by_ae_ref = let_result493.getAt(3);var km_by_ae_set_bang_ = let_result493.getAt(4);var let_result494 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result494.getAt(0);var make_kpi_by_ae = let_result494.getAt(1);var kpi_by_ae_p = let_result494.getAt(2);var kpi_by_ae_ref = let_result494.getAt(3);var kpi_by_ae_set_bang_ = let_result494.getAt(4);var let_result495 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result495.getAt(0);var make_kmi_by_ae = let_result495.getAt(1);var kmi_by_ae_p = let_result495.getAt(2);var kmi_by_ae_ref = let_result495.getAt(3);var kmi_by_ae_set_bang_ = let_result495.getAt(4);var make_required = function(name986, fail_proc987, method_p988, impersonator_p989) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part995 = name986;if (or_part995!==false) {var if_res499 = or_part995;} else {var if_res499 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p989!==false) {if (method_p988!==false) {var if_res496 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res496 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res498 = if_res496;} else {if (method_p988!==false) {var if_res497 = struct_keyword_method_by_arity_error;} else {var if_res497 = struct_keyword_procedure_by_arity_error;}var if_res498 = if_res497;}var let_result500 = M0.make_struct_type(if_res499,if_res498,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name986,fail_proc987))),M0.current_inspector(),fail_proc987);var s_990 = let_result500.getAt(0);var mk991 = let_result500.getAt(1);var __p992 = let_result500.getAt(2);var __ref993 = let_result500.getAt(3);var __set_bang_994 = let_result500.getAt(4);return mk991;};var cl501 = function(proc996) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name997 = M0.object_name(proc996);var plain_proc998 = $rjs_core.attachProcedureArity(function(...args999504) {var args999 = $rjs_core.Pair.listFromArray(args999504);return M0.apply(proc996,M0.rnull,M0.rnull,args999);});if (M0.symbol_p(proc_name997)!==false) {var if_res505 = M0.__rjs_quoted__.procedure_rename(plain_proc998,proc_name997);} else {var if_res505 = plain_proc998;}return make_keyword_procedure(proc996,if_res505);};var cl502 = function(proc1000, plain_proc1001) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1000)!==false) {var if_res506 = M0.procedure_arity_mask(proc1000);} else {var if_res506 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res506),proc1000,M0.rnull,false,plain_proc1001);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam503 = {'1':cl501,'2':cl502}[arguments.length];if (fixed_lam503!==undefined) {return fixed_lam503.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1002, kws1003, kw_vals1004, normal_args1005, ...normal_argss1006507) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1006 = $rjs_core.Pair.listFromArray(normal_argss1006507);var type_error1007 = function(what1008, which1009) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1008,which1009,proc1002,kws1003,kw_vals1004,normal_args1005,normal_argss1006);};if (M0.procedure_p(proc1002)!==false) {var if_res508 = M0.rvoid();} else {var if_res508 = type_error1007($rjs_core.UString.make("procedure?"),0);}if_res508;var loop1010 = function(ks1011) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1011)!==false) {var if_res515 = M0.rvoid();} else {var or_part1012 = M0.not(M0.pair_p(ks1011));if (or_part1012!==false) {var if_res509 = or_part1012;} else {var if_res509 = M0.not(M0.keyword_p(M0.car(ks1011)));}if (if_res509!==false) {var if_res514 = type_error1007($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1011))!==false) {var if_res513 = M0.rvoid();} else {var or_part1013 = M0.not(M0.pair_p(M0.cdr(ks1011)));if (or_part1013!==false) {var if_res510 = or_part1013;} else {var if_res510 = M0.not(M0.keyword_p(M0.cadr(ks1011)));}if (if_res510!==false) {var if_res512 = loop1010(M0.cdr(ks1011));} else {if (M0.keyword_lt__p(M0.car(ks1011),M0.cadr(ks1011))!==false) {var if_res511 = loop1010(M0.cdr(ks1011));} else {var if_res511 = type_error1007($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res512 = if_res511;}var if_res513 = if_res512;}var if_res514 = if_res513;}var if_res515 = if_res514;}return if_res515;};loop1010(kws1003);if (M0.list_p(kw_vals1004)!==false) {var if_res516 = M0.rvoid();} else {var if_res516 = type_error1007($rjs_core.UString.make("list?"),2);}if_res516;if (M0.__eq_(M0.length(kws1003),M0.length(kw_vals1004))!==false) {var if_res517 = M0.rvoid();} else {var if_res517 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1003),$rjs_core.UString.make("value list length"),M0.length(kw_vals1004),$rjs_core.UString.make("keyword list"),kws1003,$rjs_core.UString.make("value list"),kw_vals1004);}if_res517;var loop1015 = function(normal_argss1016, pos1017) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1016))!==false) {var l1018 = M0.car(normal_argss1016);if (M0.list_p(l1018)!==false) {var if_res518 = l1018;} else {var if_res518 = type_error1007($rjs_core.UString.make("list?"),pos1017);}var if_res519 = if_res518;} else {var if_res519 = M0.cons(M0.car(normal_argss1016),loop1015(M0.cdr(normal_argss1016),M0.add1(pos1017)));}return if_res519;};var normal_args1014 = loop1015(M0.cons(normal_args1005,normal_argss1006),3);if (M0.null_p(kws1003)!==false) {var if_res520 = M0.apply(proc1002,normal_args1014);} else {var if_res520 = M0.apply(keyword_procedure_extract_by_method(kws1003,2+M0.length(normal_args1014),proc1002,0),kws1003,kw_vals1004,normal_args1014);}return if_res520;});var procedure_keywords = function(p1019) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1019)!==false) {var if_res525 = M0.values(keyword_procedure_required(p1019),keyword_procedure_allowed(p1019));} else {if (M0.procedure_p(p1019)!==false) {if (new_procedure_p(p1019)!==false) {var v1020 = new_procedure_ref(p1019);if (M0.procedure_p(v1020)!==false) {var if_res522 = procedure_keywords(v1020);} else {var a1021 = procedure_accessor_ref(p1019);if (a1021!==false) {var if_res521 = procedure_keywords(a1021(p1019));} else {var if_res521 = M0.values(M0.rnull,M0.rnull);}var if_res522 = if_res521;}var if_res523 = if_res522;} else {var if_res523 = M0.values(M0.rnull,M0.rnull);}var if_res524 = if_res523;} else {var if_res524 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1019);}var if_res525 = if_res524;}return if_res525;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1022, ...args1023526) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1023 = $rjs_core.Pair.listFromArray(args1023526);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1022,0),M0.rnull,M0.rnull,args1023);});var check_kw_args = function(p1024, kws1025) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1026 = function(kws1027, required1028, allowed1029) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1027)!==false) {if (M0.null_p(required1028)!==false) {var if_res527 = M0.values(false,false);} else {var if_res527 = M0.values(M0.car(required1028),false);}var if_res536 = if_res527;} else {if (M0.pair_p(required1028)!==false) {var if_res528 = M0.eq_p(M0.car(required1028),M0.car(kws1027));} else {var if_res528 = false;}if (if_res528!==false) {var temp531 = M0.cdr(kws1027);var temp530 = M0.cdr(required1028);if (allowed1029!==false) {var if_res529 = M0.cdr(allowed1029);} else {var if_res529 = false;}var if_res535 = loop1026(temp531,temp530,if_res529);} else {if (M0.not(allowed1029)!==false) {var if_res534 = loop1026(M0.cdr(kws1027),required1028,false);} else {if (M0.pair_p(allowed1029)!==false) {if (M0.eq_p(M0.car(allowed1029),M0.car(kws1027))!==false) {var if_res532 = loop1026(M0.cdr(kws1027),required1028,M0.cdr(allowed1029));} else {var if_res532 = loop1026(kws1027,required1028,M0.cdr(allowed1029));}var if_res533 = if_res532;} else {var if_res533 = M0.values(false,M0.car(kws1027));}var if_res534 = if_res533;}var if_res535 = if_res534;}var if_res536 = if_res535;}return if_res536;};return loop1026(kws1025,keyword_procedure_required(p1024),keyword_procedure_allowed(p1024));};var make_keyword_checker = function(req_kws1030, allowed_kws1031, arity_mask1032) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1031)!==false) {if (M0.null_p(req_kws1030)!==false) {var if_res539 = function(kws1033, a1034) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res537 = M0.bitwise_bit_set_p(arity_mask1032,a1034);} else {var if_res537 = false;}return if_res537;};} else {var if_res539 = function(kws1035, a1036) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1030,kws1035)!==false) {var if_res538 = M0.bitwise_bit_set_p(arity_mask1032,a1036);} else {var if_res538 = false;}return if_res538;};}var if_res552 = if_res539;} else {if (M0.null_p(allowed_kws1031)!==false) {var if_res551 = function(kws1037, a1038) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1037)!==false) {var if_res540 = M0.bitwise_bit_set_p(arity_mask1032,a1038);} else {var if_res540 = false;}return if_res540;};} else {if (M0.null_p(req_kws1030)!==false) {var if_res550 = function(kws1039, a1040) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1039,allowed_kws1031)!==false) {var if_res541 = M0.bitwise_bit_set_p(arity_mask1032,a1040);} else {var if_res541 = false;}return if_res541;};} else {if (M0.list_p(req_kws1030)!==false) {if (M0.list_p(allowed_kws1031)!==false) {var if_res542 = M0.eq_p(M0.length(req_kws1030),M0.length(allowed_kws1031));} else {var if_res542 = false;}var if_res543 = if_res542;} else {var if_res543 = false;}if (if_res543!==false) {var if_res549 = function(kws1041, a1042) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1043 = function(kws1044, req_kws1045) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1045)!==false) {var if_res546 = M0.null_p(kws1044);} else {if (M0.null_p(kws1044)!==false) {var if_res545 = false;} else {if (M0.eq_p(M0.car(kws1044),M0.car(req_kws1045))!==false) {var if_res544 = loop1043(M0.cdr(kws1044),M0.cdr(req_kws1045));} else {var if_res544 = false;}var if_res545 = if_res544;}var if_res546 = if_res545;}return if_res546;};if (loop1043(kws1041,req_kws1030)!==false) {var if_res547 = M0.bitwise_bit_set_p(arity_mask1032,a1042);} else {var if_res547 = false;}return if_res547;};} else {var if_res549 = function(kws1046, a1047) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1030,kws1046,allowed_kws1031)!==false) {var if_res548 = M0.bitwise_bit_set_p(arity_mask1032,a1047);} else {var if_res548 = false;}return if_res548;};}var if_res550 = if_res549;}var if_res551 = if_res550;}var if_res552 = if_res551;}return if_res552;};var subset_p = function(l11048, l21049) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11048)!==false) {var if_res555 = true;} else {if (M0.null_p(l21049)!==false) {var if_res554 = false;} else {if (M0.eq_p(M0.car(l11048),M0.car(l21049))!==false) {var if_res553 = subset_p(M0.cdr(l11048),M0.cdr(l21049));} else {var if_res553 = subset_p(l11048,M0.cdr(l21049));}var if_res554 = if_res553;}var if_res555 = if_res554;}return if_res555;};var subsets_p = function(l11050, l21051, l31052) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11050)!==false) {var if_res560 = subset_p(l21051,l31052);} else {if (M0.null_p(l21051)!==false) {var if_res559 = false;} else {if (M0.null_p(l31052)!==false) {var if_res558 = false;} else {var v21053 = M0.car(l21051);if (M0.eq_p(M0.car(l11050),v21053)!==false) {var if_res557 = subsets_p(M0.cdr(l11050),M0.cdr(l21051),M0.cdr(l31052));} else {if (M0.eq_p(v21053,M0.car(l31052))!==false) {var if_res556 = subsets_p(l11050,M0.cdr(l21051),M0.cdr(l31052));} else {var if_res556 = subsets_p(l11050,l21051,M0.cdr(l31052));}var if_res557 = if_res556;}var if_res558 = if_res557;}var if_res559 = if_res558;}var if_res560 = if_res559;}return if_res560;};var keyword_procedure_extract_by_method = function(kws1054, n1055, p1056, method_n1057) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1056)!==false) {var if_res561 = keyword_procedure_checker(p1056)(kws1054,n1055);} else {var if_res561 = false;}if (if_res561!==false) {var if_res591 = keyword_procedure_proc(p1056);} else {if (M0.not(keyword_procedure_p(p1056))!==false) {if (M0.procedure_p(p1056)!==false) {if (new_procedure_p(p1056)!==false) {var a1060 = procedure_accessor_ref(p1056);if (a1060!==false) {var if_res562 = a1060(p1056);} else {var if_res562 = false;}var if_res563 = if_res562;} else {var if_res563 = false;}var or_part1059 = if_res563;if (or_part1059!==false) {var if_res566 = or_part1059;} else {var or_part1061 = M0.procedure_extract_target(p1056);if (or_part1061!==false) {var if_res565 = or_part1061;} else {if (new_procedure_p(p1056)!==false) {var if_res564 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res564 = false;}var if_res565 = if_res564;}var if_res566 = if_res565;}var if_res567 = if_res566;} else {var if_res567 = false;}var if_res568 = if_res567;} else {var if_res568 = false;}var p21058 = if_res568;if (p21058!==false) {if (M0.eq_p(p21058,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31062 = keyword_procedure_extract_by_method(kws1054,M0.add1(n1055),new_procedure_ref(p1056),M0.add1(method_n1057));var if_res570 = $rjs_core.attachProcedureArity(function(kws1063, kw_args1064, ...args1065569) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1065 = $rjs_core.Pair.listFromArray(args1065569);return M0.apply(p31062,kws1063,kw_args1064,M0.cons(p1056,args1065));});} else {var if_res570 = keyword_procedure_extract_by_method(kws1054,n1055,p21058,method_n1057);}var if_res590 = if_res570;} else {var if_res590 = $rjs_core.attachProcedureArity(function(kws1066, kw_args1067, ...args1068571) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1068 = $rjs_core.Pair.listFromArray(args1068571);if (keyword_procedure_p(p1056)!==false) {var if_res572 = check_kw_args(p1056,kws1066);} else {var if_res572 = M0.values(false,M0.car(kws1066));}var let_result573 = if_res572;var missing_kw1069 = let_result573.getAt(0);var extra_kw1070 = let_result573.getAt(1);var or_part1075 = keyword_method_p(p1056);if (or_part1075!==false) {var if_res574 = or_part1075;} else {var if_res574 = okm_p(p1056);}if (if_res574!==false) {var if_res575 = 1;} else {var if_res575 = 0;}var method_n1074 = method_n1057+if_res575;if (M0.__gt__eq_(n1055,method_n1074)!==false) {var if_res576 = n1055-method_n1074;} else {var if_res576 = n1055;}var n1071 = if_res576;if (M0.null_p(args1068)!==false) {var if_res577 = M0.null_p(kws1066);} else {var if_res577 = false;}if (if_res577!==false) {var if_res578 = $rjs_core.UString.make("");} else {var if_res578 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1076) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1076);},args1068),M0.map(function(kw1077, kw_arg1078) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1077,kw_arg1078);},kws1066,kw_args1067)));}var args_str1072 = if_res578;var proc_name1073 = function(p1079) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1079)!==false) {var if_res579 = M0.car(keyword_procedure_name_plus_fail(p1079));} else {var if_res579 = false;}var or_part1080 = if_res579;if (or_part1080!==false) {var if_res581 = or_part1080;} else {var or_part1081 = M0.object_name(p1079);if (or_part1081!==false) {var if_res580 = or_part1081;} else {var if_res580 = p1079;}var if_res581 = if_res580;}return if_res581;};var or_part1082 = extra_kw1070;if (or_part1082!==false) {var if_res588 = or_part1082;} else {var if_res588 = missing_kw1069;}if (if_res588!==false) {var if_res589 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res589 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1070!==false) {if (keyword_procedure_p(p1056)!==false) {var if_res583 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1073(p1056),extra_kw1070,args_str1072);} else {if (M0.procedure_p(p1056)!==false) {var if_res582 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1073(p1056),args_str1072);} else {var if_res582 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1056,args_str1072);}var if_res583 = if_res582;}var if_res587 = if_res583;} else {if (missing_kw1069!==false) {var if_res586 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1073(p1056),missing_kw1069,args_str1072);} else {var temp585 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1071-2)!==false) {var if_res584 = $rjs_core.UString.make("");} else {var if_res584 = $rjs_core.UString.make("s");}var if_res586 = M0.format(temp585,n1071-2,if_res584,proc_name1073(p1056),args_str1072);}var if_res587 = if_res586;}return M0.raise(if_res589(if_res587,M0.current_continuation_marks()));});}var if_res591 = if_res590;}return if_res591;};var keyword_procedure_extract = function(p1083, kws1084, n1085) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1084,n1085,p1083,0);};var cl592 = function(proc1086, arity1087, req_kw1088, allowed_kw1089, name1090) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1086,arity1087,false,name1090,req_kw1088,allowed_kw1089);};var cl593 = function(proc1091, arity1092, req_kw1093, allowed_kw1094) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1091,arity1092,false,false,req_kw1093,allowed_kw1094);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam594 = {'5':cl592,'4':cl593}[arguments.length];if (fixed_lam594!==undefined) {return fixed_lam594.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl595 = function(proc1095, mask1096, req_kw1097, allowed_kw1098, name1099) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1095,false,mask1096,name1099,req_kw1097,allowed_kw1098);};var cl596 = function(proc1100, mask1101, req_kw1102, allowed_kw1103) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1100,false,mask1101,false,req_kw1102,allowed_kw1103);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam597 = {'5':cl595,'4':cl596}[arguments.length];if (fixed_lam597!==undefined) {return fixed_lam597.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1104, proc1105, arity1106, mask1107, name1108, req_kw1109, allowed_kw1110) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1105)!==false) {var if_res598 = okp_ref(proc1105,0);} else {var if_res598 = proc1105;}var p1112 = if_res598;if (arity1106!==false) {var if_res599 = M0.__rjs_quoted__.procedure_reduce_arity(p1112,arity1106);} else {var if_res599 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1112,mask1107,name1108);}var plain_proc1111 = if_res599;var sorted_p1113 = function(kws1114) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1115 = function(kws1116) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1116)!==false) {var if_res602 = true;} else {if (M0.null_p(M0.cdr(kws1116))!==false) {var if_res601 = true;} else {if (M0.keyword_lt__p(M0.car(kws1116),M0.cadr(kws1116))!==false) {var if_res600 = loop1115(M0.cdr(kws1116));} else {var if_res600 = false;}var if_res601 = if_res600;}var if_res602 = if_res601;}return if_res602;};return loop1115(kws1114);};if (M0.list_p(req_kw1109)!==false) {if (M0.andmap(M0.keyword_p,req_kw1109)!==false) {var if_res603 = sorted_p1113(req_kw1109);} else {var if_res603 = false;}var if_res604 = if_res603;} else {var if_res604 = false;}if (if_res604!==false) {var if_res607 = M0.rvoid();} else {var temp606 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1117 = arity1106;if (or_part1117!==false) {var if_res605 = or_part1117;} else {var if_res605 = mask1107;}var if_res607 = M0.raise_argument_error(who1104,temp606,2,proc1105,if_res605,req_kw1109,allowed_kw1110);}if_res607;if (allowed_kw1110!==false) {if (M0.list_p(allowed_kw1110)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1110)!==false) {var if_res608 = sorted_p1113(allowed_kw1110);} else {var if_res608 = false;}var if_res609 = if_res608;} else {var if_res609 = false;}if (if_res609!==false) {var if_res612 = M0.rvoid();} else {var temp611 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1118 = arity1106;if (or_part1118!==false) {var if_res610 = or_part1118;} else {var if_res610 = mask1107;}var if_res612 = M0.raise_argument_error(who1104,temp611,3,proc1105,if_res610,req_kw1109,allowed_kw1110);}if_res612;if (subset_p(req_kw1109,allowed_kw1110)!==false) {var if_res613 = M0.rvoid();} else {var if_res613 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1110,$rjs_core.UString.make("required keywords"),req_kw1109);}var if_res614 = if_res613;} else {var if_res614 = M0.rvoid();}if_res614;var let_result615 = procedure_keywords(proc1105);var old_req1119 = let_result615.getAt(0);var old_allowed1120 = let_result615.getAt(1);if (subset_p(old_req1119,req_kw1109)!==false) {var if_res616 = M0.rvoid();} else {var if_res616 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1119,$rjs_core.UString.make("requested required keywords"),req_kw1109);}if_res616;if (old_allowed1120!==false) {if (subset_p(req_kw1109,old_allowed1120)!==false) {var if_res617 = M0.rvoid();} else {var if_res617 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1120,$rjs_core.UString.make("requested required keywords"),req_kw1109);}if_res617;var or_part1121 = M0.not(allowed_kw1110);if (or_part1121!==false) {var if_res618 = or_part1121;} else {var if_res618 = subset_p(allowed_kw1110,old_allowed1120);}if (if_res618!==false) {var if_res619 = M0.rvoid();} else {var if_res619 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1120,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1110);}var if_res620 = if_res619;} else {var if_res620 = M0.rvoid();}if_res620;if (M0.null_p(allowed_kw1110)!==false) {var if_res628 = plain_proc1111;} else {var or_part1123 = mask1107;if (or_part1123!==false) {var if_res621 = or_part1123;} else {var if_res621 = arity__gt_mask(arity1106);}var mask1122 = if_res621;var new_mask1124 = M0.arithmetic_shift(mask1122,2);var kw_checker1125 = make_keyword_checker(req_kw1109,allowed_kw1110,new_mask1124);var proc1126 = normalize_proc(proc1105);var new_kw_proc1127 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1126),new_mask1124);if (M0.null_p(req_kw1109)!==false) {if (okm_p(proc1126)!==false) {var if_res622 = make_optional_keyword_method;} else {var if_res622 = make_optional_keyword_procedure;}var if_res627 = if_res622(kw_checker1125,new_kw_proc1127,req_kw1109,allowed_kw1110,plain_proc1111);} else {if (named_keyword_procedure_p(proc1126)!==false) {var if_res625 = M0.car(keyword_procedure_name_plus_fail(proc1126));} else {var if_res625 = false;}var or_part1128 = if_res625;if (or_part1128!==false) {var if_res626 = or_part1128;} else {var if_res626 = M0.object_name(proc1126);}var temp624 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1122,1));var or_part1129 = okm_p(proc1126);if (or_part1129!==false) {var if_res623 = or_part1129;} else {var if_res623 = keyword_method_p(proc1126);}var if_res627 = make_required(if_res626,temp624,if_res623,false)(kw_checker1125,new_kw_proc1127,req_kw1109,allowed_kw1110);}var if_res628 = if_res627;}return if_res628;};var arity__gt_mask = function(a1130) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1130)!==false) {var if_res634 = M0.arithmetic_shift(1,a1130);} else {if (M0.arity_at_least_p(a1130)!==false) {var if_res633 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1130))));} else {if (M0.list_p(a1130)!==false) {var loop1131 = function(mask1132, l1133) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1133)!==false) {var if_res631 = mask1132;} else {var a1134 = M0.car(l1133);var or_part1135 = M0.exact_nonnegative_integer_p(a1134);if (or_part1135!==false) {var if_res629 = or_part1135;} else {var if_res629 = M0.arity_at_least_p(a1134);}if (if_res629!==false) {var if_res630 = loop1131(M0.bitwise_ior(mask1132,arity__gt_mask(a1134)),M0.cdr(l1133));} else {var if_res630 = false;}var if_res631 = if_res630;}return if_res631;};var if_res632 = loop1131(0,a1130);} else {var if_res632 = false;}var if_res633 = if_res632;}var if_res634 = if_res633;}return if_res634;};var cl635 = function(proc1137, arity1138, name1139) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1137)!==false) {var let_result638 = procedure_keywords(proc1137);var req1140 = let_result638.getAt(0);var allows1141 = let_result638.getAt(1);if (M0.pair_p(req1140)!==false) {var if_res639 = M0.not(M0.null_p(arity1138));} else {var if_res639 = false;}var if_res640 = if_res639;} else {var if_res640 = false;}if (if_res640!==false) {var if_res642 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1137);} else {if (okm_p(proc1137)!==false) {var if_res641 = M0.__rjs_quoted__.procedure__gt_method(proc1137);} else {var if_res641 = proc1137;}var if_res642 = M0.__rjs_quoted__.procedure_reduce_arity(if_res641,arity1138,name1139);}return if_res642;};var cl636 = function(proc1142, arity1143) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1142,arity1143,false);};var procedure_reduce_arity1136 = $rjs_core.attachProcedureArity(function() {var fixed_lam637 = {'3':cl635,'2':cl636}[arguments.length];if (fixed_lam637!==undefined) {return fixed_lam637.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1136;var cl643 = function(proc1145, mask1146, name1147) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1145)!==false) {var let_result646 = procedure_keywords(proc1145);var req1148 = let_result646.getAt(0);var allows1149 = let_result646.getAt(1);if (M0.pair_p(req1148)!==false) {var if_res647 = M0.not(M0.eqv_p(mask1146,0));} else {var if_res647 = false;}var if_res648 = if_res647;} else {var if_res648 = false;}if (if_res648!==false) {var if_res650 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1145);} else {if (okm_p(proc1145)!==false) {var if_res649 = M0.__rjs_quoted__.procedure__gt_method(proc1145);} else {var if_res649 = proc1145;}var if_res650 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res649,mask1146,name1147);}return if_res650;};var cl644 = function(proc1150, mask1151) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1150,mask1151,false);};var procedure_reduce_arity1144 = $rjs_core.attachProcedureArity(function() {var fixed_lam645 = {'3':cl643,'2':cl644}[arguments.length];if (fixed_lam645!==undefined) {return fixed_lam645.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1144;var procedure__gt_method1152 = function(proc1153) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1154 = normalize_proc(proc1153);if (keyword_procedure_p(proc1154)!==false) {if (okm_p(proc1154)!==false) {var if_res653 = proc1154;} else {if (keyword_method_p(proc1154)!==false) {var if_res652 = proc1154;} else {if (okp_p(proc1154)!==false) {var if_res651 = make_optional_keyword_method(keyword_procedure_checker(proc1154),keyword_procedure_proc(proc1154),keyword_procedure_required(proc1154),keyword_procedure_allowed(proc1154),okp_ref(proc1154,0));} else {var name_plus_fail1155 = keyword_procedure_name_plus_fail(proc1154);var mk1156 = make_required(M0.car(name_plus_fail1155),M0.cdr(name_plus_fail1155),true,false);var if_res651 = mk1156(keyword_procedure_checker(proc1154),keyword_procedure_proc(proc1154),keyword_procedure_required(proc1154),keyword_procedure_allowed(proc1154));}var if_res652 = if_res651;}var if_res653 = if_res652;}var if_res654 = if_res653;} else {var if_res654 = M0.__rjs_quoted__.procedure__gt_method(proc1154);}return if_res654;};var new_procedure__gt_method = procedure__gt_method1152;var procedure_rename1157 = function(proc1158, name1159) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1158)!==false) {var if_res655 = M0.symbol_p(name1159);} else {var if_res655 = false;}if (M0.not(if_res655)!==false) {var if_res658 = M0.__rjs_quoted__.procedure_rename(proc1158,name1159);} else {if (okp_p(proc1158)!==false) {if (okm_p(proc1158)!==false) {var if_res656 = make_optional_keyword_method;} else {var if_res656 = make_optional_keyword_procedure;}var if_res657 = if_res656(keyword_procedure_checker(proc1158),keyword_procedure_proc(proc1158),keyword_procedure_required(proc1158),keyword_procedure_allowed(proc1158),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1158,0),name1159));} else {var name_plus_fail1160 = keyword_procedure_name_plus_fail(proc1158);var mk1161 = make_required(name1159,M0.cdr(name_plus_fail1160),keyword_method_p(proc1158),false);var if_res657 = mk1161(keyword_procedure_checker(proc1158),keyword_procedure_proc(proc1158),keyword_procedure_required(proc1158),keyword_procedure_allowed(proc1158));}var if_res658 = if_res657;}return if_res658;};var new_procedure_rename = procedure_rename1157;var chaperone_procedure1162 = $rjs_core.attachProcedureArity(function(proc1163, wrap_proc1164, ...props1165659) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1165 = $rjs_core.Pair.listFromArray(props1165659);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1163,wrap_proc1164,props1165);});var new_chaperone_procedure = chaperone_procedure1162;var unsafe_chaperone_procedure1166 = $rjs_core.attachProcedureArity(function(proc1167, wrap_proc1168, ...props1169660) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1169 = $rjs_core.Pair.listFromArray(props1169660);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1167,wrap_proc1168,props1169);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1166;var impersonate_procedure1170 = $rjs_core.attachProcedureArity(function(proc1171, wrap_proc1172, ...props1173661) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1173 = $rjs_core.Pair.listFromArray(props1173661);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1171,wrap_proc1172,props1173);});var new_impersonate_procedure = impersonate_procedure1170;var unsafe_impersonate_procedure1174 = $rjs_core.attachProcedureArity(function(proc1175, wrap_proc1176, ...props1177662) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1177 = $rjs_core.Pair.listFromArray(props1177662);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1175,wrap_proc1176,props1177);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1174;var chaperone_procedure_times_1178 = $rjs_core.attachProcedureArity(function(proc1179, wrap_proc1180, ...props1181663) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1181 = $rjs_core.Pair.listFromArray(props1181663);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1179,wrap_proc1180,props1181);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1178;var impersonate_procedure_times_1182 = $rjs_core.attachProcedureArity(function(proc1183, wrap_proc1184, ...props1185664) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1185 = $rjs_core.Pair.listFromArray(props1185664);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1183,wrap_proc1184,props1185);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1182;var do_chaperone_procedure = function(is_impersonator_p1186, self_arg_p1187, chaperone_procedure1188, name1189, proc1190, wrap_proc1191, props1192) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1193 = normalize_proc(proc1190);var n_wrap_proc1194 = normalize_proc(wrap_proc1191);var or_part1195 = M0.not(keyword_procedure_p(n_proc1193));if (or_part1195!==false) {var if_res666 = or_part1195;} else {var or_part1196 = M0.not(M0.procedure_p(wrap_proc1191));if (or_part1196!==false) {var if_res665 = or_part1196;} else {var if_res665 = bad_props_p(props1192);}var if_res666 = if_res665;}if (if_res666!==false) {var if_res733 = M0.apply(chaperone_procedure1188,proc1190,wrap_proc1191,props1192);} else {chaperone_arity_match_checking(self_arg_p1187,name1189,proc1190,wrap_proc1191,props1192);var loop1198 = function(props1199) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1199)!==false) {var if_res668 = false;} else {if (M0.eq_p(M0.car(props1199),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res667 = M0.cadr(props1199);} else {var if_res667 = loop1198(M0.cddr(props1199));}var if_res668 = if_res667;}return if_res668;};var mark_prop1197 = loop1198(props1192);var chaperone_procedure_by_add_mark1200 = function(proc1201, wrap_proc1202) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1197!==false) {var if_res669 = chaperone_procedure1188(proc1201,wrap_proc1202,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1197);} else {var if_res669 = chaperone_procedure1188(proc1201,wrap_proc1202);}return if_res669;};var p1204 = keyword_procedure_proc(n_wrap_proc1194);if (self_arg_p1187!==false) {var cl670 = $rjs_core.attachProcedureArity(function(self_proc1205, kws1206, args1207, ...rest1208675) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1208 = $rjs_core.Pair.listFromArray(rest1208675);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1204,kws1206,args1207,self_proc1205,rest1208);},$rjs_core.attachProcedureArity(function(...results1209676) {var results1209 = $rjs_core.Pair.listFromArray(results1209676);var len1210 = M0.length(results1209);var alen1211 = M0.length(rest1208);if (M0.__lt_(len1210,alen1211+1)!==false) {var if_res677 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1211+1,$rjs_core.UString.make("received number of results"),len1210,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);} else {var if_res677 = M0.rvoid();}if_res677;var num_extra1212 = len1210-(alen1211+1);var new_args1213 = M0.list_ref(results1209,num_extra1212);if (M0.list_p(new_args1213)!==false) {var if_res678 = M0.__eq_(M0.length(new_args1213),M0.length(args1207));} else {var if_res678 = false;}if (if_res678!==false) {var if_res682 = M0.rvoid();} else {var temp681 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp680 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1210,alen1211)!==false) {var if_res679 = $rjs_core.UString.make("");} else {var if_res679 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res682 = M0.raise_arguments_error(temp681,M0.format(temp680,if_res679),$rjs_core.UString.make("first result"),new_args1213,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}if_res682;M0.for_each(function(kw1214, new_arg1215, arg1216) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1186!==false) {var if_res684 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1215,arg1216)!==false) {var if_res683 = M0.rvoid();} else {var if_res683 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1214),$rjs_core.UString.make("result"),new_arg1215,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}var if_res684 = if_res683;}return if_res684;},kws1206,new_args1213,args1207);var tmp1217 = num_extra1212;if (M0.equal_p(tmp1217,0)!==false) {var if_res687 = M0.apply(M0.values,kws1206,results1209);} else {if (M0.equal_p(tmp1217,1)!==false) {var if_res686 = M0.apply(M0.values,M0.car(results1209),kws1206,M0.cdr(results1209));} else {var loop1218 = function(results1219, c1220) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1220)!==false) {var if_res685 = M0.cons(kws1206,results1219);} else {var if_res685 = M0.cons(M0.car(results1219),loop1218(M0.cdr(results1219),M0.sub1(c1220)));}return if_res685;};var if_res686 = M0.apply(M0.values,loop1218(results1209,num_extra1212));}var if_res687 = if_res686;}return if_res687;}));});var cl671 = $rjs_core.attachProcedureArity(function(...other1221688) {var other1221 = $rjs_core.Pair.listFromArray(other1221688);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res708 = $rjs_core.attachProcedureArity(function() {var fixed_lam672 = {}[arguments.length];if (fixed_lam672!==undefined) {return fixed_lam672.apply(null,arguments);} else {if (M0.__gt__eq_(cl670.length,1)!==false) {var if_res674 = cl670.apply(null,arguments);} else {if (true!==false) {var if_res673 = cl671.apply(null,arguments);} else {var if_res673 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res674 = if_res673;}return if_res674;}},[M0.make_arity_at_least(0)]);} else {var cl689 = $rjs_core.attachProcedureArity(function(kws1222, args1223, ...rest1224694) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1224 = $rjs_core.Pair.listFromArray(rest1224694);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1204,kws1222,args1223,rest1224);},$rjs_core.attachProcedureArity(function(...results1225695) {var results1225 = $rjs_core.Pair.listFromArray(results1225695);var len1226 = M0.length(results1225);var alen1227 = M0.length(rest1224);if (M0.__lt_(len1226,alen1227+1)!==false) {var if_res696 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1227+1,$rjs_core.UString.make("received number of results"),len1226,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);} else {var if_res696 = M0.rvoid();}if_res696;var num_extra1228 = len1226-(alen1227+1);var new_args1229 = M0.list_ref(results1225,num_extra1228);if (M0.list_p(new_args1229)!==false) {var if_res697 = M0.__eq_(M0.length(new_args1229),M0.length(args1223));} else {var if_res697 = false;}if (if_res697!==false) {var if_res701 = M0.rvoid();} else {var temp700 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp699 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1226,alen1227)!==false) {var if_res698 = $rjs_core.UString.make("");} else {var if_res698 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res701 = M0.raise_arguments_error(temp700,M0.format(temp699,if_res698),$rjs_core.UString.make("first result"),new_args1229,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}if_res701;M0.for_each(function(kw1230, new_arg1231, arg1232) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1186!==false) {var if_res703 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1231,arg1232)!==false) {var if_res702 = M0.rvoid();} else {var if_res702 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1230),$rjs_core.UString.make("result"),new_arg1231,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}var if_res703 = if_res702;}return if_res703;},kws1222,new_args1229,args1223);var tmp1233 = num_extra1228;if (M0.equal_p(tmp1233,0)!==false) {var if_res706 = M0.apply(M0.values,kws1222,results1225);} else {if (M0.equal_p(tmp1233,1)!==false) {var if_res705 = M0.apply(M0.values,M0.car(results1225),kws1222,M0.cdr(results1225));} else {var loop1234 = function(results1235, c1236) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1236)!==false) {var if_res704 = M0.cons(kws1222,results1235);} else {var if_res704 = M0.cons(M0.car(results1235),loop1234(M0.cdr(results1235),M0.sub1(c1236)));}return if_res704;};var if_res705 = M0.apply(M0.values,loop1234(results1225,num_extra1228));}var if_res706 = if_res705;}return if_res706;}));});var cl690 = $rjs_core.attachProcedureArity(function(...other1237707) {var other1237 = $rjs_core.Pair.listFromArray(other1237707);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res708 = $rjs_core.attachProcedureArity(function() {var fixed_lam691 = {}[arguments.length];if (fixed_lam691!==undefined) {return fixed_lam691.apply(null,arguments);} else {if (M0.__gt__eq_(cl689.length,1)!==false) {var if_res693 = cl689.apply(null,arguments);} else {if (true!==false) {var if_res692 = cl690.apply(null,arguments);} else {var if_res692 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res693 = if_res692;}return if_res693;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1203 = if_res708;var wrap1240 = function(proc1241, n_proc1242) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1242,proc1241))!==false) {var if_res709 = new_procedure_p(proc1241);} else {var if_res709 = false;}if (if_res709!==false) {var v1243 = new_procedure_ref(proc1241);if (M0.exact_integer_p(v1243)!==false) {var acc1244 = procedure_accessor_ref(proc1241);var if_res725 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1241,acc1244,function(self1245, sub_proc1246) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result710 = wrap1240(sub_proc1246,normalize_proc(sub_proc1246));var f1247 = let_result710.getAt(0);var acc1248 = let_result710.getAt(1);return f1247;}),acc1244);} else {if (is_impersonator_p1186!==false) {var if_res724 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res724 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1242)!==false) {var if_res723 = chaperone_procedure_by_add_mark1200(proc1241,wrap_proc1191);} else {var if_res723 = proc1241;}var new_kw_proc1249 = if_res724(if_res723,new_procedure_ref,function(self1250, proc1251) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1186!==false) {var if_res722 = new_impersonate_procedure;} else {var if_res722 = new_chaperone_procedure;}if (self_arg_p1187!==false) {var if_res721 = $rjs_core.attachProcedureArity(function(proc_self1252, kws1253, kw_args1254, self1255, ...args1256711) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1256 = $rjs_core.Pair.listFromArray(args1256711);var len1257 = M0.length(args1256);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1203,proc_self1252,kws1253,kw_args1254,args1256);},$rjs_core.attachProcedureArity(function(...results1258712) {var results1258 = $rjs_core.Pair.listFromArray(results1258712);var r_len1259 = M0.length(results1258);var list_take1260 = function(l1261, n1262) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1262)!==false) {var if_res713 = M0.rnull;} else {var if_res713 = M0.cons(M0.car(l1261),list_take1260(M0.cdr(l1261),M0.sub1(n1262)));}return if_res713;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res714 = M0.__eq_(r_len1259,2+len1257);} else {var if_res714 = false;}if (if_res714!==false) {var if_res715 = M0.apply(M0.values,M0.cadr(results1258),self1255,M0.cddr(results1258));} else {var skip1263 = r_len1259-len1257;var if_res715 = M0.apply(M0.values,M0.append(list_take1260(results1258,skip1263-2),M0.list(M0.list_ref(results1258,M0.sub1(skip1263)),self1255),M0.__rjs_quoted__.list_tail(results1258,skip1263)));}return if_res715;}));});} else {var if_res721 = $rjs_core.attachProcedureArity(function(kws1264, kw_args1265, self1266, ...args1267716) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1267 = $rjs_core.Pair.listFromArray(args1267716);var len1268 = M0.length(args1267);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1203,kws1264,kw_args1265,args1267);},$rjs_core.attachProcedureArity(function(...results1269717) {var results1269 = $rjs_core.Pair.listFromArray(results1269717);var r_len1270 = M0.length(results1269);var list_take1271 = function(l1272, n1273) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1273)!==false) {var if_res718 = M0.rnull;} else {var if_res718 = M0.cons(M0.car(l1272),list_take1271(M0.cdr(l1272),M0.sub1(n1273)));}return if_res718;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res719 = M0.__eq_(r_len1270,2+len1268);} else {var if_res719 = false;}if (if_res719!==false) {var if_res720 = M0.apply(M0.values,M0.cadr(results1269),self1266,M0.cddr(results1269));} else {var skip1274 = r_len1270-len1268;var if_res720 = M0.apply(M0.values,M0.append(list_take1271(results1269,skip1274-2),M0.list(M0.list_ref(results1269,M0.sub1(skip1274)),self1266),M0.__rjs_quoted__.list_tail(results1269,skip1274)));}return if_res720;}));});}return if_res722(proc1251,make_keyword_procedure(if_res721));});var if_res725 = M0.values(new_kw_proc1249,new_procedure_ref);}var if_res730 = if_res725;} else {if (okp_p(n_proc1242)!==false) {if (is_impersonator_p1186!==false) {if (okm_p(n_proc1242)!==false) {var if_res726 = make_optional_keyword_method_impersonator;} else {var if_res726 = make_optional_keyword_procedure_impersonator;}var if_res727 = if_res726(keyword_procedure_checker(n_proc1242),chaperone_procedure_by_add_mark1200(keyword_procedure_proc(n_proc1242),kw_chaperone1203),keyword_procedure_required(n_proc1242),keyword_procedure_allowed(n_proc1242),chaperone_procedure_by_add_mark1200(okp_ref(n_proc1242,0),okp_ref(n_wrap_proc1194,0)),n_proc1242);} else {var if_res727 = M0.__rjs_quoted__.chaperone_struct(proc1241,keyword_procedure_proc,function(self1275, proc1276) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1200(proc1276,kw_chaperone1203);},M0.make_struct_field_accessor(okp_ref,0),function(self1277, proc1278) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1200(proc1278,okp_ref(n_wrap_proc1194,0));});}var if_res729 = M0.values(if_res727,keyword_procedure_proc);} else {if (is_impersonator_p1186!==false) {var name_plus_fail1279 = keyword_procedure_name_plus_fail(n_proc1242);var mk1280 = make_required(M0.car(name_plus_fail1279),M0.cdr(name_plus_fail1279),keyword_method_p(n_proc1242),true);var if_res728 = mk1280(keyword_procedure_checker(n_proc1242),chaperone_procedure_by_add_mark1200(keyword_procedure_proc(n_proc1242),kw_chaperone1203),keyword_procedure_required(n_proc1242),keyword_procedure_allowed(n_proc1242),n_proc1242);} else {var if_res728 = M0.__rjs_quoted__.chaperone_struct(n_proc1242,keyword_procedure_proc,function(self1281, proc1282) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1200(proc1282,kw_chaperone1203);});}var if_res729 = M0.values(if_res728,keyword_procedure_proc);}var if_res730 = if_res729;}return if_res730;};var let_result731 = wrap1240(proc1190,n_proc1193);var new_proc1238 = let_result731.getAt(0);var chap_accessor1239 = let_result731.getAt(1);if (M0.null_p(props1192)!==false) {var if_res732 = new_proc1238;} else {var if_res732 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1238,chap_accessor1239,false,props1192);}var if_res733 = if_res732;}return if_res733;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1283, name1284, proc1285, wrap_proc1286, props1287) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1288 = normalize_proc(proc1285);var n_wrap_proc1289 = normalize_proc(wrap_proc1286);var or_part1290 = M0.not(keyword_procedure_p(n_proc1288));if (or_part1290!==false) {var if_res735 = or_part1290;} else {var or_part1291 = M0.not(M0.procedure_p(wrap_proc1286));if (or_part1291!==false) {var if_res734 = or_part1291;} else {var if_res734 = bad_props_p(props1287);}var if_res735 = if_res734;}if (if_res735!==false) {var if_res736 = M0.apply(unsafe_chaperone_procedure1283,proc1285,wrap_proc1286,props1287);} else {chaperone_arity_match_checking(false,name1284,proc1285,wrap_proc1286,props1287);var if_res736 = M0.apply(unsafe_chaperone_procedure1283,proc1285,wrap_proc1286,props1287);}return if_res736;};var bad_props_p = function(props1292) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1293 = function(props1294) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1294)!==false) {var if_res739 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1294))!==false) {var props1295 = M0.cdr(props1294);var or_part1296 = M0.null_p(props1295);if (or_part1296!==false) {var if_res737 = or_part1296;} else {var if_res737 = loop1293(M0.cdr(props1295));}var if_res738 = if_res737;} else {var if_res738 = true;}var if_res739 = if_res738;}return if_res739;};return loop1293(props1292);};var chaperone_arity_match_checking = function(self_arg_p1297, name1298, proc1299, wrap_proc1300, props1301) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1302 = M0.procedure_arity(proc1299);var b1303 = M0.procedure_arity(wrap_proc1300);if (self_arg_p1297!==false) {var if_res740 = 1;} else {var if_res740 = 0;}var d1304 = if_res740;var let_result741 = procedure_keywords(proc1299);var a_req1305 = let_result741.getAt(0);var a_allow1306 = let_result741.getAt(1);var let_result742 = procedure_keywords(wrap_proc1300);var b_req1307 = let_result742.getAt(0);var b_allow1308 = let_result742.getAt(1);var includes_p1309 = function(a1310, b1311) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1311)!==false) {if (M0.number_p(a1310)!==false) {var if_res744 = M0.__eq_(b1311,a1310+d1304);} else {if (M0.arity_at_least_p(a1310)!==false) {var if_res743 = M0.__gt__eq_(b1311,M0.arity_at_least_value(a1310)+d1304);} else {var if_res743 = M0.ormap(function(a1312) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1309(a1312,b1311);},a1310);}var if_res744 = if_res743;}var if_res748 = if_res744;} else {if (M0.arity_at_least_p(b1311)!==false) {if (M0.number_p(a1310)!==false) {var if_res746 = false;} else {if (M0.arity_at_least_p(a1310)!==false) {var if_res745 = M0.__gt__eq_(M0.arity_at_least_value(b1311),M0.arity_at_least_value(a1310)+d1304);} else {var if_res745 = M0.ormap(function(a1313) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1309(b1311,a1313);},a1310);}var if_res746 = if_res745;}var if_res747 = if_res746;} else {var if_res747 = M0.andmap(function(b1314) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1309(a1310,b1314);},b1311);}var if_res748 = if_res747;}return if_res748;};if (includes_p1309(b1303,a1302)!==false) {var if_res749 = M0.rvoid();} else {var if_res749 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1299,wrap_proc1300,props1301);}if_res749;if (subset_p(b_req1307,a_req1305)!==false) {var if_res750 = M0.rvoid();} else {var if_res750 = M0.raise_arguments_error(name1298,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1300,$rjs_core.UString.make("original procedure"),proc1299);}if_res750;var or_part1315 = M0.not(b_allow1308);if (or_part1315!==false) {var if_res752 = or_part1315;} else {if (a_allow1306!==false) {var if_res751 = subset_p(a_allow1306,b_allow1308);} else {var if_res751 = false;}var if_res752 = if_res751;}if (if_res752!==false) {var if_res753 = M0.rvoid();} else {var if_res753 = M0.raise_arguments_error(name1298,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1300,$rjs_core.UString.make("original procedure"),proc1299);}if_res753;return M0.rvoid();};var normalize_proc = function(proc1316) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1316)!==false) {var if_res761 = proc1316;} else {if (new_procedure_p(proc1316)!==false) {var let_result754 = procedure_keywords(proc1316);var req_kws1317 = let_result754.getAt(0);var allowed_kws1318 = let_result754.getAt(1);if (M0.null_p(allowed_kws1318)!==false) {var if_res759 = proc1316;} else {var if_res759 = make_optional_keyword_procedure(function(given_kws1319, given_argc1320) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1316,given_argc1320-2,true)!==false) {var or_part1321 = M0.not(allowed_kws1318);if (or_part1321!==false) {var if_res756 = or_part1321;} else {var if_res756 = subset_p(given_kws1319,allowed_kws1318);}if (if_res756!==false) {var if_res757 = subset_p(req_kws1317,given_kws1319);} else {var if_res757 = false;}var if_res758 = if_res757;} else {var if_res758 = false;}return if_res758;},$rjs_core.attachProcedureArity(function(kws1322, kw_args1323, ...vals1324755) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1324 = $rjs_core.Pair.listFromArray(vals1324755);return keyword_apply(proc1316,kws1322,kw_args1323,vals1324);}),req_kws1317,allowed_kws1318,proc1316);}var if_res760 = if_res759;} else {var if_res760 = proc1316;}var if_res761 = if_res760;}return if_res761;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };