import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result463 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result463.getAt(0);var keyword_impersonator_p = let_result463.getAt(1);var keyword_impersonator_ref = let_result463.getAt(2);var keyword_procedure_impersonator_of = function(v960) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v960)!==false) {var if_res464 = keyword_impersonator_ref(v960)(v960);} else {var if_res464 = false;}return if_res464;};var let_result465 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result465.getAt(0);var mk_kw_proc = let_result465.getAt(1);var keyword_procedure_p = let_result465.getAt(2);var keyword_procedure_ref = let_result465.getAt(3);var keyword_procedure_set_bang_ = let_result465.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result466 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result466.getAt(0);var make_km = let_result466.getAt(1);var keyword_method_p = let_result466.getAt(2);var km_ref = let_result466.getAt(3);var km_set_bang_ = let_result466.getAt(4);var generate_arity_string = function(proc961) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result467 = procedure_keywords(proc961);var req962 = let_result467.getAt(0);var allowed963 = let_result467.getAt(1);var a964 = M0.procedure_arity(proc961);var keywords_desc965 = function(opt967, req968) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp473 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req968))!==false) {var if_res472 = M0.format($rjs_core.UString.make("an ~aargument"),opt967);} else {var if_res472 = M0.format($rjs_core.UString.make("~aarguments"),opt967);}if (M0.null_p(M0.cdr(req968))!==false) {var if_res471 = $rjs_core.UString.make("");} else {var if_res471 = $rjs_core.UString.make("s");}var tmp969 = M0.length(req968);if (M0.equal_p(tmp969,1)!==false) {var if_res470 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req968));} else {if (M0.equal_p(tmp969,2)!==false) {var if_res469 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req968),M0.cadr(req968));} else {var loop970 = function(req971) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req971))!==false) {var if_res468 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req971));} else {var if_res468 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req971),loop970(M0.cdr(req971)));}return if_res468;};var if_res469 = loop970(req968);}var if_res470 = if_res469;}return M0.format(temp473,if_res472,if_res471,if_res470);};var method_adjust966 = function(a972) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part973 = okm_p(proc961);if (or_part973!==false) {var if_res474 = or_part973;} else {var if_res474 = keyword_method_p(proc961);}if (if_res474!==false) {if (M0.zero_p(a972)!==false) {var if_res475 = 0;} else {var if_res475 = M0.sub1(a972);}var if_res476 = if_res475;} else {var if_res476 = a972;}return if_res476;};if (M0.number_p(a964)!==false) {var a974 = method_adjust966(a964);var if_res483 = M0.format($rjs_core.UString.make("~a"),a974);} else {if (M0.arity_at_least_p(a964)!==false) {var a975 = method_adjust966(M0.arity_at_least_value(a964));var if_res482 = M0.format($rjs_core.UString.make("at least ~a"),a975);} else {var if_res482 = $rjs_core.UString.make("a different number");}var if_res483 = if_res482;}if (M0.null_p(req962)!==false) {var if_res481 = $rjs_core.UString.make("");} else {var if_res481 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc965($rjs_core.UString.make(""),req962));}if (allowed963!==false) {var loop977 = function(req978, allowed979) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req978)!==false) {var if_res478 = allowed979;} else {if (M0.eq_p(M0.car(req978),M0.car(allowed979))!==false) {var if_res477 = loop977(M0.cdr(req978),M0.cdr(allowed979));} else {var if_res477 = M0.cons(M0.car(allowed979),loop977(req978,M0.cdr(allowed979)));}var if_res478 = if_res477;}return if_res478;};var others976 = loop977(req962,allowed963);if (M0.null_p(others976)!==false) {var if_res479 = $rjs_core.UString.make("");} else {var if_res479 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc965($rjs_core.UString.make("optional "),others976));}var if_res480 = if_res479;} else {var if_res480 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res483,if_res481,if_res480);};var let_result484 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result484.getAt(0);var make_optional_keyword_procedure = let_result484.getAt(1);var okp_p = let_result484.getAt(2);var okp_ref = let_result484.getAt(3);var okp_set_bang_ = let_result484.getAt(4);var let_result485 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result485.getAt(0);var make_optional_keyword_method = let_result485.getAt(1);var okm_p = let_result485.getAt(2);var okm_ref = let_result485.getAt(3);var okm_set_bang_ = let_result485.getAt(4);var let_result486 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result486.getAt(0);var named_keyword_procedure_p = let_result486.getAt(1);var keyword_procedure_name_plus_fail = let_result486.getAt(2);var let_result488 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v980, info_l981) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v980)!==false) {var if_res487 = M0.make_struct_field_accessor(M0.list_ref(info_l981,3),v980);} else {var if_res487 = false;}return if_res487;});var prop_procedure_accessor = let_result488.getAt(0);var procedure_accessor_p = let_result488.getAt(1);var procedure_accessor_ref = let_result488.getAt(2);var let_result489 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result489.getAt(0);var new_procedure_p = let_result489.getAt(1);var new_procedure_ref = let_result489.getAt(2);var let_result490 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v982) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v982,0);})));var struct_keyword_procedure_impersonator = let_result490.getAt(0);var make_kpp = let_result490.getAt(1);var keyword_procedure_impersonator_p = let_result490.getAt(2);var kpp_ref = let_result490.getAt(3);var kpp_set_bang_ = let_result490.getAt(4);var let_result491 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v983) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v983,0);})));var struct_keyword_method_impersonator = let_result491.getAt(0);var make_kmp = let_result491.getAt(1);var keyword_method_impersonator_p = let_result491.getAt(2);var kmp_ref = let_result491.getAt(3);var kmp_set_bang_ = let_result491.getAt(4);var let_result492 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v984) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v984,0);})));var struct_okpp = let_result492.getAt(0);var make_optional_keyword_procedure_impersonator = let_result492.getAt(1);var okpp_p = let_result492.getAt(2);var okpp_ref = let_result492.getAt(3);var okpp_set_bang_ = let_result492.getAt(4);var let_result493 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v985) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v985,0);})));var struct_okmp = let_result493.getAt(0);var make_optional_keyword_method_impersonator = let_result493.getAt(1);var okmp_p = let_result493.getAt(2);var okmp_ref = let_result493.getAt(3);var okmp_set_bang_ = let_result493.getAt(4);var let_result494 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result494.getAt(0);var make_kp_by_ae = let_result494.getAt(1);var kp_by_ae_p = let_result494.getAt(2);var kp_by_ae_ref = let_result494.getAt(3);var kp_by_ae_set_bang_ = let_result494.getAt(4);var let_result495 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result495.getAt(0);var make_km_by_ae = let_result495.getAt(1);var km_by_ae_p = let_result495.getAt(2);var km_by_ae_ref = let_result495.getAt(3);var km_by_ae_set_bang_ = let_result495.getAt(4);var let_result496 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result496.getAt(0);var make_kpi_by_ae = let_result496.getAt(1);var kpi_by_ae_p = let_result496.getAt(2);var kpi_by_ae_ref = let_result496.getAt(3);var kpi_by_ae_set_bang_ = let_result496.getAt(4);var let_result497 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result497.getAt(0);var make_kmi_by_ae = let_result497.getAt(1);var kmi_by_ae_p = let_result497.getAt(2);var kmi_by_ae_ref = let_result497.getAt(3);var kmi_by_ae_set_bang_ = let_result497.getAt(4);var make_required = function(name986, fail_proc987, method_p988, impersonator_p989) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part995 = name986;if (or_part995!==false) {var if_res501 = or_part995;} else {var if_res501 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p989!==false) {if (method_p988!==false) {var if_res498 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res498 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res500 = if_res498;} else {if (method_p988!==false) {var if_res499 = struct_keyword_method_by_arity_error;} else {var if_res499 = struct_keyword_procedure_by_arity_error;}var if_res500 = if_res499;}var let_result502 = M0.make_struct_type(if_res501,if_res500,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name986,fail_proc987))),M0.current_inspector(),fail_proc987);var s_990 = let_result502.getAt(0);var mk991 = let_result502.getAt(1);var __p992 = let_result502.getAt(2);var __ref993 = let_result502.getAt(3);var __set_bang_994 = let_result502.getAt(4);return mk991;};var cl503 = function(proc996) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name997 = M0.object_name(proc996);var plain_proc998 = $rjs_core.attachProcedureArity(function(...args999506) {var args999 = $rjs_core.Pair.listFromArray(args999506);return M0.apply(proc996,M0.rnull,M0.rnull,args999);});if (M0.symbol_p(proc_name997)!==false) {var if_res507 = M0.__rjs_quoted__.procedure_rename(plain_proc998,proc_name997);} else {var if_res507 = plain_proc998;}return make_keyword_procedure(proc996,if_res507);};var cl504 = function(proc1000, plain_proc1001) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1000)!==false) {var if_res508 = M0.procedure_arity_mask(proc1000);} else {var if_res508 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res508),proc1000,M0.rnull,false,plain_proc1001);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam505 = {'1':cl503,'2':cl504}[arguments.length];if (fixed_lam505!==undefined) {return fixed_lam505.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1002, kws1003, kw_vals1004, normal_args1005, ...normal_argss1006509) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss1006 = $rjs_core.Pair.listFromArray(normal_argss1006509);var type_error1007 = function(what1008, which1009) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1008,which1009,proc1002,kws1003,kw_vals1004,normal_args1005,normal_argss1006);};if (M0.procedure_p(proc1002)!==false) {var if_res510 = M0.rvoid();} else {var if_res510 = type_error1007($rjs_core.UString.make("procedure?"),0);}if_res510;var loop1010 = function(ks1011) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks1011)!==false) {var if_res517 = M0.rvoid();} else {var or_part1012 = M0.not(M0.pair_p(ks1011));if (or_part1012!==false) {var if_res511 = or_part1012;} else {var if_res511 = M0.not(M0.keyword_p(M0.car(ks1011)));}if (if_res511!==false) {var if_res516 = type_error1007($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1011))!==false) {var if_res515 = M0.rvoid();} else {var or_part1013 = M0.not(M0.pair_p(M0.cdr(ks1011)));if (or_part1013!==false) {var if_res512 = or_part1013;} else {var if_res512 = M0.not(M0.keyword_p(M0.cadr(ks1011)));}if (if_res512!==false) {var if_res514 = loop1010(M0.cdr(ks1011));} else {if (M0.keyword_lt__p(M0.car(ks1011),M0.cadr(ks1011))!==false) {var if_res513 = loop1010(M0.cdr(ks1011));} else {var if_res513 = type_error1007($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res514 = if_res513;}var if_res515 = if_res514;}var if_res516 = if_res515;}var if_res517 = if_res516;}return if_res517;};loop1010(kws1003);if (M0.list_p(kw_vals1004)!==false) {var if_res518 = M0.rvoid();} else {var if_res518 = type_error1007($rjs_core.UString.make("list?"),2);}if_res518;if (M0.__eq_(M0.length(kws1003),M0.length(kw_vals1004))!==false) {var if_res519 = M0.rvoid();} else {var if_res519 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1003),$rjs_core.UString.make("value list length"),M0.length(kw_vals1004),$rjs_core.UString.make("keyword list"),kws1003,$rjs_core.UString.make("value list"),kw_vals1004);}if_res519;var loop1015 = function(normal_argss1016, pos1017) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss1016))!==false) {var l1018 = M0.car(normal_argss1016);if (M0.list_p(l1018)!==false) {var if_res520 = l1018;} else {var if_res520 = type_error1007($rjs_core.UString.make("list?"),pos1017);}var if_res521 = if_res520;} else {var if_res521 = M0.cons(M0.car(normal_argss1016),loop1015(M0.cdr(normal_argss1016),M0.add1(pos1017)));}return if_res521;};var normal_args1014 = loop1015(M0.cons(normal_args1005,normal_argss1006),3);if (M0.null_p(kws1003)!==false) {var if_res522 = M0.apply(proc1002,normal_args1014);} else {var if_res522 = M0.apply(keyword_procedure_extract_by_method(kws1003,2+M0.length(normal_args1014),proc1002,0),kws1003,kw_vals1004,normal_args1014);}return if_res522;});var procedure_keywords = function(p1019) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1019)!==false) {var if_res527 = M0.values(keyword_procedure_required(p1019),keyword_procedure_allowed(p1019));} else {if (M0.procedure_p(p1019)!==false) {if (new_procedure_p(p1019)!==false) {var v1020 = new_procedure_ref(p1019);if (M0.procedure_p(v1020)!==false) {var if_res524 = procedure_keywords(v1020);} else {var a1021 = procedure_accessor_ref(p1019);if (a1021!==false) {var if_res523 = procedure_keywords(a1021(p1019));} else {var if_res523 = M0.values(M0.rnull,M0.rnull);}var if_res524 = if_res523;}var if_res525 = if_res524;} else {var if_res525 = M0.values(M0.rnull,M0.rnull);}var if_res526 = if_res525;} else {var if_res526 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1019);}var if_res527 = if_res526;}return if_res527;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1022, ...args1023528) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1023 = $rjs_core.Pair.listFromArray(args1023528);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1022,0),M0.rnull,M0.rnull,args1023);});var check_kw_args = function(p1024, kws1025) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1026 = function(kws1027, required1028, allowed1029) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1027)!==false) {if (M0.null_p(required1028)!==false) {var if_res529 = M0.values(false,false);} else {var if_res529 = M0.values(M0.car(required1028),false);}var if_res538 = if_res529;} else {if (M0.pair_p(required1028)!==false) {var if_res530 = M0.eq_p(M0.car(required1028),M0.car(kws1027));} else {var if_res530 = false;}if (if_res530!==false) {var temp533 = M0.cdr(kws1027);var temp532 = M0.cdr(required1028);if (allowed1029!==false) {var if_res531 = M0.cdr(allowed1029);} else {var if_res531 = false;}var if_res537 = loop1026(temp533,temp532,if_res531);} else {if (M0.not(allowed1029)!==false) {var if_res536 = loop1026(M0.cdr(kws1027),required1028,false);} else {if (M0.pair_p(allowed1029)!==false) {if (M0.eq_p(M0.car(allowed1029),M0.car(kws1027))!==false) {var if_res534 = loop1026(M0.cdr(kws1027),required1028,M0.cdr(allowed1029));} else {var if_res534 = loop1026(kws1027,required1028,M0.cdr(allowed1029));}var if_res535 = if_res534;} else {var if_res535 = M0.values(false,M0.car(kws1027));}var if_res536 = if_res535;}var if_res537 = if_res536;}var if_res538 = if_res537;}return if_res538;};return loop1026(kws1025,keyword_procedure_required(p1024),keyword_procedure_allowed(p1024));};var make_keyword_checker = function(req_kws1030, allowed_kws1031, arity_mask1032) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws1031)!==false) {if (M0.null_p(req_kws1030)!==false) {var if_res541 = function(kws1033, a1034) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res539 = M0.bitwise_bit_set_p(arity_mask1032,a1034);} else {var if_res539 = false;}return if_res539;};} else {var if_res541 = function(kws1035, a1036) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws1030,kws1035)!==false) {var if_res540 = M0.bitwise_bit_set_p(arity_mask1032,a1036);} else {var if_res540 = false;}return if_res540;};}var if_res554 = if_res541;} else {if (M0.null_p(allowed_kws1031)!==false) {var if_res553 = function(kws1037, a1038) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1037)!==false) {var if_res542 = M0.bitwise_bit_set_p(arity_mask1032,a1038);} else {var if_res542 = false;}return if_res542;};} else {if (M0.null_p(req_kws1030)!==false) {var if_res552 = function(kws1039, a1040) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws1039,allowed_kws1031)!==false) {var if_res543 = M0.bitwise_bit_set_p(arity_mask1032,a1040);} else {var if_res543 = false;}return if_res543;};} else {if (M0.list_p(req_kws1030)!==false) {if (M0.list_p(allowed_kws1031)!==false) {var if_res544 = M0.eq_p(M0.length(req_kws1030),M0.length(allowed_kws1031));} else {var if_res544 = false;}var if_res545 = if_res544;} else {var if_res545 = false;}if (if_res545!==false) {var if_res551 = function(kws1041, a1042) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1043 = function(kws1044, req_kws1045) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws1045)!==false) {var if_res548 = M0.null_p(kws1044);} else {if (M0.null_p(kws1044)!==false) {var if_res547 = false;} else {if (M0.eq_p(M0.car(kws1044),M0.car(req_kws1045))!==false) {var if_res546 = loop1043(M0.cdr(kws1044),M0.cdr(req_kws1045));} else {var if_res546 = false;}var if_res547 = if_res546;}var if_res548 = if_res547;}return if_res548;};if (loop1043(kws1041,req_kws1030)!==false) {var if_res549 = M0.bitwise_bit_set_p(arity_mask1032,a1042);} else {var if_res549 = false;}return if_res549;};} else {var if_res551 = function(kws1046, a1047) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws1030,kws1046,allowed_kws1031)!==false) {var if_res550 = M0.bitwise_bit_set_p(arity_mask1032,a1047);} else {var if_res550 = false;}return if_res550;};}var if_res552 = if_res551;}var if_res553 = if_res552;}var if_res554 = if_res553;}return if_res554;};var subset_p = function(l11048, l21049) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11048)!==false) {var if_res557 = true;} else {if (M0.null_p(l21049)!==false) {var if_res556 = false;} else {if (M0.eq_p(M0.car(l11048),M0.car(l21049))!==false) {var if_res555 = subset_p(M0.cdr(l11048),M0.cdr(l21049));} else {var if_res555 = subset_p(l11048,M0.cdr(l21049));}var if_res556 = if_res555;}var if_res557 = if_res556;}return if_res557;};var subsets_p = function(l11050, l21051, l31052) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l11050)!==false) {var if_res562 = subset_p(l21051,l31052);} else {if (M0.null_p(l21051)!==false) {var if_res561 = false;} else {if (M0.null_p(l31052)!==false) {var if_res560 = false;} else {var v21053 = M0.car(l21051);if (M0.eq_p(M0.car(l11050),v21053)!==false) {var if_res559 = subsets_p(M0.cdr(l11050),M0.cdr(l21051),M0.cdr(l31052));} else {if (M0.eq_p(v21053,M0.car(l31052))!==false) {var if_res558 = subsets_p(l11050,M0.cdr(l21051),M0.cdr(l31052));} else {var if_res558 = subsets_p(l11050,l21051,M0.cdr(l31052));}var if_res559 = if_res558;}var if_res560 = if_res559;}var if_res561 = if_res560;}var if_res562 = if_res561;}return if_res562;};var keyword_procedure_extract_by_method = function(kws1054, n1055, p1056, method_n1057) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p1056)!==false) {var if_res563 = keyword_procedure_checker(p1056)(kws1054,n1055);} else {var if_res563 = false;}if (if_res563!==false) {var if_res593 = keyword_procedure_proc(p1056);} else {if (M0.not(keyword_procedure_p(p1056))!==false) {if (M0.procedure_p(p1056)!==false) {if (new_procedure_p(p1056)!==false) {var a1060 = procedure_accessor_ref(p1056);if (a1060!==false) {var if_res564 = a1060(p1056);} else {var if_res564 = false;}var if_res565 = if_res564;} else {var if_res565 = false;}var or_part1059 = if_res565;if (or_part1059!==false) {var if_res568 = or_part1059;} else {var or_part1061 = M0.procedure_extract_target(p1056);if (or_part1061!==false) {var if_res567 = or_part1061;} else {if (new_procedure_p(p1056)!==false) {var if_res566 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res566 = false;}var if_res567 = if_res566;}var if_res568 = if_res567;}var if_res569 = if_res568;} else {var if_res569 = false;}var if_res570 = if_res569;} else {var if_res570 = false;}var p21058 = if_res570;if (p21058!==false) {if (M0.eq_p(p21058,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31062 = keyword_procedure_extract_by_method(kws1054,M0.add1(n1055),new_procedure_ref(p1056),M0.add1(method_n1057));var if_res572 = $rjs_core.attachProcedureArity(function(kws1063, kw_args1064, ...args1065571) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1065 = $rjs_core.Pair.listFromArray(args1065571);return M0.apply(p31062,kws1063,kw_args1064,M0.cons(p1056,args1065));});} else {var if_res572 = keyword_procedure_extract_by_method(kws1054,n1055,p21058,method_n1057);}var if_res592 = if_res572;} else {var if_res592 = $rjs_core.attachProcedureArity(function(kws1066, kw_args1067, ...args1068573) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1068 = $rjs_core.Pair.listFromArray(args1068573);if (keyword_procedure_p(p1056)!==false) {var if_res574 = check_kw_args(p1056,kws1066);} else {var if_res574 = M0.values(false,M0.car(kws1066));}var let_result575 = if_res574;var missing_kw1069 = let_result575.getAt(0);var extra_kw1070 = let_result575.getAt(1);var or_part1075 = keyword_method_p(p1056);if (or_part1075!==false) {var if_res576 = or_part1075;} else {var if_res576 = okm_p(p1056);}if (if_res576!==false) {var if_res577 = 1;} else {var if_res577 = 0;}var method_n1074 = method_n1057+if_res577;if (M0.__gt__eq_(n1055,method_n1074)!==false) {var if_res578 = n1055-method_n1074;} else {var if_res578 = n1055;}var n1071 = if_res578;if (M0.null_p(args1068)!==false) {var if_res579 = M0.null_p(kws1066);} else {var if_res579 = false;}if (if_res579!==false) {var if_res580 = $rjs_core.UString.make("");} else {var if_res580 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1076) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v1076);},args1068),M0.map(function(kw1077, kw_arg1078) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1077,kw_arg1078);},kws1066,kw_args1067)));}var args_str1072 = if_res580;var proc_name1073 = function(p1079) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p1079)!==false) {var if_res581 = M0.car(keyword_procedure_name_plus_fail(p1079));} else {var if_res581 = false;}var or_part1080 = if_res581;if (or_part1080!==false) {var if_res583 = or_part1080;} else {var or_part1081 = M0.object_name(p1079);if (or_part1081!==false) {var if_res582 = or_part1081;} else {var if_res582 = p1079;}var if_res583 = if_res582;}return if_res583;};var or_part1082 = extra_kw1070;if (or_part1082!==false) {var if_res590 = or_part1082;} else {var if_res590 = missing_kw1069;}if (if_res590!==false) {var if_res591 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res591 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1070!==false) {if (keyword_procedure_p(p1056)!==false) {var if_res585 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1073(p1056),extra_kw1070,args_str1072);} else {if (M0.procedure_p(p1056)!==false) {var if_res584 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1073(p1056),args_str1072);} else {var if_res584 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1056,args_str1072);}var if_res585 = if_res584;}var if_res589 = if_res585;} else {if (missing_kw1069!==false) {var if_res588 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1073(p1056),missing_kw1069,args_str1072);} else {var temp587 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1071-2)!==false) {var if_res586 = $rjs_core.UString.make("");} else {var if_res586 = $rjs_core.UString.make("s");}var if_res588 = M0.format(temp587,n1071-2,if_res586,proc_name1073(p1056),args_str1072);}var if_res589 = if_res588;}return M0.raise(if_res591(if_res589,M0.current_continuation_marks()));});}var if_res593 = if_res592;}return if_res593;};var keyword_procedure_extract = function(p1083, kws1084, n1085) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws1084,n1085,p1083,0);};var cl594 = function(proc1086, arity1087, req_kw1088, allowed_kw1089, name1090) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1086,arity1087,false,name1090,req_kw1088,allowed_kw1089);};var cl595 = function(proc1091, arity1092, req_kw1093, allowed_kw1094) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1091,arity1092,false,false,req_kw1093,allowed_kw1094);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam596 = {'5':cl594,'4':cl595}[arguments.length];if (fixed_lam596!==undefined) {return fixed_lam596.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl597 = function(proc1095, mask1096, req_kw1097, allowed_kw1098, name1099) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1095,false,mask1096,name1099,req_kw1097,allowed_kw1098);};var cl598 = function(proc1100, mask1101, req_kw1102, allowed_kw1103) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1100,false,mask1101,false,req_kw1102,allowed_kw1103);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam599 = {'5':cl597,'4':cl598}[arguments.length];if (fixed_lam599!==undefined) {return fixed_lam599.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1104, proc1105, arity1106, mask1107, name1108, req_kw1109, allowed_kw1110) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc1105)!==false) {var if_res600 = okp_ref(proc1105,0);} else {var if_res600 = proc1105;}var p1112 = if_res600;if (arity1106!==false) {var if_res601 = M0.__rjs_quoted__.procedure_reduce_arity(p1112,arity1106);} else {var if_res601 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1112,mask1107,name1108);}var plain_proc1111 = if_res601;var sorted_p1113 = function(kws1114) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1115 = function(kws1116) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws1116)!==false) {var if_res604 = true;} else {if (M0.null_p(M0.cdr(kws1116))!==false) {var if_res603 = true;} else {if (M0.keyword_lt__p(M0.car(kws1116),M0.cadr(kws1116))!==false) {var if_res602 = loop1115(M0.cdr(kws1116));} else {var if_res602 = false;}var if_res603 = if_res602;}var if_res604 = if_res603;}return if_res604;};return loop1115(kws1114);};if (M0.list_p(req_kw1109)!==false) {if (M0.andmap(M0.keyword_p,req_kw1109)!==false) {var if_res605 = sorted_p1113(req_kw1109);} else {var if_res605 = false;}var if_res606 = if_res605;} else {var if_res606 = false;}if (if_res606!==false) {var if_res609 = M0.rvoid();} else {var temp608 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1117 = arity1106;if (or_part1117!==false) {var if_res607 = or_part1117;} else {var if_res607 = mask1107;}var if_res609 = M0.raise_argument_error(who1104,temp608,2,proc1105,if_res607,req_kw1109,allowed_kw1110);}if_res609;if (allowed_kw1110!==false) {if (M0.list_p(allowed_kw1110)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1110)!==false) {var if_res610 = sorted_p1113(allowed_kw1110);} else {var if_res610 = false;}var if_res611 = if_res610;} else {var if_res611 = false;}if (if_res611!==false) {var if_res614 = M0.rvoid();} else {var temp613 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1118 = arity1106;if (or_part1118!==false) {var if_res612 = or_part1118;} else {var if_res612 = mask1107;}var if_res614 = M0.raise_argument_error(who1104,temp613,3,proc1105,if_res612,req_kw1109,allowed_kw1110);}if_res614;if (subset_p(req_kw1109,allowed_kw1110)!==false) {var if_res615 = M0.rvoid();} else {var if_res615 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1110,$rjs_core.UString.make("required keywords"),req_kw1109);}var if_res616 = if_res615;} else {var if_res616 = M0.rvoid();}if_res616;var let_result617 = procedure_keywords(proc1105);var old_req1119 = let_result617.getAt(0);var old_allowed1120 = let_result617.getAt(1);if (subset_p(old_req1119,req_kw1109)!==false) {var if_res618 = M0.rvoid();} else {var if_res618 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1119,$rjs_core.UString.make("requested required keywords"),req_kw1109);}if_res618;if (old_allowed1120!==false) {if (subset_p(req_kw1109,old_allowed1120)!==false) {var if_res619 = M0.rvoid();} else {var if_res619 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1120,$rjs_core.UString.make("requested required keywords"),req_kw1109);}if_res619;var or_part1121 = M0.not(allowed_kw1110);if (or_part1121!==false) {var if_res620 = or_part1121;} else {var if_res620 = subset_p(allowed_kw1110,old_allowed1120);}if (if_res620!==false) {var if_res621 = M0.rvoid();} else {var if_res621 = M0.raise_arguments_error(who1104,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1120,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1110);}var if_res622 = if_res621;} else {var if_res622 = M0.rvoid();}if_res622;if (M0.null_p(allowed_kw1110)!==false) {var if_res630 = plain_proc1111;} else {var or_part1123 = mask1107;if (or_part1123!==false) {var if_res623 = or_part1123;} else {var if_res623 = arity__gt_mask(arity1106);}var mask1122 = if_res623;var new_mask1124 = M0.arithmetic_shift(mask1122,2);var kw_checker1125 = make_keyword_checker(req_kw1109,allowed_kw1110,new_mask1124);var proc1126 = normalize_proc(proc1105);var new_kw_proc1127 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1126),new_mask1124);if (M0.null_p(req_kw1109)!==false) {if (okm_p(proc1126)!==false) {var if_res624 = make_optional_keyword_method;} else {var if_res624 = make_optional_keyword_procedure;}var if_res629 = if_res624(kw_checker1125,new_kw_proc1127,req_kw1109,allowed_kw1110,plain_proc1111);} else {if (named_keyword_procedure_p(proc1126)!==false) {var if_res627 = M0.car(keyword_procedure_name_plus_fail(proc1126));} else {var if_res627 = false;}var or_part1128 = if_res627;if (or_part1128!==false) {var if_res628 = or_part1128;} else {var if_res628 = M0.object_name(proc1126);}var temp626 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1122,1));var or_part1129 = okm_p(proc1126);if (or_part1129!==false) {var if_res625 = or_part1129;} else {var if_res625 = keyword_method_p(proc1126);}var if_res629 = make_required(if_res628,temp626,if_res625,false)(kw_checker1125,new_kw_proc1127,req_kw1109,allowed_kw1110);}var if_res630 = if_res629;}return if_res630;};var arity__gt_mask = function(a1130) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a1130)!==false) {var if_res636 = M0.arithmetic_shift(1,a1130);} else {if (M0.arity_at_least_p(a1130)!==false) {var if_res635 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1130))));} else {if (M0.list_p(a1130)!==false) {var loop1131 = function(mask1132, l1133) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1133)!==false) {var if_res633 = mask1132;} else {var a1134 = M0.car(l1133);var or_part1135 = M0.exact_nonnegative_integer_p(a1134);if (or_part1135!==false) {var if_res631 = or_part1135;} else {var if_res631 = M0.arity_at_least_p(a1134);}if (if_res631!==false) {var if_res632 = loop1131(M0.bitwise_ior(mask1132,arity__gt_mask(a1134)),M0.cdr(l1133));} else {var if_res632 = false;}var if_res633 = if_res632;}return if_res633;};var if_res634 = loop1131(0,a1130);} else {var if_res634 = false;}var if_res635 = if_res634;}var if_res636 = if_res635;}return if_res636;};var cl637 = function(proc1137, arity1138, name1139) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1137)!==false) {var let_result640 = procedure_keywords(proc1137);var req1140 = let_result640.getAt(0);var allows1141 = let_result640.getAt(1);if (M0.pair_p(req1140)!==false) {var if_res641 = M0.not(M0.null_p(arity1138));} else {var if_res641 = false;}var if_res642 = if_res641;} else {var if_res642 = false;}if (if_res642!==false) {var if_res644 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1137);} else {if (okm_p(proc1137)!==false) {var if_res643 = M0.__rjs_quoted__.procedure__gt_method(proc1137);} else {var if_res643 = proc1137;}var if_res644 = M0.__rjs_quoted__.procedure_reduce_arity(if_res643,arity1138,name1139);}return if_res644;};var cl638 = function(proc1142, arity1143) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1142,arity1143,false);};var procedure_reduce_arity1136 = $rjs_core.attachProcedureArity(function() {var fixed_lam639 = {'3':cl637,'2':cl638}[arguments.length];if (fixed_lam639!==undefined) {return fixed_lam639.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1136;var cl645 = function(proc1145, mask1146, name1147) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1145)!==false) {var let_result648 = procedure_keywords(proc1145);var req1148 = let_result648.getAt(0);var allows1149 = let_result648.getAt(1);if (M0.pair_p(req1148)!==false) {var if_res649 = M0.not(M0.eqv_p(mask1146,0));} else {var if_res649 = false;}var if_res650 = if_res649;} else {var if_res650 = false;}if (if_res650!==false) {var if_res652 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1145);} else {if (okm_p(proc1145)!==false) {var if_res651 = M0.__rjs_quoted__.procedure__gt_method(proc1145);} else {var if_res651 = proc1145;}var if_res652 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res651,mask1146,name1147);}return if_res652;};var cl646 = function(proc1150, mask1151) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1150,mask1151,false);};var procedure_reduce_arity1144 = $rjs_core.attachProcedureArity(function() {var fixed_lam647 = {'3':cl645,'2':cl646}[arguments.length];if (fixed_lam647!==undefined) {return fixed_lam647.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1144;var procedure__gt_method1152 = function(proc1153) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1154 = normalize_proc(proc1153);if (keyword_procedure_p(proc1154)!==false) {if (okm_p(proc1154)!==false) {var if_res655 = proc1154;} else {if (keyword_method_p(proc1154)!==false) {var if_res654 = proc1154;} else {if (okp_p(proc1154)!==false) {var if_res653 = make_optional_keyword_method(keyword_procedure_checker(proc1154),keyword_procedure_proc(proc1154),keyword_procedure_required(proc1154),keyword_procedure_allowed(proc1154),okp_ref(proc1154,0));} else {var name_plus_fail1155 = keyword_procedure_name_plus_fail(proc1154);var mk1156 = make_required(M0.car(name_plus_fail1155),M0.cdr(name_plus_fail1155),true,false);var if_res653 = mk1156(keyword_procedure_checker(proc1154),keyword_procedure_proc(proc1154),keyword_procedure_required(proc1154),keyword_procedure_allowed(proc1154));}var if_res654 = if_res653;}var if_res655 = if_res654;}var if_res656 = if_res655;} else {var if_res656 = M0.__rjs_quoted__.procedure__gt_method(proc1154);}return if_res656;};var new_procedure__gt_method = procedure__gt_method1152;var procedure_rename1157 = function(proc1158, name1159) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1158)!==false) {var if_res657 = M0.symbol_p(name1159);} else {var if_res657 = false;}if (M0.not(if_res657)!==false) {var if_res660 = M0.__rjs_quoted__.procedure_rename(proc1158,name1159);} else {if (okp_p(proc1158)!==false) {if (okm_p(proc1158)!==false) {var if_res658 = make_optional_keyword_method;} else {var if_res658 = make_optional_keyword_procedure;}var if_res659 = if_res658(keyword_procedure_checker(proc1158),keyword_procedure_proc(proc1158),keyword_procedure_required(proc1158),keyword_procedure_allowed(proc1158),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1158,0),name1159));} else {var name_plus_fail1160 = keyword_procedure_name_plus_fail(proc1158);var mk1161 = make_required(name1159,M0.cdr(name_plus_fail1160),keyword_method_p(proc1158),false);var if_res659 = mk1161(keyword_procedure_checker(proc1158),keyword_procedure_proc(proc1158),keyword_procedure_required(proc1158),keyword_procedure_allowed(proc1158));}var if_res660 = if_res659;}return if_res660;};var new_procedure_rename = procedure_rename1157;var chaperone_procedure1162 = $rjs_core.attachProcedureArity(function(proc1163, wrap_proc1164, ...props1165661) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1165 = $rjs_core.Pair.listFromArray(props1165661);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1163,wrap_proc1164,props1165);});var new_chaperone_procedure = chaperone_procedure1162;var unsafe_chaperone_procedure1166 = $rjs_core.attachProcedureArity(function(proc1167, wrap_proc1168, ...props1169662) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1169 = $rjs_core.Pair.listFromArray(props1169662);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1167,wrap_proc1168,props1169);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1166;var impersonate_procedure1170 = $rjs_core.attachProcedureArity(function(proc1171, wrap_proc1172, ...props1173663) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1173 = $rjs_core.Pair.listFromArray(props1173663);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1171,wrap_proc1172,props1173);});var new_impersonate_procedure = impersonate_procedure1170;var unsafe_impersonate_procedure1174 = $rjs_core.attachProcedureArity(function(proc1175, wrap_proc1176, ...props1177664) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1177 = $rjs_core.Pair.listFromArray(props1177664);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1175,wrap_proc1176,props1177);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1174;var chaperone_procedure_times_1178 = $rjs_core.attachProcedureArity(function(proc1179, wrap_proc1180, ...props1181665) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1181 = $rjs_core.Pair.listFromArray(props1181665);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1179,wrap_proc1180,props1181);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1178;var impersonate_procedure_times_1182 = $rjs_core.attachProcedureArity(function(proc1183, wrap_proc1184, ...props1185666) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1185 = $rjs_core.Pair.listFromArray(props1185666);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1183,wrap_proc1184,props1185);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1182;var do_chaperone_procedure = function(is_impersonator_p1186, self_arg_p1187, chaperone_procedure1188, name1189, proc1190, wrap_proc1191, props1192) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1193 = normalize_proc(proc1190);var n_wrap_proc1194 = normalize_proc(wrap_proc1191);var or_part1195 = M0.not(keyword_procedure_p(n_proc1193));if (or_part1195!==false) {var if_res668 = or_part1195;} else {var or_part1196 = M0.not(M0.procedure_p(wrap_proc1191));if (or_part1196!==false) {var if_res667 = or_part1196;} else {var if_res667 = bad_props_p(props1192);}var if_res668 = if_res667;}if (if_res668!==false) {var if_res735 = M0.apply(chaperone_procedure1188,proc1190,wrap_proc1191,props1192);} else {chaperone_arity_match_checking(self_arg_p1187,name1189,proc1190,wrap_proc1191,props1192);var loop1198 = function(props1199) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1199)!==false) {var if_res670 = false;} else {if (M0.eq_p(M0.car(props1199),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res669 = M0.cadr(props1199);} else {var if_res669 = loop1198(M0.cddr(props1199));}var if_res670 = if_res669;}return if_res670;};var mark_prop1197 = loop1198(props1192);var chaperone_procedure_by_add_mark1200 = function(proc1201, wrap_proc1202) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (mark_prop1197!==false) {var if_res671 = chaperone_procedure1188(proc1201,wrap_proc1202,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1197);} else {var if_res671 = chaperone_procedure1188(proc1201,wrap_proc1202);}return if_res671;};var p1204 = keyword_procedure_proc(n_wrap_proc1194);if (self_arg_p1187!==false) {var cl672 = $rjs_core.attachProcedureArity(function(self_proc1205, kws1206, args1207, ...rest1208677) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1208 = $rjs_core.Pair.listFromArray(rest1208677);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1204,kws1206,args1207,self_proc1205,rest1208);},$rjs_core.attachProcedureArity(function(...results1209678) {var results1209 = $rjs_core.Pair.listFromArray(results1209678);var len1210 = M0.length(results1209);var alen1211 = M0.length(rest1208);if (M0.__lt_(len1210,alen1211+1)!==false) {var if_res679 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1211+1,$rjs_core.UString.make("received number of results"),len1210,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);} else {var if_res679 = M0.rvoid();}if_res679;var num_extra1212 = len1210-(alen1211+1);var new_args1213 = M0.list_ref(results1209,num_extra1212);if (M0.list_p(new_args1213)!==false) {var if_res680 = M0.__eq_(M0.length(new_args1213),M0.length(args1207));} else {var if_res680 = false;}if (if_res680!==false) {var if_res684 = M0.rvoid();} else {var temp683 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp682 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1210,alen1211)!==false) {var if_res681 = $rjs_core.UString.make("");} else {var if_res681 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res684 = M0.raise_arguments_error(temp683,M0.format(temp682,if_res681),$rjs_core.UString.make("first result"),new_args1213,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}if_res684;M0.for_each(function(kw1214, new_arg1215, arg1216) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1186!==false) {var if_res686 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1215,arg1216)!==false) {var if_res685 = M0.rvoid();} else {var if_res685 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1214),$rjs_core.UString.make("result"),new_arg1215,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}var if_res686 = if_res685;}return if_res686;},kws1206,new_args1213,args1207);var tmp1217 = num_extra1212;if (M0.equal_p(tmp1217,0)!==false) {var if_res689 = M0.apply(M0.values,kws1206,results1209);} else {if (M0.equal_p(tmp1217,1)!==false) {var if_res688 = M0.apply(M0.values,M0.car(results1209),kws1206,M0.cdr(results1209));} else {var loop1218 = function(results1219, c1220) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1220)!==false) {var if_res687 = M0.cons(kws1206,results1219);} else {var if_res687 = M0.cons(M0.car(results1219),loop1218(M0.cdr(results1219),M0.sub1(c1220)));}return if_res687;};var if_res688 = M0.apply(M0.values,loop1218(results1209,num_extra1212));}var if_res689 = if_res688;}return if_res689;}));});var cl673 = $rjs_core.attachProcedureArity(function(...other1221690) {var other1221 = $rjs_core.Pair.listFromArray(other1221690);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res710 = $rjs_core.attachProcedureArity(function() {var fixed_lam674 = {}[arguments.length];if (fixed_lam674!==undefined) {return fixed_lam674.apply(null,arguments);} else {if (M0.__gt__eq_(cl672.length,1)!==false) {var if_res676 = cl672.apply(null,arguments);} else {if (true!==false) {var if_res675 = cl673.apply(null,arguments);} else {var if_res675 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res676 = if_res675;}return if_res676;}},[M0.make_arity_at_least(0)]);} else {var cl691 = $rjs_core.attachProcedureArity(function(kws1222, args1223, ...rest1224696) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1224 = $rjs_core.Pair.listFromArray(rest1224696);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1204,kws1222,args1223,rest1224);},$rjs_core.attachProcedureArity(function(...results1225697) {var results1225 = $rjs_core.Pair.listFromArray(results1225697);var len1226 = M0.length(results1225);var alen1227 = M0.length(rest1224);if (M0.__lt_(len1226,alen1227+1)!==false) {var if_res698 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1227+1,$rjs_core.UString.make("received number of results"),len1226,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);} else {var if_res698 = M0.rvoid();}if_res698;var num_extra1228 = len1226-(alen1227+1);var new_args1229 = M0.list_ref(results1225,num_extra1228);if (M0.list_p(new_args1229)!==false) {var if_res699 = M0.__eq_(M0.length(new_args1229),M0.length(args1223));} else {var if_res699 = false;}if (if_res699!==false) {var if_res703 = M0.rvoid();} else {var temp702 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp701 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1226,alen1227)!==false) {var if_res700 = $rjs_core.UString.make("");} else {var if_res700 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res703 = M0.raise_arguments_error(temp702,M0.format(temp701,if_res700),$rjs_core.UString.make("first result"),new_args1229,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}if_res703;M0.for_each(function(kw1230, new_arg1231, arg1232) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1186!==false) {var if_res705 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1231,arg1232)!==false) {var if_res704 = M0.rvoid();} else {var if_res704 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1230),$rjs_core.UString.make("result"),new_arg1231,$rjs_core.UString.make("wrapper procedure"),wrap_proc1191);}var if_res705 = if_res704;}return if_res705;},kws1222,new_args1229,args1223);var tmp1233 = num_extra1228;if (M0.equal_p(tmp1233,0)!==false) {var if_res708 = M0.apply(M0.values,kws1222,results1225);} else {if (M0.equal_p(tmp1233,1)!==false) {var if_res707 = M0.apply(M0.values,M0.car(results1225),kws1222,M0.cdr(results1225));} else {var loop1234 = function(results1235, c1236) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1236)!==false) {var if_res706 = M0.cons(kws1222,results1235);} else {var if_res706 = M0.cons(M0.car(results1235),loop1234(M0.cdr(results1235),M0.sub1(c1236)));}return if_res706;};var if_res707 = M0.apply(M0.values,loop1234(results1225,num_extra1228));}var if_res708 = if_res707;}return if_res708;}));});var cl692 = $rjs_core.attachProcedureArity(function(...other1237709) {var other1237 = $rjs_core.Pair.listFromArray(other1237709);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res710 = $rjs_core.attachProcedureArity(function() {var fixed_lam693 = {}[arguments.length];if (fixed_lam693!==undefined) {return fixed_lam693.apply(null,arguments);} else {if (M0.__gt__eq_(cl691.length,1)!==false) {var if_res695 = cl691.apply(null,arguments);} else {if (true!==false) {var if_res694 = cl692.apply(null,arguments);} else {var if_res694 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res695 = if_res694;}return if_res695;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1203 = if_res710;var wrap1240 = function(proc1241, n_proc1242) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1242,proc1241))!==false) {var if_res711 = new_procedure_p(proc1241);} else {var if_res711 = false;}if (if_res711!==false) {var v1243 = new_procedure_ref(proc1241);if (M0.exact_integer_p(v1243)!==false) {var acc1244 = procedure_accessor_ref(proc1241);var if_res727 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1241,acc1244,function(self1245, sub_proc1246) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result712 = wrap1240(sub_proc1246,normalize_proc(sub_proc1246));var f1247 = let_result712.getAt(0);var acc1248 = let_result712.getAt(1);return f1247;}),acc1244);} else {if (is_impersonator_p1186!==false) {var if_res726 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res726 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1242)!==false) {var if_res725 = chaperone_procedure_by_add_mark1200(proc1241,wrap_proc1191);} else {var if_res725 = proc1241;}var new_kw_proc1249 = if_res726(if_res725,new_procedure_ref,function(self1250, proc1251) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1186!==false) {var if_res724 = new_impersonate_procedure;} else {var if_res724 = new_chaperone_procedure;}if (self_arg_p1187!==false) {var if_res723 = $rjs_core.attachProcedureArity(function(proc_self1252, kws1253, kw_args1254, self1255, ...args1256713) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1256 = $rjs_core.Pair.listFromArray(args1256713);var len1257 = M0.length(args1256);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1203,proc_self1252,kws1253,kw_args1254,args1256);},$rjs_core.attachProcedureArity(function(...results1258714) {var results1258 = $rjs_core.Pair.listFromArray(results1258714);var r_len1259 = M0.length(results1258);var list_take1260 = function(l1261, n1262) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1262)!==false) {var if_res715 = M0.rnull;} else {var if_res715 = M0.cons(M0.car(l1261),list_take1260(M0.cdr(l1261),M0.sub1(n1262)));}return if_res715;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res716 = M0.__eq_(r_len1259,2+len1257);} else {var if_res716 = false;}if (if_res716!==false) {var if_res717 = M0.apply(M0.values,M0.cadr(results1258),self1255,M0.cddr(results1258));} else {var skip1263 = r_len1259-len1257;var if_res717 = M0.apply(M0.values,M0.append(list_take1260(results1258,skip1263-2),M0.list(M0.list_ref(results1258,M0.sub1(skip1263)),self1255),M0.__rjs_quoted__.list_tail(results1258,skip1263)));}return if_res717;}));});} else {var if_res723 = $rjs_core.attachProcedureArity(function(kws1264, kw_args1265, self1266, ...args1267718) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1267 = $rjs_core.Pair.listFromArray(args1267718);var len1268 = M0.length(args1267);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1203,kws1264,kw_args1265,args1267);},$rjs_core.attachProcedureArity(function(...results1269719) {var results1269 = $rjs_core.Pair.listFromArray(results1269719);var r_len1270 = M0.length(results1269);var list_take1271 = function(l1272, n1273) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1273)!==false) {var if_res720 = M0.rnull;} else {var if_res720 = M0.cons(M0.car(l1272),list_take1271(M0.cdr(l1272),M0.sub1(n1273)));}return if_res720;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res721 = M0.__eq_(r_len1270,2+len1268);} else {var if_res721 = false;}if (if_res721!==false) {var if_res722 = M0.apply(M0.values,M0.cadr(results1269),self1266,M0.cddr(results1269));} else {var skip1274 = r_len1270-len1268;var if_res722 = M0.apply(M0.values,M0.append(list_take1271(results1269,skip1274-2),M0.list(M0.list_ref(results1269,M0.sub1(skip1274)),self1266),M0.__rjs_quoted__.list_tail(results1269,skip1274)));}return if_res722;}));});}return if_res724(proc1251,make_keyword_procedure(if_res723));});var if_res727 = M0.values(new_kw_proc1249,new_procedure_ref);}var if_res732 = if_res727;} else {if (okp_p(n_proc1242)!==false) {if (is_impersonator_p1186!==false) {if (okm_p(n_proc1242)!==false) {var if_res728 = make_optional_keyword_method_impersonator;} else {var if_res728 = make_optional_keyword_procedure_impersonator;}var if_res729 = if_res728(keyword_procedure_checker(n_proc1242),chaperone_procedure_by_add_mark1200(keyword_procedure_proc(n_proc1242),kw_chaperone1203),keyword_procedure_required(n_proc1242),keyword_procedure_allowed(n_proc1242),chaperone_procedure_by_add_mark1200(okp_ref(n_proc1242,0),okp_ref(n_wrap_proc1194,0)),n_proc1242);} else {var if_res729 = M0.__rjs_quoted__.chaperone_struct(proc1241,keyword_procedure_proc,function(self1275, proc1276) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1200(proc1276,kw_chaperone1203);},M0.make_struct_field_accessor(okp_ref,0),function(self1277, proc1278) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1200(proc1278,okp_ref(n_wrap_proc1194,0));});}var if_res731 = M0.values(if_res729,keyword_procedure_proc);} else {if (is_impersonator_p1186!==false) {var name_plus_fail1279 = keyword_procedure_name_plus_fail(n_proc1242);var mk1280 = make_required(M0.car(name_plus_fail1279),M0.cdr(name_plus_fail1279),keyword_method_p(n_proc1242),true);var if_res730 = mk1280(keyword_procedure_checker(n_proc1242),chaperone_procedure_by_add_mark1200(keyword_procedure_proc(n_proc1242),kw_chaperone1203),keyword_procedure_required(n_proc1242),keyword_procedure_allowed(n_proc1242),n_proc1242);} else {var if_res730 = M0.__rjs_quoted__.chaperone_struct(n_proc1242,keyword_procedure_proc,function(self1281, proc1282) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure_by_add_mark1200(proc1282,kw_chaperone1203);});}var if_res731 = M0.values(if_res730,keyword_procedure_proc);}var if_res732 = if_res731;}return if_res732;};var let_result733 = wrap1240(proc1190,n_proc1193);var new_proc1238 = let_result733.getAt(0);var chap_accessor1239 = let_result733.getAt(1);if (M0.null_p(props1192)!==false) {var if_res734 = new_proc1238;} else {var if_res734 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1238,chap_accessor1239,false,props1192);}var if_res735 = if_res734;}return if_res735;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1283, name1284, proc1285, wrap_proc1286, props1287) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1288 = normalize_proc(proc1285);var n_wrap_proc1289 = normalize_proc(wrap_proc1286);var or_part1290 = M0.not(keyword_procedure_p(n_proc1288));if (or_part1290!==false) {var if_res737 = or_part1290;} else {var or_part1291 = M0.not(M0.procedure_p(wrap_proc1286));if (or_part1291!==false) {var if_res736 = or_part1291;} else {var if_res736 = bad_props_p(props1287);}var if_res737 = if_res736;}if (if_res737!==false) {var if_res738 = M0.apply(unsafe_chaperone_procedure1283,proc1285,wrap_proc1286,props1287);} else {chaperone_arity_match_checking(false,name1284,proc1285,wrap_proc1286,props1287);var if_res738 = M0.apply(unsafe_chaperone_procedure1283,proc1285,wrap_proc1286,props1287);}return if_res738;};var bad_props_p = function(props1292) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1293 = function(props1294) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1294)!==false) {var if_res741 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1294))!==false) {var props1295 = M0.cdr(props1294);var or_part1296 = M0.null_p(props1295);if (or_part1296!==false) {var if_res739 = or_part1296;} else {var if_res739 = loop1293(M0.cdr(props1295));}var if_res740 = if_res739;} else {var if_res740 = true;}var if_res741 = if_res740;}return if_res741;};return loop1293(props1292);};var chaperone_arity_match_checking = function(self_arg_p1297, name1298, proc1299, wrap_proc1300, props1301) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1302 = M0.procedure_arity(proc1299);var b1303 = M0.procedure_arity(wrap_proc1300);if (self_arg_p1297!==false) {var if_res742 = 1;} else {var if_res742 = 0;}var d1304 = if_res742;var let_result743 = procedure_keywords(proc1299);var a_req1305 = let_result743.getAt(0);var a_allow1306 = let_result743.getAt(1);var let_result744 = procedure_keywords(wrap_proc1300);var b_req1307 = let_result744.getAt(0);var b_allow1308 = let_result744.getAt(1);var includes_p1309 = function(a1310, b1311) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1311)!==false) {if (M0.number_p(a1310)!==false) {var if_res746 = M0.__eq_(b1311,a1310+d1304);} else {if (M0.arity_at_least_p(a1310)!==false) {var if_res745 = M0.__gt__eq_(b1311,M0.arity_at_least_value(a1310)+d1304);} else {var if_res745 = M0.ormap(function(a1312) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1309(a1312,b1311);},a1310);}var if_res746 = if_res745;}var if_res750 = if_res746;} else {if (M0.arity_at_least_p(b1311)!==false) {if (M0.number_p(a1310)!==false) {var if_res748 = false;} else {if (M0.arity_at_least_p(a1310)!==false) {var if_res747 = M0.__gt__eq_(M0.arity_at_least_value(b1311),M0.arity_at_least_value(a1310)+d1304);} else {var if_res747 = M0.ormap(function(a1313) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1309(b1311,a1313);},a1310);}var if_res748 = if_res747;}var if_res749 = if_res748;} else {var if_res749 = M0.andmap(function(b1314) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1309(a1310,b1314);},b1311);}var if_res750 = if_res749;}return if_res750;};if (includes_p1309(b1303,a1302)!==false) {var if_res751 = M0.rvoid();} else {var if_res751 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1299,wrap_proc1300,props1301);}if_res751;if (subset_p(b_req1307,a_req1305)!==false) {var if_res752 = M0.rvoid();} else {var if_res752 = M0.raise_arguments_error(name1298,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1300,$rjs_core.UString.make("original procedure"),proc1299);}if_res752;var or_part1315 = M0.not(b_allow1308);if (or_part1315!==false) {var if_res754 = or_part1315;} else {if (a_allow1306!==false) {var if_res753 = subset_p(a_allow1306,b_allow1308);} else {var if_res753 = false;}var if_res754 = if_res753;}if (if_res754!==false) {var if_res755 = M0.rvoid();} else {var if_res755 = M0.raise_arguments_error(name1298,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1300,$rjs_core.UString.make("original procedure"),proc1299);}if_res755;return M0.rvoid();};var normalize_proc = function(proc1316) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1316)!==false) {var if_res763 = proc1316;} else {if (new_procedure_p(proc1316)!==false) {var let_result756 = procedure_keywords(proc1316);var req_kws1317 = let_result756.getAt(0);var allowed_kws1318 = let_result756.getAt(1);if (M0.null_p(allowed_kws1318)!==false) {var if_res761 = proc1316;} else {var if_res761 = make_optional_keyword_procedure(function(given_kws1319, given_argc1320) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1316,given_argc1320-2,true)!==false) {var or_part1321 = M0.not(allowed_kws1318);if (or_part1321!==false) {var if_res758 = or_part1321;} else {var if_res758 = subset_p(given_kws1319,allowed_kws1318);}if (if_res758!==false) {var if_res759 = subset_p(req_kws1317,given_kws1319);} else {var if_res759 = false;}var if_res760 = if_res759;} else {var if_res760 = false;}return if_res760;},$rjs_core.attachProcedureArity(function(kws1322, kw_args1323, ...vals1324757) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1324 = $rjs_core.Pair.listFromArray(vals1324757);return keyword_apply(proc1316,kws1322,kw_args1323,vals1324);}),req_kws1317,allowed_kws1318,proc1316);}var if_res762 = if_res761;} else {var if_res762 = proc1316;}var if_res763 = if_res762;}return if_res763;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };