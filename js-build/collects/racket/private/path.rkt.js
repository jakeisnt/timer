import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";var path_string_p = function(s1023) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1024 = M0.path_p(s1023);if (or_part1024!==false) {var if_res523 = or_part1024;} else {if (M0.string_p(s1023)!==false) {var or_part1025 = M0.__rjs_quoted__.relative_path_p(s1023);if (or_part1025!==false) {var if_res521 = or_part1025;} else {var if_res521 = M0.__rjs_quoted__.absolute_path_p(s1023);}var if_res522 = if_res521;} else {var if_res522 = false;}var if_res523 = if_res522;}return if_res523;};var bsbs = M0.string($rjs_core.Char.charFromCodepoint(92),$rjs_core.Char.charFromCodepoint(92));var normal_case_path = function(s1026) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1027 = M0.__rjs_quoted__.path_for_some_system_p(s1026);if (or_part1027!==false) {var if_res524 = or_part1027;} else {var if_res524 = path_string_p(s1026);}if (if_res524!==false) {var if_res525 = M0.rvoid();} else {var if_res525 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("normal-path-case"),$rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),s1026);}if_res525;if (M0.__rjs_quoted__.path_for_some_system_p(s1026)!==false) {var if_res526 = M0.eq_p(M0.__rjs_quoted__.path_convention_type(s1026),$rjs_core.PrimitiveSymbol.make("windows"));} else {var if_res526 = M0.eq_p(M0.system_type(),$rjs_core.PrimitiveSymbol.make("windows"));}if (if_res526!==false) {if (M0.string_p(s1026)!==false) {var if_res527 = false;} else {var if_res527 = M0.__rjs_quoted__.path__gt_bytes(s1026);}var bstr1028 = if_res527;if (M0.string_p(s1026)!==false) {var if_res528 = M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",s1026);} else {var if_res528 = false;}if (if_res528!==false) {var if_res537 = M0.string__gt_path(s1026);} else {if (bstr1028!==false) {var if_res529 = M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",bstr1028);} else {var if_res529 = false;}if (if_res529!==false) {var if_res536 = s1026;} else {var norm1029 = function(s1032) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.__rjs_quoted__.string_locale_downcase(M0.__rjs_quoted__.regexp_replace_times_("/\\//",s1032,bsbs));};var norm_tail1030 = function(s1033) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.__rjs_quoted__.regexp_match_p("/[\\/\\][. ]+[\\/\\]*$/",s1033)!==false) {var if_res530 = s1033;} else {var if_res530 = M0.__rjs_quoted__.regexp_replace_times_("/(?<=[^ .\\/\\])[ .]+([\\/\\]*)$/",s1033,$rjs_core.UString.make("\\1"));}return if_res530;};var finish1031 = function(bstr1034) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.__rjs_quoted__.bytes__gt_path(bstr1034,$rjs_core.PrimitiveSymbol.make("windows"));};if (M0.string_p(s1026)!==false) {var if_res535 = finish1031(M0.__rjs_quoted__.string__gt_bytes_by_locale(norm1029(norm_tail1030(s1026))));} else {var c1035 = M0.__rjs_quoted__.bytes_open_converter($rjs_core.UString.make(""),$rjs_core.UString.make("UTF-8"));var loop1036 = function(offset1037) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result531 = M0.__rjs_quoted__.bytes_convert(c1035,bstr1028,offset1037,M0.bytes_length(bstr1028));var new_bstr1038 = let_result531.getAt(0);var used1039 = let_result531.getAt(1);var status1040 = let_result531.getAt(2);var s1041 = M0.__rjs_quoted__.bytes__gt_string_by_locale(new_bstr1038);if (M0.eq_p(status1040,$rjs_core.PrimitiveSymbol.make("complete"))!==false) {var if_res532 = norm_tail1030(s1041);} else {var if_res532 = s1041;}var tail_s1042 = if_res532;var done1043 = M0.__rjs_quoted__.string__gt_bytes_by_locale(norm1029(tail_s1042));if (M0.eq_p(status1040,$rjs_core.PrimitiveSymbol.make("complete"))!==false) {var if_res534 = done1043;} else {if (M0.eq_p(status1040,$rjs_core.PrimitiveSymbol.make("aborts"))!==false) {var if_res533 = M0.__rjs_quoted__.bytes_append(done1043,M0.__rjs_quoted__.subbytes(bstr1028,offset1037+used1039));} else {var if_res533 = M0.__rjs_quoted__.bytes_append(done1043,M0.__rjs_quoted__.subbytes(bstr1028,offset1037+used1039,offset1037+used1039+1),loop1036(offset1037+used1039+1));}var if_res534 = if_res533;}return if_res534;};var if_res535 = finish1031(loop1036(0));}var if_res536 = if_res535;}var if_res537 = if_res536;}var if_res539 = if_res537;} else {if (M0.string_p(s1026)!==false) {var if_res538 = M0.string__gt_path(s1026);} else {var if_res538 = s1026;}var if_res539 = if_res538;}return if_res539;};var check_extension_call = function(s1044, sfx1045, who1046, sep1047, trust_sep_p1048) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1051 = M0.__rjs_quoted__.path_for_some_system_p(s1044);if (or_part1051!==false) {var if_res540 = or_part1051;} else {var if_res540 = path_string_p(s1044);}if (M0.not(if_res540)!==false) {var if_res546 = M0.values($rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),0);} else {var or_part1052 = M0.string_p(sfx1045);if (or_part1052!==false) {var if_res541 = or_part1052;} else {var if_res541 = M0.bytes_p(sfx1045);}if (M0.not(if_res541)!==false) {var if_res545 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),1);} else {var or_part1053 = trust_sep_p1048;if (or_part1053!==false) {var if_res543 = or_part1053;} else {var or_part1054 = M0.string_p(sep1047);if (or_part1054!==false) {var if_res542 = or_part1054;} else {var if_res542 = M0.bytes_p(sep1047);}var if_res543 = if_res542;}if (M0.not(if_res543)!==false) {var if_res544 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),2);} else {var if_res544 = M0.values(false,false);}var if_res545 = if_res544;}var if_res546 = if_res545;}var let_result547 = if_res546;var err_msg1049 = let_result547.getAt(0);var err_index1050 = let_result547.getAt(1);if (err_msg1049!==false) {if (trust_sep_p1048!==false) {var if_res548 = M0.raise_argument_error(who1046,err_msg1049,err_index1050,s1044,sfx1045);} else {var if_res548 = M0.raise_argument_error(who1046,err_msg1049,err_index1050,s1044,sfx1045,sep1047);}var if_res549 = if_res548;} else {var if_res549 = M0.rvoid();}if_res549;var let_result550 = M0.__rjs_quoted__.split_path(s1044);var base1055 = let_result550.getAt(0);var name1056 = let_result550.getAt(1);var dir_p1057 = let_result550.getAt(2);if (M0.not(base1055)!==false) {var if_res551 = M0.raise_mismatch_error(who1046,$rjs_core.UString.make("cannot add an extension to a root path: "),s1044);} else {var if_res551 = M0.rvoid();}if_res551;return M0.values(base1055,name1056);};var path_adjust_extension = function(name1058, sep1059, rest_bytes1060, s1061, sfx1062, trust_sep_p1063) {if (arguments.length!==6) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result552 = check_extension_call(s1061,sfx1062,name1058,sep1059,trust_sep_p1063);var base1064 = let_result552.getAt(0);var name1065 = let_result552.getAt(1);var bs1066 = M0.__rjs_quoted__.path_element__gt_bytes(name1065);var finish1067 = function(i1068, sep1069, i21070) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp557 = M0.__rjs_quoted__.subbytes(bs1066,0,i1068);if (M0.string_p(sep1069)!==false) {var if_res556 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sep1069,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res556 = sep1069;}var temp555 = rest_bytes1060(bs1066,i21070);if (M0.string_p(sfx1062)!==false) {var if_res554 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sfx1062,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res554 = sfx1062;}var temp558 = M0.__rjs_quoted__.bytes_append(temp557,if_res556,temp555,if_res554);if (M0.__rjs_quoted__.path_for_some_system_p(s1061)!==false) {var if_res553 = M0.__rjs_quoted__.path_convention_type(s1061);} else {var if_res553 = M0.__rjs_quoted__.system_path_convention_type();}return M0.__rjs_quoted__.bytes__gt_path_element(temp558,if_res553);};var loop1072 = function(i1073) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(i1073)!==false) {var if_res561 = finish1067(M0.bytes_length(bs1066),$rjs_core.Bytes.fromIntArray([]),M0.bytes_length(bs1066));} else {var i1074 = M0.sub1(i1073);if (M0.not(M0.zero_p(i1074))!==false) {var if_res559 = M0.eq_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46)),M0.bytes_ref(bs1066,i1074));} else {var if_res559 = false;}if (if_res559!==false) {var if_res560 = finish1067(i1074,sep1059,M0.add1(i1074));} else {var if_res560 = loop1072(i1074);}var if_res561 = if_res560;}return if_res561;};var new_name1071 = loop1072(M0.bytes_length(bs1066));if (M0.__rjs_quoted__.path_for_some_system_p(base1064)!==false) {var if_res562 = M0.__rjs_quoted__.build_path(base1064,new_name1071);} else {var if_res562 = new_name1071;}return if_res562;};var path_replace_extension = function(s1075, sfx1076) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.PrimitiveSymbol.make("path-replace-extension"),$rjs_core.Bytes.fromIntArray([]),function(bs1077, i1078) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return $rjs_core.Bytes.fromIntArray([]);},s1075,sfx1076,true);};var cl563 = function(s1079, sfx1080) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.PrimitiveSymbol.make("path-add-extension"),$rjs_core.Bytes.fromIntArray([95]),M0.__rjs_quoted__.subbytes,s1079,sfx1080,true);};var cl564 = function(s1081, sfx1082, sep1083) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.PrimitiveSymbol.make("path-add-extension"),sep1083,M0.__rjs_quoted__.subbytes,s1081,sfx1082,false);};var path_add_extension = $rjs_core.attachProcedureArity(function() {var fixed_lam565 = {'2':cl563,'3':cl564}[arguments.length];if (fixed_lam565!==undefined) {return fixed_lam565.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var reroot_path = function(p1084, root1085) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1086 = path_string_p(p1084);if (or_part1086!==false) {var if_res566 = or_part1086;} else {var if_res566 = M0.__rjs_quoted__.path_for_some_system_p(p1084);}if (if_res566!==false) {var if_res567 = M0.rvoid();} else {var if_res567 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),0,p1084,root1085);}if_res567;var let_result568 = M0.values();var or_part1087 = path_string_p(root1085);if (or_part1087!==false) {var if_res569 = or_part1087;} else {var if_res569 = M0.__rjs_quoted__.path_for_some_system_p(root1085);}if (if_res569!==false) {var if_res570 = M0.rvoid();} else {var if_res570 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),1,p1084,root1085);}if_res570;var let_result571 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(p1084)!==false) {var if_res572 = M0.__rjs_quoted__.path_convention_type(p1084);} else {var if_res572 = M0.__rjs_quoted__.system_path_convention_type();}var conv1088 = if_res572;var or_part1089 = M0.__rjs_quoted__.complete_path_p(p1084);if (or_part1089!==false) {var if_res573 = or_part1089;} else {var if_res573 = M0.eq_p(M0.__rjs_quoted__.system_path_convention_type(),conv1088);}if (if_res573!==false) {var if_res574 = M0.rvoid();} else {var if_res574 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("path is not complete and not the platform's convention"),$rjs_core.UString.make("path"),p1084,$rjs_core.UString.make("platform convention type"),M0.__rjs_quoted__.system_path_convention_type());}if_res574;var let_result575 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(root1085)!==false) {var if_res576 = M0.__rjs_quoted__.path_convention_type(root1085);} else {var if_res576 = M0.__rjs_quoted__.system_path_convention_type();}if (M0.eq_p(if_res576,conv1088)!==false) {var if_res577 = M0.rvoid();} else {var if_res577 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("given paths use different conventions"),$rjs_core.UString.make("path"),p1084,$rjs_core.UString.make("root path"),root1085);}if_res577;var let_result578 = M0.values();if (M0.__rjs_quoted__.complete_path_p(p1084)!==false) {var if_res579 = p1084;} else {var if_res579 = M0.__rjs_quoted__.path__gt_complete_path(p1084);}var c_p1090 = normal_case_path(M0.__rjs_quoted__.cleanse_path(if_res579));var bstr1091 = M0.__rjs_quoted__.path__gt_bytes(c_p1090);if (M0.eq_p(conv1088,$rjs_core.PrimitiveSymbol.make("unix"))!==false) {if (M0.bytes_eq__p(bstr1091,$rjs_core.Bytes.fromIntArray([47]))!==false) {if (M0.__rjs_quoted__.path_for_some_system_p(root1085)!==false) {var if_res580 = root1085;} else {var if_res580 = M0.string__gt_path(root1085);}var if_res581 = if_res580;} else {var if_res581 = M0.__rjs_quoted__.build_path(root1085,M0.__rjs_quoted__.bytes__gt_path(M0.__rjs_quoted__.subbytes(M0.__rjs_quoted__.path__gt_bytes(c_p1090),1),conv1088));}var if_res588 = if_res581;} else {if (M0.eq_p(conv1088,$rjs_core.PrimitiveSymbol.make("windows"))!==false) {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\[a-z]:/",bstr1091)!==false) {var if_res586 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr1091,4,5),$rjs_core.Bytes.fromIntArray([92]),M0.__rjs_quoted__.subbytes(bstr1091,6));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr1091)!==false) {var if_res585 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr1091,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr1091)!==false) {var if_res584 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr1091,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\/",bstr1091)!==false) {var if_res583 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([85,78,67,92]),M0.__rjs_quoted__.subbytes(bstr1091,2));} else {if (M0.__rjs_quoted__.regexp_match_p("/^[a-z]:/",bstr1091)!==false) {var if_res582 = M0.__rjs_quoted__.bytes_append(M0.__rjs_quoted__.subbytes(bstr1091,0,1),M0.__rjs_quoted__.subbytes(bstr1091,2));} else {var if_res582 = M0.rvoid();}var if_res583 = if_res582;}var if_res584 = if_res583;}var if_res585 = if_res584;}var if_res586 = if_res585;}var if_res587 = M0.__rjs_quoted__.build_path(root1085,M0.__rjs_quoted__.bytes__gt_path(if_res586,conv1088));} else {var if_res587 = M0.rvoid();}var if_res588 = if_res587;}return if_res588;};var __rjs_quoted__ = {};export { __rjs_quoted__,reroot_path,path_add_extension,path_replace_extension,normal_case_path,path_string_p };