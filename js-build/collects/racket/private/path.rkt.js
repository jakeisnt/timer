import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";var path_string_p = function(s972) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part973 = M0.path_p(s972);if (or_part973!==false) {var if_res486 = or_part973;} else {if (M0.string_p(s972)!==false) {var or_part974 = M0.__rjs_quoted__.relative_path_p(s972);if (or_part974!==false) {var if_res484 = or_part974;} else {var if_res484 = M0.__rjs_quoted__.absolute_path_p(s972);}var if_res485 = if_res484;} else {var if_res485 = false;}var if_res486 = if_res485;}return if_res486;};var bsbs = M0.string($rjs_core.Char.charFromCodepoint(92),$rjs_core.Char.charFromCodepoint(92));var normal_case_path = function(s975) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part976 = M0.__rjs_quoted__.path_for_some_system_p(s975);if (or_part976!==false) {var if_res487 = or_part976;} else {var if_res487 = path_string_p(s975);}if (if_res487!==false) {var if_res488 = M0.rvoid();} else {var if_res488 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("normal-path-case"),$rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),s975);}if_res488;if (M0.__rjs_quoted__.path_for_some_system_p(s975)!==false) {var if_res489 = M0.eq_p(M0.__rjs_quoted__.path_convention_type(s975),$rjs_core.PrimitiveSymbol.make("windows"));} else {var if_res489 = M0.eq_p(M0.system_type(),$rjs_core.PrimitiveSymbol.make("windows"));}if (if_res489!==false) {if (M0.string_p(s975)!==false) {var if_res490 = false;} else {var if_res490 = M0.__rjs_quoted__.path__gt_bytes(s975);}var bstr977 = if_res490;if (M0.string_p(s975)!==false) {var if_res491 = M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",s975);} else {var if_res491 = false;}if (if_res491!==false) {var if_res500 = M0.string__gt_path(s975);} else {if (bstr977!==false) {var if_res492 = M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",bstr977);} else {var if_res492 = false;}if (if_res492!==false) {var if_res499 = s975;} else {var norm978 = function(s981) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.__rjs_quoted__.string_locale_downcase(M0.__rjs_quoted__.regexp_replace_times_("/\\//",s981,bsbs));};var norm_tail979 = function(s982) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.__rjs_quoted__.regexp_match_p("/[\\/\\][. ]+[\\/\\]*$/",s982)!==false) {var if_res493 = s982;} else {var if_res493 = M0.__rjs_quoted__.regexp_replace_times_("/(?<=[^ .\\/\\])[ .]+([\\/\\]*)$/",s982,$rjs_core.UString.make("\\1"));}return if_res493;};var finish980 = function(bstr983) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.__rjs_quoted__.bytes__gt_path(bstr983,$rjs_core.PrimitiveSymbol.make("windows"));};if (M0.string_p(s975)!==false) {var if_res498 = finish980(M0.__rjs_quoted__.string__gt_bytes_by_locale(norm978(norm_tail979(s975))));} else {var c984 = M0.__rjs_quoted__.bytes_open_converter($rjs_core.UString.make(""),$rjs_core.UString.make("UTF-8"));var loop985 = function(offset986) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result494 = M0.__rjs_quoted__.bytes_convert(c984,bstr977,offset986,M0.bytes_length(bstr977));var new_bstr987 = let_result494.getAt(0);var used988 = let_result494.getAt(1);var status989 = let_result494.getAt(2);var s990 = M0.__rjs_quoted__.bytes__gt_string_by_locale(new_bstr987);if (M0.eq_p(status989,$rjs_core.PrimitiveSymbol.make("complete"))!==false) {var if_res495 = norm_tail979(s990);} else {var if_res495 = s990;}var tail_s991 = if_res495;var done992 = M0.__rjs_quoted__.string__gt_bytes_by_locale(norm978(tail_s991));if (M0.eq_p(status989,$rjs_core.PrimitiveSymbol.make("complete"))!==false) {var if_res497 = done992;} else {if (M0.eq_p(status989,$rjs_core.PrimitiveSymbol.make("aborts"))!==false) {var if_res496 = M0.__rjs_quoted__.bytes_append(done992,M0.__rjs_quoted__.subbytes(bstr977,offset986+used988));} else {var if_res496 = M0.__rjs_quoted__.bytes_append(done992,M0.__rjs_quoted__.subbytes(bstr977,offset986+used988,offset986+used988+1),loop985(offset986+used988+1));}var if_res497 = if_res496;}return if_res497;};var if_res498 = finish980(loop985(0));}var if_res499 = if_res498;}var if_res500 = if_res499;}var if_res502 = if_res500;} else {if (M0.string_p(s975)!==false) {var if_res501 = M0.string__gt_path(s975);} else {var if_res501 = s975;}var if_res502 = if_res501;}return if_res502;};var check_extension_call = function(s993, sfx994, who995, sep996, trust_sep_p997) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1000 = M0.__rjs_quoted__.path_for_some_system_p(s993);if (or_part1000!==false) {var if_res503 = or_part1000;} else {var if_res503 = path_string_p(s993);}if (M0.not(if_res503)!==false) {var if_res509 = M0.values($rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),0);} else {var or_part1001 = M0.string_p(sfx994);if (or_part1001!==false) {var if_res504 = or_part1001;} else {var if_res504 = M0.bytes_p(sfx994);}if (M0.not(if_res504)!==false) {var if_res508 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),1);} else {var or_part1002 = trust_sep_p997;if (or_part1002!==false) {var if_res506 = or_part1002;} else {var or_part1003 = M0.string_p(sep996);if (or_part1003!==false) {var if_res505 = or_part1003;} else {var if_res505 = M0.bytes_p(sep996);}var if_res506 = if_res505;}if (M0.not(if_res506)!==false) {var if_res507 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),2);} else {var if_res507 = M0.values(false,false);}var if_res508 = if_res507;}var if_res509 = if_res508;}var let_result510 = if_res509;var err_msg998 = let_result510.getAt(0);var err_index999 = let_result510.getAt(1);if (err_msg998!==false) {if (trust_sep_p997!==false) {var if_res511 = M0.raise_argument_error(who995,err_msg998,err_index999,s993,sfx994);} else {var if_res511 = M0.raise_argument_error(who995,err_msg998,err_index999,s993,sfx994,sep996);}var if_res512 = if_res511;} else {var if_res512 = M0.rvoid();}if_res512;var let_result513 = M0.__rjs_quoted__.split_path(s993);var base1004 = let_result513.getAt(0);var name1005 = let_result513.getAt(1);var dir_p1006 = let_result513.getAt(2);if (M0.not(base1004)!==false) {var if_res514 = M0.raise_mismatch_error(who995,$rjs_core.UString.make("cannot add an extension to a root path: "),s993);} else {var if_res514 = M0.rvoid();}if_res514;return M0.values(base1004,name1005);};var path_adjust_extension = function(name1007, sep1008, rest_bytes1009, s1010, sfx1011, trust_sep_p1012) {if (arguments.length!==6) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result515 = check_extension_call(s1010,sfx1011,name1007,sep1008,trust_sep_p1012);var base1013 = let_result515.getAt(0);var name1014 = let_result515.getAt(1);var bs1015 = M0.__rjs_quoted__.path_element__gt_bytes(name1014);var finish1016 = function(i1017, sep1018, i21019) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp520 = M0.__rjs_quoted__.subbytes(bs1015,0,i1017);if (M0.string_p(sep1018)!==false) {var if_res519 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sep1018,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res519 = sep1018;}var temp518 = rest_bytes1009(bs1015,i21019);if (M0.string_p(sfx1011)!==false) {var if_res517 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sfx1011,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res517 = sfx1011;}var temp521 = M0.__rjs_quoted__.bytes_append(temp520,if_res519,temp518,if_res517);if (M0.__rjs_quoted__.path_for_some_system_p(s1010)!==false) {var if_res516 = M0.__rjs_quoted__.path_convention_type(s1010);} else {var if_res516 = M0.__rjs_quoted__.system_path_convention_type();}return M0.__rjs_quoted__.bytes__gt_path_element(temp521,if_res516);};var loop1021 = function(i1022) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(i1022)!==false) {var if_res524 = finish1016(M0.bytes_length(bs1015),$rjs_core.Bytes.fromIntArray([]),M0.bytes_length(bs1015));} else {var i1023 = M0.sub1(i1022);if (M0.not(M0.zero_p(i1023))!==false) {var if_res522 = M0.eq_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46)),M0.bytes_ref(bs1015,i1023));} else {var if_res522 = false;}if (if_res522!==false) {var if_res523 = finish1016(i1023,sep1008,M0.add1(i1023));} else {var if_res523 = loop1021(i1023);}var if_res524 = if_res523;}return if_res524;};var new_name1020 = loop1021(M0.bytes_length(bs1015));if (M0.__rjs_quoted__.path_for_some_system_p(base1013)!==false) {var if_res525 = M0.__rjs_quoted__.build_path(base1013,new_name1020);} else {var if_res525 = new_name1020;}return if_res525;};var path_replace_extension = function(s1024, sfx1025) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.PrimitiveSymbol.make("path-replace-extension"),$rjs_core.Bytes.fromIntArray([]),function(bs1026, i1027) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return $rjs_core.Bytes.fromIntArray([]);},s1024,sfx1025,true);};var cl526 = function(s1028, sfx1029) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.PrimitiveSymbol.make("path-add-extension"),$rjs_core.Bytes.fromIntArray([95]),M0.__rjs_quoted__.subbytes,s1028,sfx1029,true);};var cl527 = function(s1030, sfx1031, sep1032) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.PrimitiveSymbol.make("path-add-extension"),sep1032,M0.__rjs_quoted__.subbytes,s1030,sfx1031,false);};var path_add_extension = $rjs_core.attachProcedureArity(function() {var fixed_lam528 = {'2':cl526,'3':cl527}[arguments.length];if (fixed_lam528!==undefined) {return fixed_lam528.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var reroot_path = function(p1033, root1034) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part1035 = path_string_p(p1033);if (or_part1035!==false) {var if_res529 = or_part1035;} else {var if_res529 = M0.__rjs_quoted__.path_for_some_system_p(p1033);}if (if_res529!==false) {var if_res530 = M0.rvoid();} else {var if_res530 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),0,p1033,root1034);}if_res530;var let_result531 = M0.values();var or_part1036 = path_string_p(root1034);if (or_part1036!==false) {var if_res532 = or_part1036;} else {var if_res532 = M0.__rjs_quoted__.path_for_some_system_p(root1034);}if (if_res532!==false) {var if_res533 = M0.rvoid();} else {var if_res533 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),1,p1033,root1034);}if_res533;var let_result534 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(p1033)!==false) {var if_res535 = M0.__rjs_quoted__.path_convention_type(p1033);} else {var if_res535 = M0.__rjs_quoted__.system_path_convention_type();}var conv1037 = if_res535;var or_part1038 = M0.__rjs_quoted__.complete_path_p(p1033);if (or_part1038!==false) {var if_res536 = or_part1038;} else {var if_res536 = M0.eq_p(M0.__rjs_quoted__.system_path_convention_type(),conv1037);}if (if_res536!==false) {var if_res537 = M0.rvoid();} else {var if_res537 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("path is not complete and not the platform's convention"),$rjs_core.UString.make("path"),p1033,$rjs_core.UString.make("platform convention type"),M0.__rjs_quoted__.system_path_convention_type());}if_res537;var let_result538 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(root1034)!==false) {var if_res539 = M0.__rjs_quoted__.path_convention_type(root1034);} else {var if_res539 = M0.__rjs_quoted__.system_path_convention_type();}if (M0.eq_p(if_res539,conv1037)!==false) {var if_res540 = M0.rvoid();} else {var if_res540 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("reroot-path"),$rjs_core.UString.make("given paths use different conventions"),$rjs_core.UString.make("path"),p1033,$rjs_core.UString.make("root path"),root1034);}if_res540;var let_result541 = M0.values();if (M0.__rjs_quoted__.complete_path_p(p1033)!==false) {var if_res542 = p1033;} else {var if_res542 = M0.__rjs_quoted__.path__gt_complete_path(p1033);}var c_p1039 = normal_case_path(M0.__rjs_quoted__.cleanse_path(if_res542));var bstr1040 = M0.__rjs_quoted__.path__gt_bytes(c_p1039);if (M0.eq_p(conv1037,$rjs_core.PrimitiveSymbol.make("unix"))!==false) {if (M0.bytes_eq__p(bstr1040,$rjs_core.Bytes.fromIntArray([47]))!==false) {if (M0.__rjs_quoted__.path_for_some_system_p(root1034)!==false) {var if_res543 = root1034;} else {var if_res543 = M0.string__gt_path(root1034);}var if_res544 = if_res543;} else {var if_res544 = M0.__rjs_quoted__.build_path(root1034,M0.__rjs_quoted__.bytes__gt_path(M0.__rjs_quoted__.subbytes(M0.__rjs_quoted__.path__gt_bytes(c_p1039),1),conv1037));}var if_res551 = if_res544;} else {if (M0.eq_p(conv1037,$rjs_core.PrimitiveSymbol.make("windows"))!==false) {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\[a-z]:/",bstr1040)!==false) {var if_res549 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr1040,4,5),$rjs_core.Bytes.fromIntArray([92]),M0.__rjs_quoted__.subbytes(bstr1040,6));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr1040)!==false) {var if_res548 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr1040,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr1040)!==false) {var if_res547 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr1040,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\/",bstr1040)!==false) {var if_res546 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([85,78,67,92]),M0.__rjs_quoted__.subbytes(bstr1040,2));} else {if (M0.__rjs_quoted__.regexp_match_p("/^[a-z]:/",bstr1040)!==false) {var if_res545 = M0.__rjs_quoted__.bytes_append(M0.__rjs_quoted__.subbytes(bstr1040,0,1),M0.__rjs_quoted__.subbytes(bstr1040,2));} else {var if_res545 = M0.rvoid();}var if_res546 = if_res545;}var if_res547 = if_res546;}var if_res548 = if_res547;}var if_res549 = if_res548;}var if_res550 = M0.__rjs_quoted__.build_path(root1034,M0.__rjs_quoted__.bytes__gt_path(if_res549,conv1037));} else {var if_res550 = M0.rvoid();}var if_res551 = if_res550;}return if_res551;};var __rjs_quoted__ = {};export { __rjs_quoted__,reroot_path,path_add_extension,path_replace_extension,normal_case_path,path_string_p };